<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -Wunused-imports #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{- | Sparse matrices.

We assume the matrices to be very sparse, so we just implement them as
sorted association lists.

Most operations are linear in the number of non-zero elements.

An exception is transposition, which needs to sort the association
list again; it has the complexity of sorting: @n log n@ where @n@ is
the number of non-zero elements.

Another exception is matrix multiplication, of course.

 -}</span></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html"><span class="hs-identifier">Agda.Termination.SparseMatrix</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Basic data types</span></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier">Matrix</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier">Matrix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#unM"><span class="hs-identifier">unM</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-comment">-- , matrixInvariant  -- Moved to the internal test-suite</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier">Size</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#MIx"><span class="hs-identifier">MIx</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Generating and creating matrices</span></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#fromLists"><span class="hs-identifier">fromLists</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#fromIndexList"><span class="hs-identifier">fromIndexList</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#toLists"><span class="hs-identifier">toLists</span></a></span><span>
</span><span id="line-29"></span><span class="hs-comment">--  , Agda.Termination.Matrix.zipWith</span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-comment">-- , matrix  -- Moved to the internal test-suite</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Combining and querying matrices</span></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#size"><span class="hs-identifier">size</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#square"><span class="hs-identifier">square</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#isEmpty"><span class="hs-identifier">isEmpty</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#isSingleton"><span class="hs-identifier">isSingleton</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#zipMatrices"><span class="hs-identifier">zipMatrices</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#add"><span class="hs-identifier">add</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#intersectWith"><span class="hs-identifier">intersectWith</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#interAssocWith"><span class="hs-identifier">interAssocWith</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#mul"><span class="hs-identifier">mul</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#transpose"><span class="hs-identifier">transpose</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Diagonal"><span class="hs-identifier">Diagonal</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#toSparseRows"><span class="hs-identifier">toSparseRows</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#supSize"><span class="hs-identifier">supSize</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#zipAssocWith"><span class="hs-identifier">zipAssocWith</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Modifying matrices</span></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#addRow"><span class="hs-identifier">addRow</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#addColumn"><span class="hs-identifier">addColumn</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Array</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">on</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Fold</span></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Text.PrettyPrint.Boxes</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Boxes</span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Termination.Semiring.html"><span class="hs-identifier">Agda.Termination.Semiring</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.Semiring.html#HasZero"><span class="hs-identifier">HasZero</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.Semiring.html#Semiring"><span class="hs-identifier">Semiring</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Termination.Semiring.html"><span class="hs-identifier">Agda.Termination.Semiring</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Semiring</span></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List.html"><span class="hs-identifier">Agda.Utils.List</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Maybe.html"><span class="hs-identifier">Agda.Utils.Maybe</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.PartialOrd.html"><span class="hs-identifier">Agda.Utils.PartialOrd</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html"><span class="hs-identifier">Agda.Syntax.Common.Pretty</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isEmpty</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Tuple.html"><span class="hs-identifier">Agda.Utils.Tuple</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-75"></span><span class="annot"><span class="hs-comment">-- * Basic data types</span></span><span>
</span><span id="line-76"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="annot"><span class="hs-comment">-- | Size of a matrix.</span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-keyword">data</span><span> </span><span id="Size"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-var">Size</span></a></span></span><span> </span><span id="local-6989586621681558264"><span class="annot"><a href="#local-6989586621681558264"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Size"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-var">Size</span></a></span></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="rows"><span class="annot"><span class="annottext">forall i. Size i -&gt; i
</span><a href="Agda.Termination.SparseMatrix.html#rows"><span class="hs-identifier hs-var hs-var">rows</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681558264"><span class="hs-identifier hs-type">i</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Number of rows,    @&gt;= 0@.</span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="cols"><span class="annot"><span class="annottext">forall i. Size i -&gt; i
</span><a href="Agda.Termination.SparseMatrix.html#cols"><span class="hs-identifier hs-var hs-var">cols</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681558264"><span class="hs-identifier hs-type">i</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Number of columns, @&gt;= 0@.</span></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681558583"><span id="local-6989586621681558587"><span class="annot"><span class="annottext">Size i -&gt; Size i -&gt; Bool
(Size i -&gt; Size i -&gt; Bool)
-&gt; (Size i -&gt; Size i -&gt; Bool) -&gt; Eq (Size i)
forall i. Eq i =&gt; Size i -&gt; Size i -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall i. Eq i =&gt; Size i -&gt; Size i -&gt; Bool
== :: Size i -&gt; Size i -&gt; Bool
$c/= :: forall i. Eq i =&gt; Size i -&gt; Size i -&gt; Bool
/= :: Size i -&gt; Size i -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681558596"><span id="local-6989586621681558600"><span id="local-6989586621681558604"><span id="local-6989586621681558608"><span id="local-6989586621681558611"><span id="local-6989586621681558614"><span id="local-6989586621681558617"><span class="annot"><span class="annottext">Eq (Size i)
Eq (Size i) =&gt;
(Size i -&gt; Size i -&gt; Ordering)
-&gt; (Size i -&gt; Size i -&gt; Bool)
-&gt; (Size i -&gt; Size i -&gt; Bool)
-&gt; (Size i -&gt; Size i -&gt; Bool)
-&gt; (Size i -&gt; Size i -&gt; Bool)
-&gt; (Size i -&gt; Size i -&gt; Size i)
-&gt; (Size i -&gt; Size i -&gt; Size i)
-&gt; Ord (Size i)
Size i -&gt; Size i -&gt; Bool
Size i -&gt; Size i -&gt; Ordering
Size i -&gt; Size i -&gt; Size i
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall i. Ord i =&gt; Eq (Size i)
forall i. Ord i =&gt; Size i -&gt; Size i -&gt; Bool
forall i. Ord i =&gt; Size i -&gt; Size i -&gt; Ordering
forall i. Ord i =&gt; Size i -&gt; Size i -&gt; Size i
$ccompare :: forall i. Ord i =&gt; Size i -&gt; Size i -&gt; Ordering
compare :: Size i -&gt; Size i -&gt; Ordering
$c&lt; :: forall i. Ord i =&gt; Size i -&gt; Size i -&gt; Bool
&lt; :: Size i -&gt; Size i -&gt; Bool
$c&lt;= :: forall i. Ord i =&gt; Size i -&gt; Size i -&gt; Bool
&lt;= :: Size i -&gt; Size i -&gt; Bool
$c&gt; :: forall i. Ord i =&gt; Size i -&gt; Size i -&gt; Bool
&gt; :: Size i -&gt; Size i -&gt; Bool
$c&gt;= :: forall i. Ord i =&gt; Size i -&gt; Size i -&gt; Bool
&gt;= :: Size i -&gt; Size i -&gt; Bool
$cmax :: forall i. Ord i =&gt; Size i -&gt; Size i -&gt; Size i
max :: Size i -&gt; Size i -&gt; Size i
$cmin :: forall i. Ord i =&gt; Size i -&gt; Size i -&gt; Size i
min :: Size i -&gt; Size i -&gt; Size i
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681558627"><span id="local-6989586621681558633"><span id="local-6989586621681558637"><span class="annot"><span class="annottext">Int -&gt; Size i -&gt; ShowS
[Size i] -&gt; ShowS
Size i -&gt; String
(Int -&gt; Size i -&gt; ShowS)
-&gt; (Size i -&gt; String) -&gt; ([Size i] -&gt; ShowS) -&gt; Show (Size i)
forall i. Show i =&gt; Int -&gt; Size i -&gt; ShowS
forall i. Show i =&gt; [Size i] -&gt; ShowS
forall i. Show i =&gt; Size i -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall i. Show i =&gt; Int -&gt; Size i -&gt; ShowS
showsPrec :: Int -&gt; Size i -&gt; ShowS
$cshow :: forall i. Show i =&gt; Size i -&gt; String
show :: Size i -&gt; String
$cshowList :: forall i. Show i =&gt; [Size i] -&gt; ShowS
showList :: [Size i] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="annot"><span class="hs-comment">-- | Type of matrix indices (row, column).</span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-keyword">data</span><span> </span><span id="MIx"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#MIx"><span class="hs-identifier hs-var">MIx</span></a></span></span><span> </span><span id="local-6989586621681558278"><span class="annot"><a href="#local-6989586621681558278"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MIx"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#MIx"><span class="hs-identifier hs-var">MIx</span></a></span></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="row"><span class="annot"><span class="annottext">forall i. MIx i -&gt; i
</span><a href="Agda.Termination.SparseMatrix.html#row"><span class="hs-identifier hs-var hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681558278"><span class="hs-identifier hs-type">i</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Row index,   @1 &lt;= row &lt;= rows@.</span></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="col"><span class="annot"><span class="annottext">forall i. MIx i -&gt; i
</span><a href="Agda.Termination.SparseMatrix.html#col"><span class="hs-identifier hs-var hs-var">col</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681558278"><span class="hs-identifier hs-type">i</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Column index @1 &lt;= col &lt;= cols@.</span></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681558646"><span id="local-6989586621681558650"><span class="annot"><span class="annottext">MIx i -&gt; MIx i -&gt; Bool
(MIx i -&gt; MIx i -&gt; Bool) -&gt; (MIx i -&gt; MIx i -&gt; Bool) -&gt; Eq (MIx i)
forall i. Eq i =&gt; MIx i -&gt; MIx i -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall i. Eq i =&gt; MIx i -&gt; MIx i -&gt; Bool
== :: MIx i -&gt; MIx i -&gt; Bool
$c/= :: forall i. Eq i =&gt; MIx i -&gt; MIx i -&gt; Bool
/= :: MIx i -&gt; MIx i -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681558658"><span id="local-6989586621681558662"><span id="local-6989586621681558666"><span id="local-6989586621681558670"><span id="local-6989586621681558673"><span id="local-6989586621681558676"><span id="local-6989586621681558679"><span class="annot"><span class="annottext">Eq (MIx i)
Eq (MIx i) =&gt;
(MIx i -&gt; MIx i -&gt; Ordering)
-&gt; (MIx i -&gt; MIx i -&gt; Bool)
-&gt; (MIx i -&gt; MIx i -&gt; Bool)
-&gt; (MIx i -&gt; MIx i -&gt; Bool)
-&gt; (MIx i -&gt; MIx i -&gt; Bool)
-&gt; (MIx i -&gt; MIx i -&gt; MIx i)
-&gt; (MIx i -&gt; MIx i -&gt; MIx i)
-&gt; Ord (MIx i)
MIx i -&gt; MIx i -&gt; Bool
MIx i -&gt; MIx i -&gt; Ordering
MIx i -&gt; MIx i -&gt; MIx i
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall i. Ord i =&gt; Eq (MIx i)
forall i. Ord i =&gt; MIx i -&gt; MIx i -&gt; Bool
forall i. Ord i =&gt; MIx i -&gt; MIx i -&gt; Ordering
forall i. Ord i =&gt; MIx i -&gt; MIx i -&gt; MIx i
$ccompare :: forall i. Ord i =&gt; MIx i -&gt; MIx i -&gt; Ordering
compare :: MIx i -&gt; MIx i -&gt; Ordering
$c&lt; :: forall i. Ord i =&gt; MIx i -&gt; MIx i -&gt; Bool
&lt; :: MIx i -&gt; MIx i -&gt; Bool
$c&lt;= :: forall i. Ord i =&gt; MIx i -&gt; MIx i -&gt; Bool
&lt;= :: MIx i -&gt; MIx i -&gt; Bool
$c&gt; :: forall i. Ord i =&gt; MIx i -&gt; MIx i -&gt; Bool
&gt; :: MIx i -&gt; MIx i -&gt; Bool
$c&gt;= :: forall i. Ord i =&gt; MIx i -&gt; MIx i -&gt; Bool
&gt;= :: MIx i -&gt; MIx i -&gt; Bool
$cmax :: forall i. Ord i =&gt; MIx i -&gt; MIx i -&gt; MIx i
max :: MIx i -&gt; MIx i -&gt; MIx i
$cmin :: forall i. Ord i =&gt; MIx i -&gt; MIx i -&gt; MIx i
min :: MIx i -&gt; MIx i -&gt; MIx i
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681558683"><span id="local-6989586621681558688"><span id="local-6989586621681558692"><span class="annot"><span class="annottext">Int -&gt; MIx i -&gt; ShowS
[MIx i] -&gt; ShowS
MIx i -&gt; String
(Int -&gt; MIx i -&gt; ShowS)
-&gt; (MIx i -&gt; String) -&gt; ([MIx i] -&gt; ShowS) -&gt; Show (MIx i)
forall i. Show i =&gt; Int -&gt; MIx i -&gt; ShowS
forall i. Show i =&gt; [MIx i] -&gt; ShowS
forall i. Show i =&gt; MIx i -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall i. Show i =&gt; Int -&gt; MIx i -&gt; ShowS
showsPrec :: Int -&gt; MIx i -&gt; ShowS
$cshow :: forall i. Show i =&gt; MIx i -&gt; String
show :: MIx i -&gt; String
$cshowList :: forall i. Show i =&gt; [MIx i] -&gt; ShowS
showList :: [MIx i] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681558699"><span id="local-6989586621681558703"><span id="local-6989586621681558707"><span id="local-6989586621681558715"><span id="local-6989586621681558719"><span id="local-6989586621681558722"><span class="annot"><span class="annottext">Ord (MIx i)
Ord (MIx i) =&gt;
((MIx i, MIx i) -&gt; [MIx i])
-&gt; ((MIx i, MIx i) -&gt; MIx i -&gt; Int)
-&gt; ((MIx i, MIx i) -&gt; MIx i -&gt; Int)
-&gt; ((MIx i, MIx i) -&gt; MIx i -&gt; Bool)
-&gt; ((MIx i, MIx i) -&gt; Int)
-&gt; ((MIx i, MIx i) -&gt; Int)
-&gt; Ix (MIx i)
(MIx i, MIx i) -&gt; Int
(MIx i, MIx i) -&gt; [MIx i]
(MIx i, MIx i) -&gt; MIx i -&gt; Bool
(MIx i, MIx i) -&gt; MIx i -&gt; Int
forall a.
Ord a =&gt;
((a, a) -&gt; [a])
-&gt; ((a, a) -&gt; a -&gt; Int)
-&gt; ((a, a) -&gt; a -&gt; Int)
-&gt; ((a, a) -&gt; a -&gt; Bool)
-&gt; ((a, a) -&gt; Int)
-&gt; ((a, a) -&gt; Int)
-&gt; Ix a
forall i. Ix i =&gt; Ord (MIx i)
forall i. Ix i =&gt; (MIx i, MIx i) -&gt; Int
forall i. Ix i =&gt; (MIx i, MIx i) -&gt; [MIx i]
forall i. Ix i =&gt; (MIx i, MIx i) -&gt; MIx i -&gt; Bool
forall i. Ix i =&gt; (MIx i, MIx i) -&gt; MIx i -&gt; Int
$crange :: forall i. Ix i =&gt; (MIx i, MIx i) -&gt; [MIx i]
range :: (MIx i, MIx i) -&gt; [MIx i]
$cindex :: forall i. Ix i =&gt; (MIx i, MIx i) -&gt; MIx i -&gt; Int
index :: (MIx i, MIx i) -&gt; MIx i -&gt; Int
$cunsafeIndex :: forall i. Ix i =&gt; (MIx i, MIx i) -&gt; MIx i -&gt; Int
unsafeIndex :: (MIx i, MIx i) -&gt; MIx i -&gt; Int
$cinRange :: forall i. Ix i =&gt; (MIx i, MIx i) -&gt; MIx i -&gt; Bool
inRange :: (MIx i, MIx i) -&gt; MIx i -&gt; Bool
$crangeSize :: forall i. Ix i =&gt; (MIx i, MIx i) -&gt; Int
rangeSize :: (MIx i, MIx i) -&gt; Int
$cunsafeRangeSize :: forall i. Ix i =&gt; (MIx i, MIx i) -&gt; Int
unsafeRangeSize :: (MIx i, MIx i) -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ix</span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">-- UNUSED Liang-Ting Chen 2019-07-15</span><span>
</span><span id="line-95"></span><span class="hs-comment">---- | Convert a 'Size' to a set of bounds suitable for use with</span><span>
</span><span id="line-96"></span><span class="hs-comment">----   the matrices in this module.</span><span>
</span><span id="line-97"></span><span class="hs-comment">--</span><span>
</span><span id="line-98"></span><span class="hs-comment">--toBounds :: Num i =&gt; Size i -&gt; (MIx i, MIx i)</span><span>
</span><span id="line-99"></span><span class="hs-comment">--toBounds sz = (MIx { row = 1, col = 1 }, MIx { row = rows sz, col = cols sz })</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- | Type of matrices, parameterised on the type of values.</span><span>
</span><span id="line-102"></span><span class="hs-comment">--</span><span>
</span><span id="line-103"></span><span class="hs-comment">--   Sparse matrices are implemented as an ordered association list,</span><span>
</span><span id="line-104"></span><span class="hs-comment">--   mapping coordinates to values.</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-keyword">data</span><span> </span><span id="Matrix"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-var">Matrix</span></a></span></span><span> </span><span id="local-6989586621681558291"><span class="annot"><a href="#local-6989586621681558291"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621681558292"><span class="annot"><a href="#local-6989586621681558292"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Matrix"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-var">Matrix</span></a></span></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="size"><span class="annot"><span class="annottext">forall i b. Matrix i b -&gt; Size i
</span><a href="Agda.Termination.SparseMatrix.html#size"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558291"><span class="hs-identifier hs-type">i</span></a></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ Dimensions of the matrix.</span></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="unM"><span class="annot"><span class="annottext">forall i b. Matrix i b -&gt; [(MIx i, b)]
</span><a href="Agda.Termination.SparseMatrix.html#unM"><span class="hs-identifier hs-var hs-var">unM</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#MIx"><span class="hs-identifier hs-type">MIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558291"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681558292"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Association of indices to values.</span></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681558732"><span id="local-6989586621681558738"><span class="annot"><span class="annottext">Matrix i b -&gt; Matrix i b -&gt; Bool
(Matrix i b -&gt; Matrix i b -&gt; Bool)
-&gt; (Matrix i b -&gt; Matrix i b -&gt; Bool) -&gt; Eq (Matrix i b)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall i b. (Eq i, Eq b) =&gt; Matrix i b -&gt; Matrix i b -&gt; Bool
$c== :: forall i b. (Eq i, Eq b) =&gt; Matrix i b -&gt; Matrix i b -&gt; Bool
== :: Matrix i b -&gt; Matrix i b -&gt; Bool
$c/= :: forall i b. (Eq i, Eq b) =&gt; Matrix i b -&gt; Matrix i b -&gt; Bool
/= :: Matrix i b -&gt; Matrix i b -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681558750"><span id="local-6989586621681558756"><span id="local-6989586621681558761"><span id="local-6989586621681558765"><span id="local-6989586621681558768"><span id="local-6989586621681558771"><span id="local-6989586621681558774"><span class="annot"><span class="annottext">Eq (Matrix i b)
Eq (Matrix i b) =&gt;
(Matrix i b -&gt; Matrix i b -&gt; Ordering)
-&gt; (Matrix i b -&gt; Matrix i b -&gt; Bool)
-&gt; (Matrix i b -&gt; Matrix i b -&gt; Bool)
-&gt; (Matrix i b -&gt; Matrix i b -&gt; Bool)
-&gt; (Matrix i b -&gt; Matrix i b -&gt; Bool)
-&gt; (Matrix i b -&gt; Matrix i b -&gt; Matrix i b)
-&gt; (Matrix i b -&gt; Matrix i b -&gt; Matrix i b)
-&gt; Ord (Matrix i b)
Matrix i b -&gt; Matrix i b -&gt; Bool
Matrix i b -&gt; Matrix i b -&gt; Ordering
Matrix i b -&gt; Matrix i b -&gt; Matrix i b
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall i b. (Ord i, Ord b) =&gt; Eq (Matrix i b)
forall i b. (Ord i, Ord b) =&gt; Matrix i b -&gt; Matrix i b -&gt; Bool
forall i b. (Ord i, Ord b) =&gt; Matrix i b -&gt; Matrix i b -&gt; Ordering
forall i b.
(Ord i, Ord b) =&gt;
Matrix i b -&gt; Matrix i b -&gt; Matrix i b
$ccompare :: forall i b. (Ord i, Ord b) =&gt; Matrix i b -&gt; Matrix i b -&gt; Ordering
compare :: Matrix i b -&gt; Matrix i b -&gt; Ordering
$c&lt; :: forall i b. (Ord i, Ord b) =&gt; Matrix i b -&gt; Matrix i b -&gt; Bool
&lt; :: Matrix i b -&gt; Matrix i b -&gt; Bool
$c&lt;= :: forall i b. (Ord i, Ord b) =&gt; Matrix i b -&gt; Matrix i b -&gt; Bool
&lt;= :: Matrix i b -&gt; Matrix i b -&gt; Bool
$c&gt; :: forall i b. (Ord i, Ord b) =&gt; Matrix i b -&gt; Matrix i b -&gt; Bool
&gt; :: Matrix i b -&gt; Matrix i b -&gt; Bool
$c&gt;= :: forall i b. (Ord i, Ord b) =&gt; Matrix i b -&gt; Matrix i b -&gt; Bool
&gt;= :: Matrix i b -&gt; Matrix i b -&gt; Bool
$cmax :: forall i b.
(Ord i, Ord b) =&gt;
Matrix i b -&gt; Matrix i b -&gt; Matrix i b
max :: Matrix i b -&gt; Matrix i b -&gt; Matrix i b
$cmin :: forall i b.
(Ord i, Ord b) =&gt;
Matrix i b -&gt; Matrix i b -&gt; Matrix i b
min :: Matrix i b -&gt; Matrix i b -&gt; Matrix i b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681558780"><span id="local-6989586621681558784"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; Matrix i a -&gt; Matrix i b)
-&gt; (forall a b. a -&gt; Matrix i b -&gt; Matrix i a)
-&gt; Functor (Matrix i)
forall a b. a -&gt; Matrix i b -&gt; Matrix i a
forall a b. (a -&gt; b) -&gt; Matrix i a -&gt; Matrix i b
forall i a b. a -&gt; Matrix i b -&gt; Matrix i a
forall i a b. (a -&gt; b) -&gt; Matrix i a -&gt; Matrix i b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall i a b. (a -&gt; b) -&gt; Matrix i a -&gt; Matrix i b
fmap :: forall a b. (a -&gt; b) -&gt; Matrix i a -&gt; Matrix i b
$c&lt;$ :: forall i a b. a -&gt; Matrix i b -&gt; Matrix i a
&lt;$ :: forall a b. a -&gt; Matrix i b -&gt; Matrix i a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681558790"><span id="local-6989586621681558796"><span id="local-6989586621681558802"><span id="local-6989586621681558807"><span id="local-6989586621681558810"><span id="local-6989586621681558813"><span id="local-6989586621681558816"><span id="local-6989586621681558819"><span id="local-6989586621681558822"><span id="local-6989586621681558825"><span id="local-6989586621681558828"><span id="local-6989586621681558831"><span id="local-6989586621681558834"><span id="local-6989586621681558839"><span id="local-6989586621681558844"><span id="local-6989586621681558849"><span id="local-6989586621681558854"><span class="annot"><span class="annottext">(forall m. Monoid m =&gt; Matrix i m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Matrix i a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Matrix i a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Matrix i a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Matrix i a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Matrix i a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Matrix i a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; Matrix i a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; Matrix i a -&gt; a)
-&gt; (forall a. Matrix i a -&gt; [a])
-&gt; (forall a. Matrix i a -&gt; Bool)
-&gt; (forall a. Matrix i a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; Matrix i a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; Matrix i a -&gt; a)
-&gt; (forall a. Ord a =&gt; Matrix i a -&gt; a)
-&gt; (forall a. Num a =&gt; Matrix i a -&gt; a)
-&gt; (forall a. Num a =&gt; Matrix i a -&gt; a)
-&gt; Foldable (Matrix i)
forall a. Eq a =&gt; a -&gt; Matrix i a -&gt; Bool
forall a. Num a =&gt; Matrix i a -&gt; a
forall a. Ord a =&gt; Matrix i a -&gt; a
forall m. Monoid m =&gt; Matrix i m -&gt; m
forall a. Matrix i a -&gt; Bool
forall a. Matrix i a -&gt; Int
forall a. Matrix i a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; Matrix i a -&gt; a
forall i a. Eq a =&gt; a -&gt; Matrix i a -&gt; Bool
forall i a. Num a =&gt; Matrix i a -&gt; a
forall i a. Ord a =&gt; Matrix i a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Matrix i a -&gt; m
forall i m. Monoid m =&gt; Matrix i m -&gt; m
forall i a. Matrix i a -&gt; Bool
forall i a. Matrix i a -&gt; Int
forall i a. Matrix i a -&gt; [a]
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Matrix i a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Matrix i a -&gt; b
forall i a. (a -&gt; a -&gt; a) -&gt; Matrix i a -&gt; a
forall i m a. Monoid m =&gt; (a -&gt; m) -&gt; Matrix i a -&gt; m
forall i b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Matrix i a -&gt; b
forall i a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Matrix i a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
$cfold :: forall i m. Monoid m =&gt; Matrix i m -&gt; m
fold :: forall m. Monoid m =&gt; Matrix i m -&gt; m
$cfoldMap :: forall i m a. Monoid m =&gt; (a -&gt; m) -&gt; Matrix i a -&gt; m
foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Matrix i a -&gt; m
$cfoldMap' :: forall i m a. Monoid m =&gt; (a -&gt; m) -&gt; Matrix i a -&gt; m
foldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Matrix i a -&gt; m
$cfoldr :: forall i a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Matrix i a -&gt; b
foldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Matrix i a -&gt; b
$cfoldr' :: forall i a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Matrix i a -&gt; b
foldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Matrix i a -&gt; b
$cfoldl :: forall i b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Matrix i a -&gt; b
foldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Matrix i a -&gt; b
$cfoldl' :: forall i b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Matrix i a -&gt; b
foldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Matrix i a -&gt; b
$cfoldr1 :: forall i a. (a -&gt; a -&gt; a) -&gt; Matrix i a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; Matrix i a -&gt; a
$cfoldl1 :: forall i a. (a -&gt; a -&gt; a) -&gt; Matrix i a -&gt; a
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; Matrix i a -&gt; a
$ctoList :: forall i a. Matrix i a -&gt; [a]
toList :: forall a. Matrix i a -&gt; [a]
$cnull :: forall i a. Matrix i a -&gt; Bool
null :: forall a. Matrix i a -&gt; Bool
$clength :: forall i a. Matrix i a -&gt; Int
length :: forall a. Matrix i a -&gt; Int
$celem :: forall i a. Eq a =&gt; a -&gt; Matrix i a -&gt; Bool
elem :: forall a. Eq a =&gt; a -&gt; Matrix i a -&gt; Bool
$cmaximum :: forall i a. Ord a =&gt; Matrix i a -&gt; a
maximum :: forall a. Ord a =&gt; Matrix i a -&gt; a
$cminimum :: forall i a. Ord a =&gt; Matrix i a -&gt; a
minimum :: forall a. Ord a =&gt; Matrix i a -&gt; a
$csum :: forall i a. Num a =&gt; Matrix i a -&gt; a
sum :: forall a. Num a =&gt; Matrix i a -&gt; a
$cproduct :: forall i a. Num a =&gt; Matrix i a -&gt; a
product :: forall a. Num a =&gt; Matrix i a -&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681558867"><span id="local-6989586621681558876"><span id="local-6989586621681558882"><span id="local-6989586621681558887"><span class="annot"><span class="annottext">Functor (Matrix i)
Foldable (Matrix i)
(Functor (Matrix i), Foldable (Matrix i)) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; Matrix i a -&gt; f (Matrix i b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    Matrix i (f a) -&gt; f (Matrix i a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; Matrix i a -&gt; m (Matrix i b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    Matrix i (m a) -&gt; m (Matrix i a))
-&gt; Traversable (Matrix i)
forall i. Functor (Matrix i)
forall i. Foldable (Matrix i)
forall i (m :: * -&gt; *) a.
Monad m =&gt;
Matrix i (m a) -&gt; m (Matrix i a)
forall i (f :: * -&gt; *) a.
Applicative f =&gt;
Matrix i (f a) -&gt; f (Matrix i a)
forall i (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Matrix i a -&gt; m (Matrix i b)
forall i (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Matrix i a -&gt; f (Matrix i b)
forall (t :: * -&gt; *).
(Functor t, Foldable t) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a. Monad m =&gt; Matrix i (m a) -&gt; m (Matrix i a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
Matrix i (f a) -&gt; f (Matrix i a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Matrix i a -&gt; m (Matrix i b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Matrix i a -&gt; f (Matrix i b)
$ctraverse :: forall i (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Matrix i a -&gt; f (Matrix i b)
traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Matrix i a -&gt; f (Matrix i b)
$csequenceA :: forall i (f :: * -&gt; *) a.
Applicative f =&gt;
Matrix i (f a) -&gt; f (Matrix i a)
sequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
Matrix i (f a) -&gt; f (Matrix i a)
$cmapM :: forall i (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Matrix i a -&gt; m (Matrix i b)
mapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Matrix i a -&gt; m (Matrix i b)
$csequence :: forall i (m :: * -&gt; *) a.
Monad m =&gt;
Matrix i (m a) -&gt; m (Matrix i a)
sequence :: forall (m :: * -&gt; *) a. Monad m =&gt; Matrix i (m a) -&gt; m (Matrix i a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-113"></span><span class="annot"><span class="hs-comment">-- * Operations and query on matrix size.</span></span><span>
</span><span id="line-114"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="annot"><span class="hs-comment">-- | 'True' iff the matrix is square.</span></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span id="local-6989586621681558362"><span id="local-6989586621681558363"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#square"><span class="hs-identifier hs-type">square</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621681558362"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558362"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558363"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-119"></span><span id="square"><span class="annot"><span class="annottext">square :: forall i b. Ix i =&gt; Matrix i b -&gt; Bool
</span><a href="Agda.Termination.SparseMatrix.html#square"><span class="hs-identifier hs-var hs-var">square</span></a></span></span><span> </span><span id="local-6989586621681558898"><span class="annot"><span class="annottext">Matrix i b
</span><a href="#local-6989586621681558898"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Size i -&gt; i
forall i. Size i -&gt; i
</span><a href="Agda.Termination.SparseMatrix.html#rows"><span class="hs-identifier hs-var">rows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix i b -&gt; Size i
forall i b. Matrix i b -&gt; Size i
</span><a href="Agda.Termination.SparseMatrix.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i b
</span><a href="#local-6989586621681558898"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Size i -&gt; i
forall i. Size i -&gt; i
</span><a href="Agda.Termination.SparseMatrix.html#cols"><span class="hs-identifier hs-var">cols</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix i b -&gt; Size i
forall i b. Matrix i b -&gt; Size i
</span><a href="Agda.Termination.SparseMatrix.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i b
</span><a href="#local-6989586621681558898"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="annot"><span class="hs-comment">-- | Returns 'True' iff the matrix is empty.</span></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span id="local-6989586621681558366"><span id="local-6989586621681558367"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#isEmpty"><span class="hs-identifier hs-type">isEmpty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621681558366"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621681558366"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558366"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558367"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-124"></span><span id="isEmpty"><span class="annot"><span class="annottext">isEmpty :: forall i b. (Num i, Ix i) =&gt; Matrix i b -&gt; Bool
</span><a href="Agda.Termination.SparseMatrix.html#isEmpty"><span class="hs-identifier hs-var hs-var">isEmpty</span></a></span></span><span> </span><span id="local-6989586621681558906"><span class="annot"><span class="annottext">Matrix i b
</span><a href="#local-6989586621681558906"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Size i -&gt; i
forall i. Size i -&gt; i
</span><a href="Agda.Termination.SparseMatrix.html#rows"><span class="hs-identifier hs-var">rows</span></a></span><span> </span><span class="annot"><span class="annottext">Size i
</span><a href="#local-6989586621681558907"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Size i -&gt; i
forall i. Size i -&gt; i
</span><a href="Agda.Termination.SparseMatrix.html#cols"><span class="hs-identifier hs-var">cols</span></a></span><span> </span><span class="annot"><span class="annottext">Size i
</span><a href="#local-6989586621681558907"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-number">0</span></span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681558907"><span class="annot"><span class="annottext">sz :: Size i
</span><a href="#local-6989586621681558907"><span class="hs-identifier hs-var hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix i b -&gt; Size i
forall i b. Matrix i b -&gt; Size i
</span><a href="Agda.Termination.SparseMatrix.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i b
</span><a href="#local-6989586621681558906"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><span class="hs-comment">-- | Compute the matrix size of the union of two matrices.</span></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span id="local-6989586621681558371"><span id="local-6989586621681558372"><span id="local-6989586621681558373"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#supSize"><span class="hs-identifier hs-type">supSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681558371"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558371"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558372"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558371"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558373"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558371"><span class="hs-identifier hs-type">i</span></a></span></span></span></span><span>
</span><span id="line-130"></span><span id="supSize"><span class="annot"><span class="annottext">supSize :: forall i a b. Ord i =&gt; Matrix i a -&gt; Matrix i b -&gt; Size i
</span><a href="Agda.Termination.SparseMatrix.html#supSize"><span class="hs-identifier hs-var hs-var">supSize</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span id="local-6989586621681558912"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558912"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span id="local-6989586621681558913"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558913"><span class="hs-identifier hs-var">c1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(MIx i, a)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span id="local-6989586621681558914"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558914"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span id="local-6989586621681558915"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558915"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(MIx i, b)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-131"></span><span>  </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Size i
forall i. i -&gt; i -&gt; Size i
</span><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-var">Size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558912"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558914"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558913"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558915"><span class="hs-identifier hs-var">c2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="annot"><span class="hs-comment">-- | Compute the matrix size of the intersection of two matrices.</span></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span id="local-6989586621681558917"><span id="local-6989586621681558918"><span id="local-6989586621681558919"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#infSize"><span class="hs-identifier hs-type">infSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681558917"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558917"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558918"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558917"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558919"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558917"><span class="hs-identifier hs-type">i</span></a></span></span></span></span><span>
</span><span id="line-136"></span><span id="infSize"><span class="annot"><span class="annottext">infSize :: forall i a b. Ord i =&gt; Matrix i a -&gt; Matrix i b -&gt; Size i
</span><a href="Agda.Termination.SparseMatrix.html#infSize"><span class="hs-identifier hs-var hs-var">infSize</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span id="local-6989586621681558924"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558924"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span id="local-6989586621681558925"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558925"><span class="hs-identifier hs-var">c1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(MIx i, a)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span id="local-6989586621681558926"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558926"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span id="local-6989586621681558927"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558927"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(MIx i, b)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-137"></span><span>  </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Size i
forall i. i -&gt; i -&gt; Size i
</span><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-var">Size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558924"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558926"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558925"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558927"><span class="hs-identifier hs-var">c2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-140"></span><span class="annot"><span class="hs-comment">-- * Creating matrices and converting to lists.</span></span><span>
</span><span id="line-141"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-comment">-- | Constructs a matrix from a list of @(index, value)@-pairs.</span><span>
</span><span id="line-144"></span><span class="hs-comment">--   @O(n)@ where @n@ is size of the list.</span><span>
</span><span id="line-145"></span><span class="hs-comment">--</span><span>
</span><span id="line-146"></span><span class="hs-comment">--   Precondition: indices are unique.</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span id="local-6989586621681558380"><span id="local-6989586621681558381"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#fromIndexList"><span class="hs-identifier hs-type">fromIndexList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681558380"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.Semiring.html#HasZero"><span class="hs-identifier hs-type">HasZero</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558381"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558380"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#MIx"><span class="hs-identifier hs-type">MIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558380"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681558381"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558380"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558381"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-149"></span><span id="fromIndexList"><span class="annot"><span class="annottext">fromIndexList :: forall i b.
(Ord i, HasZero b) =&gt;
Size i -&gt; [(MIx i, b)] -&gt; Matrix i b
</span><a href="Agda.Termination.SparseMatrix.html#fromIndexList"><span class="hs-identifier hs-var hs-var">fromIndexList</span></a></span></span><span> </span><span id="local-6989586621681558936"><span class="annot"><span class="annottext">Size i
</span><a href="#local-6989586621681558936"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Size i -&gt; [(MIx i, b)] -&gt; Matrix i b
forall i b. Size i -&gt; [(MIx i, b)] -&gt; Matrix i b
</span><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-var">Matrix</span></a></span><span> </span><span class="annot"><span class="annottext">Size i
</span><a href="#local-6989586621681558936"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-150"></span><span>                 </span><span class="annot"><span class="annottext">([(MIx i, b)] -&gt; Matrix i b)
-&gt; ([(MIx i, b)] -&gt; [(MIx i, b)]) -&gt; [(MIx i, b)] -&gt; Matrix i b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((MIx i, b) -&gt; (MIx i, b) -&gt; Ordering)
-&gt; [(MIx i, b)] -&gt; [(MIx i, b)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.sortBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MIx i -&gt; MIx i -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">(MIx i -&gt; MIx i -&gt; Ordering)
-&gt; ((MIx i, b) -&gt; MIx i) -&gt; (MIx i, b) -&gt; (MIx i, b) -&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">(MIx i, b) -&gt; MIx i
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>                 </span><span class="annot"><span class="annottext">([(MIx i, b)] -&gt; [(MIx i, b)])
-&gt; ([(MIx i, b)] -&gt; [(MIx i, b)]) -&gt; [(MIx i, b)] -&gt; [(MIx i, b)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((MIx i, b) -&gt; Bool) -&gt; [(MIx i, b)] -&gt; [(MIx i, b)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
forall a. HasZero a =&gt; a
</span><a href="Agda.Termination.Semiring.html#zeroElement"><span class="hs-identifier hs-var">zeroElement</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(b -&gt; Bool) -&gt; ((MIx i, b) -&gt; b) -&gt; (MIx i, b) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(MIx i, b) -&gt; b
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- | @'fromLists' sz rs@ constructs a matrix from a list of lists of</span><span>
</span><span id="line-154"></span><span class="hs-comment">--   values (a list of rows).</span><span>
</span><span id="line-155"></span><span class="hs-comment">--   @O(size)@ where @size = rows &#215; cols@.</span><span>
</span><span id="line-156"></span><span class="hs-comment">--</span><span>
</span><span id="line-157"></span><span class="hs-comment">--   Precondition:</span><span>
</span><span id="line-158"></span><span class="hs-comment">--   @'length' rs '==' 'rows' sz@ and</span><span>
</span><span id="line-159"></span><span class="hs-comment">--   @'all' (('cols' sz '==') . 'length') rs@.</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span id="local-6989586621681558398"><span id="local-6989586621681558399"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#fromLists"><span class="hs-identifier hs-type">fromLists</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681558398"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621681558398"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="annot"><a href="#local-6989586621681558398"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.Semiring.html#HasZero"><span class="hs-identifier hs-type">HasZero</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558399"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558398"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681558399"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558398"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558399"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-162"></span><span id="fromLists"><span class="annot"><span class="annottext">fromLists :: forall i b.
(Ord i, Num i, Enum i, HasZero b) =&gt;
Size i -&gt; [[b]] -&gt; Matrix i b
</span><a href="Agda.Termination.SparseMatrix.html#fromLists"><span class="hs-identifier hs-var hs-var">fromLists</span></a></span></span><span> </span><span id="local-6989586621681558956"><span class="annot"><span class="annottext">Size i
</span><a href="#local-6989586621681558956"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621681558957"><span class="annot"><span class="annottext">[[b]]
</span><a href="#local-6989586621681558957"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Size i -&gt; [(MIx i, b)] -&gt; Matrix i b
forall i b.
(Ord i, HasZero b) =&gt;
Size i -&gt; [(MIx i, b)] -&gt; Matrix i b
</span><a href="Agda.Termination.SparseMatrix.html#fromIndexList"><span class="hs-identifier hs-var">fromIndexList</span></a></span><span> </span><span class="annot"><span class="annottext">Size i
</span><a href="#local-6989586621681558956"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">([(MIx i, b)] -&gt; Matrix i b) -&gt; [(MIx i, b)] -&gt; Matrix i b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MIx i] -&gt; [b] -&gt; [(MIx i, b)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; MIx i
forall i. i -&gt; i -&gt; MIx i
</span><a href="Agda.Termination.SparseMatrix.html#MIx"><span class="hs-identifier hs-var">MIx</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558958"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558959"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681558958"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558958"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">i
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Size i -&gt; i
forall i. Size i -&gt; i
</span><a href="Agda.Termination.SparseMatrix.html#rows"><span class="hs-identifier hs-var">rows</span></a></span><span> </span><span class="annot"><span class="annottext">Size i
</span><a href="#local-6989586621681558956"><span class="hs-identifier hs-var">sz</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-163"></span><span>                                                    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681558959"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558959"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">i
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Size i -&gt; i
forall i. Size i -&gt; i
</span><a href="Agda.Termination.SparseMatrix.html#cols"><span class="hs-identifier hs-var">cols</span></a></span><span> </span><span class="annot"><span class="annottext">Size i
</span><a href="#local-6989586621681558956"><span class="hs-identifier hs-var">sz</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[b]] -&gt; [b]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[b]]
</span><a href="#local-6989586621681558957"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">-- | Converts a sparse matrix to a sparse list of rows.</span><span>
</span><span id="line-166"></span><span class="hs-comment">--   @O(n)@ where @n@ is the number of non-zero entries of the matrix.</span><span>
</span><span id="line-167"></span><span class="hs-comment">--</span><span>
</span><span id="line-168"></span><span class="hs-comment">--   Only non-empty rows are generated.</span><span>
</span><span id="line-169"></span><span class="hs-comment">--</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span id="local-6989586621681558411"><span id="local-6989586621681558412"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#toSparseRows"><span class="hs-identifier hs-type">toSparseRows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621681558411"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558411"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558412"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558411"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558411"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621681558412"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-172"></span><span id="toSparseRows"><span class="annot"><span class="annottext">toSparseRows :: forall i b. Eq i =&gt; Matrix i b -&gt; [(i, [(i, b)])]
</span><a href="Agda.Termination.SparseMatrix.html#toSparseRows"><span class="hs-identifier hs-var hs-var">toSparseRows</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="annottext">Size i
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-173"></span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#toSparseRows"><span class="hs-identifier hs-var">toSparseRows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="annottext">Size i
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#MIx"><span class="hs-identifier hs-type">MIx</span></a></span><span> </span><span id="local-6989586621681558963"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558963"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681558964"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558964"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681558965"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681558965"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681558966"><span class="annot"><span class="annottext">[(MIx i, b)]
</span><a href="#local-6989586621681558966"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">i -&gt; [(i, b)] -&gt; [(MIx i, b)] -&gt; [(i, [(i, b)])]
forall {a} {b}.
Eq a =&gt;
a -&gt; [(a, b)] -&gt; [(MIx a, b)] -&gt; [(a, [(a, b)])]
</span><a href="#local-6989586621681558967"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558963"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681558964"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681558965"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(MIx i, b)]
</span><a href="#local-6989586621681558966"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681558967"><span class="annot"><span class="annottext">aux :: a -&gt; [(a, b)] -&gt; [(MIx a, b)] -&gt; [(a, [(a, b)])]
</span><a href="#local-6989586621681558967"><span class="hs-identifier hs-var hs-var">aux</span></a></span></span><span> </span><span id="local-6989586621681558970"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681558970"><span class="hs-identifier hs-var">i'</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><a href="#local-6989586621681558967"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span id="local-6989586621681558971"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681558971"><span class="hs-identifier hs-var">i'</span></a></span></span><span> </span><span id="local-6989586621681558972"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621681558972"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681558971"><span class="hs-identifier hs-var">i'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; [(a, b)]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621681558972"><span class="hs-identifier hs-var">row</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><a href="#local-6989586621681558967"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span id="local-6989586621681558974"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681558974"><span class="hs-identifier hs-var">i'</span></a></span></span><span> </span><span id="local-6989586621681558975"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621681558975"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#MIx"><span class="hs-identifier hs-type">MIx</span></a></span><span> </span><span id="local-6989586621681558976"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681558976"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681558977"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681558977"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681558978"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681558978"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681558979"><span class="annot"><span class="annottext">[(MIx a, b)]
</span><a href="#local-6989586621681558979"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681558974"><span class="hs-identifier hs-var">i'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681558976"><span class="hs-identifier hs-var">i</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [(a, b)] -&gt; [(MIx a, b)] -&gt; [(a, [(a, b)])]
</span><a href="#local-6989586621681558967"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681558974"><span class="hs-identifier hs-var">i'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681558977"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681558978"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(a, b) -&gt; [(a, b)] -&gt; [(a, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621681558975"><span class="hs-identifier hs-var">row</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(MIx a, b)]
</span><a href="#local-6989586621681558979"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-178"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681558974"><span class="hs-identifier hs-var">i'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; [(a, b)]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621681558975"><span class="hs-identifier hs-var">row</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a, [(a, b)]) -&gt; [(a, [(a, b)])] -&gt; [(a, [(a, b)])]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [(a, b)] -&gt; [(MIx a, b)] -&gt; [(a, [(a, b)])]
</span><a href="#local-6989586621681558967"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681558976"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681558977"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681558978"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(MIx a, b)]
</span><a href="#local-6989586621681558979"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">-- | Turn a sparse vector into a vector by inserting a fixed element</span><span>
</span><span id="line-181"></span><span class="hs-comment">--   at the missing positions.</span><span>
</span><span id="line-182"></span><span class="hs-comment">--   @O(size)@ where @size@ is the dimension of the vector.</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span id="local-6989586621681558419"><span id="local-6989586621681558420"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#blowUpSparseVec"><span class="hs-identifier hs-type">blowUpSparseVec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621681558419"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681558420"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681558419"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558419"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621681558420"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681558420"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-185"></span><span id="blowUpSparseVec"><span class="annot"><span class="annottext">blowUpSparseVec :: forall i b. Integral i =&gt; b -&gt; i -&gt; [(i, b)] -&gt; [b]
</span><a href="Agda.Termination.SparseMatrix.html#blowUpSparseVec"><span class="hs-identifier hs-var hs-var">blowUpSparseVec</span></a></span></span><span> </span><span id="local-6989586621681559003"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681559003"><span class="hs-identifier hs-var">zero</span></a></span></span><span> </span><span id="local-6989586621681559004"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559004"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681559005"><span class="annot"><span class="annottext">[(i, b)]
</span><a href="#local-6989586621681559005"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">i -&gt; [(i, b)] -&gt; [b]
</span><a href="#local-6989586621681559006"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[(i, b)]
</span><a href="#local-6989586621681559005"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681559006"><span class="annot"><span class="annottext">aux :: i -&gt; [(i, b)] -&gt; [b]
</span><a href="#local-6989586621681559006"><span class="hs-identifier hs-var hs-var">aux</span></a></span></span><span> </span><span id="local-6989586621681559007"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559007"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">i -&gt; b -&gt; [b]
forall i a. Integral i =&gt; i -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">List.genericReplicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559004"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559007"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681559003"><span class="hs-identifier hs-var">zero</span></a></span><span>
</span><span id="line-187"></span><span>        </span><span class="annot"><a href="#local-6989586621681559006"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span id="local-6989586621681559010"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559010"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681559011"><span class="annot"><span class="annottext">l :: [(i, b)]
</span><a href="#local-6989586621681559011"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681559012"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559012"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681559013"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681559013"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681559014"><span class="annot"><span class="annottext">[(i, b)]
</span><a href="#local-6989586621681559014"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559010"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559012"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559010"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559004"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[b]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-189"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559010"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559012"><span class="hs-identifier hs-var">j</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681559013"><span class="hs-identifier hs-var">b</span></a></span><span>    </span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; [(i, b)] -&gt; [b]
</span><a href="#local-6989586621681559006"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559010"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(i, b)]
</span><a href="#local-6989586621681559014"><span class="hs-identifier hs-var">l'</span></a></span><span>
</span><span id="line-190"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681559003"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; [(i, b)] -&gt; [b]
</span><a href="#local-6989586621681559006"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559010"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(i, b)]
</span><a href="#local-6989586621681559011"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- UNUSED Liang-Ting Chen 2019-07-15</span><span>
</span><span id="line-193"></span><span class="hs-comment">---- Older implementation without replicate.</span><span>
</span><span id="line-194"></span><span class="hs-comment">--blowUpSparseVec' :: (Ord i, Num i, Enum i) =&gt; b -&gt; i -&gt; [(i,b)] -&gt; [b]</span><span>
</span><span id="line-195"></span><span class="hs-comment">--blowUpSparseVec' zero n l = aux 1 l</span><span>
</span><span id="line-196"></span><span class="hs-comment">--  where aux i [] | i &gt; n = []</span><span>
</span><span id="line-197"></span><span class="hs-comment">--                 | otherwise = zero : aux (i+1) []</span><span>
</span><span id="line-198"></span><span class="hs-comment">--        aux i ((j,b):l) | i &lt;= n &amp;&amp; j == i = b : aux (succ i) l</span><span>
</span><span id="line-199"></span><span class="hs-comment">--        aux i ((j,b):l) | i &lt;= n &amp;&amp; j &gt;= i = zero : aux (succ i) ((j,b):l)</span><span>
</span><span id="line-200"></span><span class="hs-comment">--        aux i l = __IMPOSSIBLE__</span><span>
</span><span id="line-201"></span><span class="hs-comment">--          -- error $ &quot;blowUpSparseVec (n = &quot; ++ show n ++ &quot;) aux i=&quot; ++ show i ++ &quot; j=&quot; ++ show (fst (head l)) ++ &quot; length l = &quot; ++ show (length l)</span><span>
</span><span id="line-202"></span><span class="hs-comment">--</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- | Converts a matrix to a list of row lists.</span><span>
</span><span id="line-204"></span><span class="hs-comment">--   @O(size)@ where @size = rows &#215; cols@.</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span id="local-6989586621681558429"><span id="local-6989586621681558430"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#toLists"><span class="hs-identifier hs-type">toLists</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621681558429"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.Semiring.html#HasZero"><span class="hs-identifier hs-type">HasZero</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558430"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558429"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558430"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681558430"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-207"></span><span id="toLists"><span class="annot"><span class="annottext">toLists :: forall i b. (Integral i, HasZero b) =&gt; Matrix i b -&gt; [[b]]
</span><a href="Agda.Termination.SparseMatrix.html#toLists"><span class="hs-identifier hs-var hs-var">toLists</span></a></span></span><span> </span><span id="local-6989586621681559027"><span class="annot"><span class="annottext">m :: Matrix i b
</span><a href="#local-6989586621681559027"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span id="local-6989586621681559028"><span class="annot"><span class="annottext">size :: Size i
</span><a href="#local-6989586621681559028"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span id="local-6989586621681559029"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559029"><span class="hs-identifier hs-var">nrows</span></a></span></span><span> </span><span id="local-6989586621681559030"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559030"><span class="hs-identifier hs-var">ncols</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(MIx i, b)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="annottext">[b] -&gt; i -&gt; [(i, [b])] -&gt; [[b]]
forall i b. Integral i =&gt; b -&gt; i -&gt; [(i, b)] -&gt; [b]
</span><a href="Agda.Termination.SparseMatrix.html#blowUpSparseVec"><span class="hs-identifier hs-var">blowUpSparseVec</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621681559031"><span class="hs-identifier hs-var">emptyRow</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559029"><span class="hs-identifier hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">([(i, [b])] -&gt; [[b]]) -&gt; [(i, [b])] -&gt; [[b]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-209"></span><span>      </span><span class="annot"><span class="annottext">((i, [(i, b)]) -&gt; (i, [b])) -&gt; [(i, [(i, b)])] -&gt; [(i, [b])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([(i, b)] -&gt; [b]) -&gt; (i, [(i, b)]) -&gt; (i, [b])
forall b d a. (b -&gt; d) -&gt; (a, b) -&gt; (a, d)
</span><a href="Agda.Utils.Tuple.html#mapSnd"><span class="hs-identifier hs-var">mapSnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; i -&gt; [(i, b)] -&gt; [b]
forall i b. Integral i =&gt; b -&gt; i -&gt; [(i, b)] -&gt; [b]
</span><a href="Agda.Termination.SparseMatrix.html#blowUpSparseVec"><span class="hs-identifier hs-var">blowUpSparseVec</span></a></span><span> </span><span class="annot"><span class="annottext">b
forall a. HasZero a =&gt; a
</span><a href="Agda.Termination.Semiring.html#zeroElement"><span class="hs-identifier hs-var">zeroElement</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559030"><span class="hs-identifier hs-var">ncols</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(i, [(i, b)])] -&gt; [(i, [b])]) -&gt; [(i, [(i, b)])] -&gt; [(i, [b])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix i b -&gt; [(i, [(i, b)])]
forall i b. Eq i =&gt; Matrix i b -&gt; [(i, [(i, b)])]
</span><a href="Agda.Termination.SparseMatrix.html#toSparseRows"><span class="hs-identifier hs-var">toSparseRows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i b
</span><a href="#local-6989586621681559027"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-211"></span><span>    </span><span id="local-6989586621681559031"><span class="annot"><span class="annottext">emptyRow :: [b]
</span><a href="#local-6989586621681559031"><span class="hs-identifier hs-var hs-var">emptyRow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">i -&gt; b -&gt; [b]
forall i a. Integral i =&gt; i -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">List.genericReplicate</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559030"><span class="hs-identifier hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">b
forall a. HasZero a =&gt; a
</span><a href="Agda.Termination.Semiring.html#zeroElement"><span class="hs-identifier hs-var">zeroElement</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-214"></span><span class="annot"><span class="hs-comment">-- * Combining and querying matrices</span></span><span>
</span><span id="line-215"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- | Returns 'Just b' iff it is a 1x1 matrix with just one entry 'b'.</span><span>
</span><span id="line-218"></span><span class="hs-comment">--   @O(1)@.</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span id="local-6989586621681558438"><span id="local-6989586621681558439"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#isSingleton"><span class="hs-identifier hs-type">isSingleton</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621681558438"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621681558438"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.Semiring.html#HasZero"><span class="hs-identifier hs-type">HasZero</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558439"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558438"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558439"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621681558439"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-221"></span><span id="isSingleton"><span class="annot"><span class="annottext">isSingleton :: forall i b. (Eq i, Num i, HasZero b) =&gt; Matrix i b -&gt; Maybe b
</span><a href="Agda.Termination.SparseMatrix.html#isSingleton"><span class="hs-identifier hs-var hs-var">isSingleton</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">MIx i
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621681559051"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681559051"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; Maybe b
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681559051"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-222"></span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#isSingleton"><span class="hs-identifier hs-var">isSingleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; Maybe b
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">b
forall a. HasZero a =&gt; a
</span><a href="Agda.Termination.Semiring.html#zeroElement"><span class="hs-identifier hs-var">zeroElement</span></a></span><span>
</span><span id="line-223"></span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#isSingleton"><span class="hs-identifier hs-var">isSingleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(MIx i, b)]
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe b
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-224"></span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#isSingleton"><span class="hs-identifier hs-var">isSingleton</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe b
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="hs-comment">-- | @'diagonal' m@ extracts the diagonal of @m@.</span><span>
</span><span id="line-227"></span><span class="hs-comment">--</span><span>
</span><span id="line-228"></span><span class="hs-comment">--   For non-square matrices, the length of the diagonal is</span><span>
</span><span id="line-229"></span><span class="hs-comment">--   the minimum of the dimensions of the matrix.</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-keyword">class</span><span> </span><span id="Diagonal"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Diagonal"><span class="hs-identifier hs-var">Diagonal</span></a></span></span><span> </span><span id="local-6989586621681558445"><span class="annot"><a href="#local-6989586621681558445"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621681558446"><span class="annot"><a href="#local-6989586621681558446"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621681558445"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681558446"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-232"></span><span>  </span><span id="diagonal"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#diagonal"><span class="hs-identifier hs-type">diagonal</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681558445"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681558446"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-comment">-- | Diagonal of sparse matrix.</span><span>
</span><span id="line-235"></span><span class="hs-comment">--</span><span>
</span><span id="line-236"></span><span class="hs-comment">--   @O(n)@ where @n@ is the number of non-zero elements in the matrix.</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681558447"><span id="local-6989586621681558448"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621681558447"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.Semiring.html#HasZero"><span class="hs-identifier hs-type">HasZero</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558448"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Diagonal"><span class="hs-identifier hs-type">Diagonal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558447"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558448"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681558448"><span class="hs-identifier hs-type">b</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-239"></span><span>  </span><span id="local-6989586621681559065"><span class="annot"><span class="annottext">diagonal :: Matrix i b -&gt; [b]
</span><a href="Agda.Termination.SparseMatrix.html#diagonal"><span class="hs-identifier hs-var hs-var hs-var">diagonal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span id="local-6989586621681559066"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559066"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681559067"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559067"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681559068"><span class="annot"><span class="annottext">[(MIx i, b)]
</span><a href="#local-6989586621681559068"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-240"></span><span>    </span><span class="annot"><span class="annottext">b -&gt; i -&gt; [(i, b)] -&gt; [b]
forall i b. Integral i =&gt; b -&gt; i -&gt; [(i, b)] -&gt; [b]
</span><a href="Agda.Termination.SparseMatrix.html#blowUpSparseVec"><span class="hs-identifier hs-var">blowUpSparseVec</span></a></span><span> </span><span class="annot"><span class="annottext">b
forall a. HasZero a =&gt; a
</span><a href="Agda.Termination.Semiring.html#zeroElement"><span class="hs-identifier hs-var">zeroElement</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559066"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559067"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(i, b)] -&gt; [b]) -&gt; [(i, b)] -&gt; [b]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-241"></span><span>      </span><span class="annot"><span class="annottext">((MIx i, b) -&gt; Maybe (i, b)) -&gt; [(MIx i, b)] -&gt; [(i, b)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#MIx"><span class="hs-identifier hs-type">MIx</span></a></span><span> </span><span id="local-6989586621681559070"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559070"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681559071"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559071"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681559072"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681559072"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559070"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559071"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(i, b) -&gt; Maybe (i, b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559070"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681559072"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (i, b)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(MIx i, b)]
</span><a href="#local-6989586621681559068"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="annot"><span class="hs-comment">-- | Transposable things.</span></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-keyword">class</span><span> </span><span id="Transpose"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Transpose"><span class="hs-identifier hs-var">Transpose</span></a></span></span><span> </span><span id="local-6989586621681558453"><span class="annot"><a href="#local-6989586621681558453"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-246"></span><span>  </span><span id="transpose"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#transpose"><span class="hs-identifier hs-type">transpose</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681558453"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681558453"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><span class="hs-comment">-- | Size of transposed matrix.</span></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681558454"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Transpose"><span class="hs-identifier hs-type">Transpose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558454"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-251"></span><span>  </span><span id="local-6989586621681559076"><span class="annot"><span class="annottext">transpose :: Size i -&gt; Size i
</span><a href="Agda.Termination.SparseMatrix.html#transpose"><span class="hs-identifier hs-var hs-var hs-var">transpose</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span id="local-6989586621681559077"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559077"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681559078"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559078"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Size i
forall i. i -&gt; i -&gt; Size i
</span><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-var">Size</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559078"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559077"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="annot"><span class="hs-comment">-- | Transposing coordinates.</span></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681558456"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Transpose"><span class="hs-identifier hs-type">Transpose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#MIx"><span class="hs-identifier hs-type">MIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558456"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-256"></span><span>  </span><span id="local-6989586621681559081"><span class="annot"><span class="annottext">transpose :: MIx i -&gt; MIx i
</span><a href="Agda.Termination.SparseMatrix.html#transpose"><span class="hs-identifier hs-var hs-var hs-var">transpose</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#MIx"><span class="hs-identifier hs-type">MIx</span></a></span><span> </span><span id="local-6989586621681559082"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559082"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681559083"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559083"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; MIx i
forall i. i -&gt; i -&gt; MIx i
</span><a href="Agda.Termination.SparseMatrix.html#MIx"><span class="hs-identifier hs-var">MIx</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559083"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559082"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-comment">-- | Matrix transposition.</span><span>
</span><span id="line-259"></span><span class="hs-comment">--</span><span>
</span><span id="line-260"></span><span class="hs-comment">--   @O(n log n)@ where @n@ is the number of non-zero elements in the matrix.</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681558459"><span id="local-6989586621681558460"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681558459"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Transpose"><span class="hs-identifier hs-type">Transpose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558459"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558460"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-263"></span><span>  </span><span id="local-6989586621681559090"><span class="annot"><span class="annottext">transpose :: Matrix i b -&gt; Matrix i b
</span><a href="Agda.Termination.SparseMatrix.html#transpose"><span class="hs-identifier hs-var hs-var hs-var">transpose</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span id="local-6989586621681559091"><span class="annot"><span class="annottext">Size i
</span><a href="#local-6989586621681559091"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621681559092"><span class="annot"><span class="annottext">[(MIx i, b)]
</span><a href="#local-6989586621681559092"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><span class="annottext">Size i -&gt; [(MIx i, b)] -&gt; Matrix i b
forall i b. Size i -&gt; [(MIx i, b)] -&gt; Matrix i b
</span><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-var">Matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Size i -&gt; Size i
forall a. Transpose a =&gt; a -&gt; a
</span><a href="Agda.Termination.SparseMatrix.html#transpose"><span class="hs-identifier hs-var">transpose</span></a></span><span> </span><span class="annot"><span class="annottext">Size i
</span><a href="#local-6989586621681559091"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(MIx i, b)] -&gt; Matrix i b) -&gt; [(MIx i, b)] -&gt; Matrix i b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-265"></span><span>      </span><span class="annot"><span class="annottext">((MIx i, b) -&gt; (MIx i, b) -&gt; Ordering)
-&gt; [(MIx i, b)] -&gt; [(MIx i, b)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.sortBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MIx i -&gt; MIx i -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">(MIx i -&gt; MIx i -&gt; Ordering)
-&gt; ((MIx i, b) -&gt; MIx i) -&gt; (MIx i, b) -&gt; (MIx i, b) -&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">(MIx i, b) -&gt; MIx i
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(MIx i, b)] -&gt; [(MIx i, b)]) -&gt; [(MIx i, b)] -&gt; [(MIx i, b)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-266"></span><span>        </span><span class="annot"><span class="annottext">((MIx i, b) -&gt; (MIx i, b)) -&gt; [(MIx i, b)] -&gt; [(MIx i, b)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(MIx i -&gt; MIx i) -&gt; (MIx i, b) -&gt; (MIx i, b)
forall a c b. (a -&gt; c) -&gt; (a, b) -&gt; (c, b)
</span><a href="Agda.Utils.Tuple.html#mapFst"><span class="hs-identifier hs-var">mapFst</span></a></span><span> </span><span class="annot"><span class="annottext">MIx i -&gt; MIx i
forall a. Transpose a =&gt; a -&gt; a
</span><a href="Agda.Termination.SparseMatrix.html#transpose"><span class="hs-identifier hs-var">transpose</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(MIx i, b)]
</span><a href="#local-6989586621681559092"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- | General pointwise combination function for association lists.</span><span>
</span><span id="line-270"></span><span class="hs-comment">--   @O(n1 + n2)@ where @ni@ is the number of non-zero element in matrix @i@.</span><span>
</span><span id="line-271"></span><span class="hs-comment">--</span><span>
</span><span id="line-272"></span><span class="hs-comment">--   In @zipAssocWith fs gs f g h l l'@,</span><span>
</span><span id="line-273"></span><span class="hs-comment">--</span><span>
</span><span id="line-274"></span><span class="hs-comment">--   @fs@ is possibly more efficient version of</span><span>
</span><span id="line-275"></span><span class="hs-comment">--   @'mapMaybe' (\ (i, a) -&gt; (i,) &lt;$&gt; f a)@, and same for @gs@ and @g@.</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span id="local-6989586621681558464"><span id="local-6989586621681558465"><span id="local-6989586621681558466"><span id="local-6989586621681558467"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#zipAssocWith"><span class="hs-identifier hs-type">zipAssocWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681558464"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558464"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621681558465"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558464"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621681558466"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Only left map remaining.</span></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558464"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621681558467"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558464"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621681558466"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Only right map remaining.</span></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558465"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621681558466"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Element only present in left map.</span></span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558467"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621681558466"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Element only present in right map.</span></span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558465"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681558467"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621681558466"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Element present in both maps.</span></span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558464"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621681558465"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558464"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621681558467"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558464"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621681558466"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-284"></span><span id="zipAssocWith"><span class="annot"><span class="annottext">zipAssocWith :: forall i a c b.
Ord i =&gt;
([(i, a)] -&gt; [(i, c)])
-&gt; ([(i, b)] -&gt; [(i, c)])
-&gt; (a -&gt; Maybe c)
-&gt; (b -&gt; Maybe c)
-&gt; (a -&gt; b -&gt; Maybe c)
-&gt; [(i, a)]
-&gt; [(i, b)]
-&gt; [(i, c)]
</span><a href="Agda.Termination.SparseMatrix.html#zipAssocWith"><span class="hs-identifier hs-var hs-var">zipAssocWith</span></a></span></span><span> </span><span id="local-6989586621681559102"><span class="annot"><span class="annottext">[(i, a)] -&gt; [(i, c)]
</span><a href="#local-6989586621681559102"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span id="local-6989586621681559103"><span class="annot"><span class="annottext">[(i, b)] -&gt; [(i, c)]
</span><a href="#local-6989586621681559103"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span id="local-6989586621681559104"><span class="annot"><span class="annottext">a -&gt; Maybe c
</span><a href="#local-6989586621681559104"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681559105"><span class="annot"><span class="annottext">b -&gt; Maybe c
</span><a href="#local-6989586621681559105"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621681559106"><span class="annot"><span class="annottext">a -&gt; b -&gt; Maybe c
</span><a href="#local-6989586621681559106"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(i, a)] -&gt; [(i, b)] -&gt; [(i, c)]
</span><a href="#local-6989586621681559107"><span class="hs-identifier hs-var">merge</span></a></span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-286"></span><span>    </span><span id="local-6989586621681559107"><span class="annot"><span class="annottext">merge :: [(i, a)] -&gt; [(i, b)] -&gt; [(i, c)]
</span><a href="#local-6989586621681559107"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span id="local-6989586621681559108"><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559108"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((i, a) -&gt; Maybe (i, c)) -&gt; [(i, a)] -&gt; [(i, c)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681559109"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559109"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681559110"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681559110"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559109"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(c -&gt; (i, c)) -&gt; Maybe c -&gt; Maybe (i, c)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe c
</span><a href="#local-6989586621681559104"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681559110"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559108"><span class="hs-identifier hs-var">m1</span></a></span><span>
</span><span id="line-287"></span><span>    </span><span class="annot"><a href="#local-6989586621681559107"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621681559112"><span class="annot"><span class="annottext">[(i, b)]
</span><a href="#local-6989586621681559112"><span class="hs-identifier hs-var">m2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((i, b) -&gt; Maybe (i, c)) -&gt; [(i, b)] -&gt; [(i, c)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681559113"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559113"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681559114"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681559114"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559113"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(c -&gt; (i, c)) -&gt; Maybe c -&gt; Maybe (i, c)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Maybe c
</span><a href="#local-6989586621681559105"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681559114"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(i, b)]
</span><a href="#local-6989586621681559112"><span class="hs-identifier hs-var">m2</span></a></span><span>
</span><span id="line-288"></span><span>    </span><span class="annot"><a href="#local-6989586621681559107"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span id="local-6989586621681559115"><span class="annot"><span class="annottext">m1 :: [(i, a)]
</span><a href="#local-6989586621681559115"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681559116"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559116"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681559117"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681559117"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681559118"><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559118"><span class="hs-identifier hs-var">m1'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681559119"><span class="annot"><span class="annottext">m2 :: [(i, b)]
</span><a href="#local-6989586621681559119"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681559120"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559120"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681559121"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681559121"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681559122"><span class="annot"><span class="annottext">[(i, b)]
</span><a href="#local-6989586621681559122"><span class="hs-identifier hs-var">m2'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-289"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559116"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559120"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-290"></span><span>        </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (i, c) -&gt; [(i, c)] -&gt; [(i, c)]
forall a. Maybe a -&gt; [a] -&gt; [a]
</span><a href="Agda.Utils.List.html#mcons"><span class="hs-identifier hs-var">mcons</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559116"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(c -&gt; (i, c)) -&gt; Maybe c -&gt; Maybe (i, c)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe c
</span><a href="#local-6989586621681559104"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681559117"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>   </span><span class="annot"><span class="annottext">([(i, c)] -&gt; [(i, c)]) -&gt; [(i, c)] -&gt; [(i, c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(i, a)] -&gt; [(i, b)] -&gt; [(i, c)]
</span><a href="#local-6989586621681559107"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559118"><span class="hs-identifier hs-var">m1'</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, b)]
</span><a href="#local-6989586621681559119"><span class="hs-identifier hs-var">m2</span></a></span><span>
</span><span id="line-291"></span><span>        </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (i, c) -&gt; [(i, c)] -&gt; [(i, c)]
forall a. Maybe a -&gt; [a] -&gt; [a]
</span><a href="Agda.Utils.List.html#mcons"><span class="hs-identifier hs-var">mcons</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559120"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(c -&gt; (i, c)) -&gt; Maybe c -&gt; Maybe (i, c)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Maybe c
</span><a href="#local-6989586621681559105"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681559121"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>   </span><span class="annot"><span class="annottext">([(i, c)] -&gt; [(i, c)]) -&gt; [(i, c)] -&gt; [(i, c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(i, a)] -&gt; [(i, b)] -&gt; [(i, c)]
</span><a href="#local-6989586621681559107"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559115"><span class="hs-identifier hs-var">m1</span></a></span><span>  </span><span class="annot"><span class="annottext">[(i, b)]
</span><a href="#local-6989586621681559122"><span class="hs-identifier hs-var">m2'</span></a></span><span>
</span><span id="line-292"></span><span>        </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (i, c) -&gt; [(i, c)] -&gt; [(i, c)]
forall a. Maybe a -&gt; [a] -&gt; [a]
</span><a href="Agda.Utils.List.html#mcons"><span class="hs-identifier hs-var">mcons</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559116"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(c -&gt; (i, c)) -&gt; Maybe c -&gt; Maybe (i, c)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Maybe c
</span><a href="#local-6989586621681559106"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681559117"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681559121"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(i, c)] -&gt; [(i, c)]) -&gt; [(i, c)] -&gt; [(i, c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(i, a)] -&gt; [(i, b)] -&gt; [(i, c)]
</span><a href="#local-6989586621681559107"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559118"><span class="hs-identifier hs-var">m1'</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, b)]
</span><a href="#local-6989586621681559122"><span class="hs-identifier hs-var">m2'</span></a></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-comment">-- | Instance of 'zipAssocWith' which keeps longer assoc lists.</span><span>
</span><span id="line-295"></span><span class="hs-comment">--   @O(n1 + n2)@.</span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span id="local-6989586621681558476"><span id="local-6989586621681558477"><span id="local-6989586621681558478"><span id="local-6989586621681558479"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#unionAssocWith"><span class="hs-identifier hs-type">unionAssocWith</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681558476"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558477"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621681558478"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Element only present in left map.</span></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558479"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621681558478"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Element only present in right map.</span></span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558477"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681558479"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621681558478"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Element present in both maps.</span></span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558476"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621681558477"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558476"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621681558479"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558476"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621681558478"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-302"></span><span id="unionAssocWith"><span class="annot"><span class="annottext">unionAssocWith :: forall i a c b.
Ord i =&gt;
(a -&gt; Maybe c)
-&gt; (b -&gt; Maybe c)
-&gt; (a -&gt; b -&gt; Maybe c)
-&gt; [(i, a)]
-&gt; [(i, b)]
-&gt; [(i, c)]
</span><a href="Agda.Termination.SparseMatrix.html#unionAssocWith"><span class="hs-identifier hs-var hs-var">unionAssocWith</span></a></span></span><span> </span><span id="local-6989586621681559127"><span class="annot"><span class="annottext">a -&gt; Maybe c
</span><a href="#local-6989586621681559127"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681559128"><span class="annot"><span class="annottext">b -&gt; Maybe c
</span><a href="#local-6989586621681559128"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621681559129"><span class="annot"><span class="annottext">a -&gt; b -&gt; Maybe c
</span><a href="#local-6989586621681559129"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(i, a)] -&gt; [(i, c)])
-&gt; ([(i, b)] -&gt; [(i, c)])
-&gt; (a -&gt; Maybe c)
-&gt; (b -&gt; Maybe c)
-&gt; (a -&gt; b -&gt; Maybe c)
-&gt; [(i, a)]
-&gt; [(i, b)]
-&gt; [(i, c)]
forall i a c b.
Ord i =&gt;
([(i, a)] -&gt; [(i, c)])
-&gt; ([(i, b)] -&gt; [(i, c)])
-&gt; (a -&gt; Maybe c)
-&gt; (b -&gt; Maybe c)
-&gt; (a -&gt; b -&gt; Maybe c)
-&gt; [(i, a)]
-&gt; [(i, b)]
-&gt; [(i, c)]
</span><a href="Agda.Termination.SparseMatrix.html#zipAssocWith"><span class="hs-identifier hs-var">zipAssocWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Maybe c) -&gt; [(i, a)] -&gt; [(i, c)]
forall {t} {a} {t}. (t -&gt; Maybe a) -&gt; [(t, t)] -&gt; [(t, a)]
</span><a href="#local-6989586621681559130"><span class="hs-identifier hs-var">map_</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe c
</span><a href="#local-6989586621681559127"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; Maybe c) -&gt; [(i, b)] -&gt; [(i, c)]
forall {t} {a} {t}. (t -&gt; Maybe a) -&gt; [(t, t)] -&gt; [(t, a)]
</span><a href="#local-6989586621681559130"><span class="hs-identifier hs-var">map_</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Maybe c
</span><a href="#local-6989586621681559128"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe c
</span><a href="#local-6989586621681559127"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Maybe c
</span><a href="#local-6989586621681559128"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Maybe c
</span><a href="#local-6989586621681559129"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-304"></span><span>    </span><span id="local-6989586621681559130"><span class="annot"><span class="annottext">map_ :: (t -&gt; Maybe a) -&gt; [(t, t)] -&gt; [(t, a)]
</span><a href="#local-6989586621681559130"><span class="hs-identifier hs-var hs-var">map_</span></a></span></span><span> </span><span id="local-6989586621681559132"><span class="annot"><span class="annottext">t -&gt; Maybe a
</span><a href="#local-6989586621681559132"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((t, t) -&gt; Maybe (t, a)) -&gt; [(t, t)] -&gt; [(t, a)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681559133"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681559133"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681559134"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681559134"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681559133"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (t, a)) -&gt; Maybe a -&gt; Maybe (t, a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Maybe a
</span><a href="#local-6989586621681559132"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621681559134"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="hs-comment">-- | General pointwise combination function for sparse matrices.</span><span>
</span><span id="line-307"></span><span class="hs-comment">--   @O(n1 + n2)@.</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#zipMatrices"><span class="hs-identifier hs-type">zipMatrices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681558488"><span class="annot"><a href="#local-6989586621681558488"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621681558490"><span class="annot"><a href="#local-6989586621681558490"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621681558489"><span class="annot"><a href="#local-6989586621681558489"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span id="local-6989586621681558487"><span class="annot"><a href="#local-6989586621681558487"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681558487"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681558489"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Element only present in left matrix.</span></span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558490"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681558489"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Element only present in right matrix.</span></span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681558490"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681558489"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Element present in both matrices.</span></span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558489"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Result counts as zero?</span></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558487"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558487"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558490"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558487"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558489"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-315"></span><span id="zipMatrices"><span class="annot"><span class="annottext">zipMatrices :: forall a b c i.
Ord i =&gt;
(a -&gt; c)
-&gt; (b -&gt; c)
-&gt; (a -&gt; b -&gt; c)
-&gt; (c -&gt; Bool)
-&gt; Matrix i a
-&gt; Matrix i b
-&gt; Matrix i c
</span><a href="Agda.Termination.SparseMatrix.html#zipMatrices"><span class="hs-identifier hs-var hs-var">zipMatrices</span></a></span></span><span> </span><span id="local-6989586621681559138"><span class="annot"><span class="annottext">a -&gt; c
</span><a href="#local-6989586621681559138"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681559139"><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621681559139"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621681559140"><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621681559140"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621681559141"><span class="annot"><span class="annottext">c -&gt; Bool
</span><a href="#local-6989586621681559141"><span class="hs-identifier hs-var">zero</span></a></span></span><span> </span><span id="local-6989586621681559142"><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559142"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span id="local-6989586621681559143"><span class="annot"><span class="annottext">Matrix i b
</span><a href="#local-6989586621681559143"><span class="hs-identifier hs-var">m2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Size i -&gt; [(MIx i, c)] -&gt; Matrix i c
forall i b. Size i -&gt; [(MIx i, b)] -&gt; Matrix i b
</span><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-var">Matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix i a -&gt; Matrix i b -&gt; Size i
forall i a b. Ord i =&gt; Matrix i a -&gt; Matrix i b -&gt; Size i
</span><a href="Agda.Termination.SparseMatrix.html#supSize"><span class="hs-identifier hs-var">supSize</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559142"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i b
</span><a href="#local-6989586621681559143"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(MIx i, c)] -&gt; Matrix i c) -&gt; [(MIx i, c)] -&gt; Matrix i c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-316"></span><span>  </span><span class="annot"><span class="annottext">(a -&gt; Maybe c)
-&gt; (b -&gt; Maybe c)
-&gt; (a -&gt; b -&gt; Maybe c)
-&gt; [(MIx i, a)]
-&gt; [(MIx i, b)]
-&gt; [(MIx i, c)]
forall i a c b.
Ord i =&gt;
(a -&gt; Maybe c)
-&gt; (b -&gt; Maybe c)
-&gt; (a -&gt; b -&gt; Maybe c)
-&gt; [(i, a)]
-&gt; [(i, b)]
-&gt; [(i, c)]
</span><a href="Agda.Termination.SparseMatrix.html#unionAssocWith"><span class="hs-identifier hs-var">unionAssocWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; Maybe c
</span><a href="#local-6989586621681559144"><span class="hs-identifier hs-var">drop0</span></a></span><span> </span><span class="annot"><span class="annottext">(c -&gt; Maybe c) -&gt; (a -&gt; c) -&gt; a -&gt; Maybe c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; c
</span><a href="#local-6989586621681559138"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; Maybe c
</span><a href="#local-6989586621681559144"><span class="hs-identifier hs-var">drop0</span></a></span><span> </span><span class="annot"><span class="annottext">(c -&gt; Maybe c) -&gt; (b -&gt; c) -&gt; b -&gt; Maybe c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621681559139"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681559145"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681559145"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">c -&gt; Maybe c
</span><a href="#local-6989586621681559144"><span class="hs-identifier hs-var">drop0</span></a></span><span> </span><span class="annot"><span class="annottext">(c -&gt; Maybe c) -&gt; (b -&gt; c) -&gt; b -&gt; Maybe c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621681559140"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681559145"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix i a -&gt; [(MIx i, a)]
forall i b. Matrix i b -&gt; [(MIx i, b)]
</span><a href="Agda.Termination.SparseMatrix.html#unM"><span class="hs-identifier hs-var">unM</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559142"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix i b -&gt; [(MIx i, b)]
forall i b. Matrix i b -&gt; [(MIx i, b)]
</span><a href="Agda.Termination.SparseMatrix.html#unM"><span class="hs-identifier hs-var">unM</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i b
</span><a href="#local-6989586621681559143"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-318"></span><span>    </span><span id="local-6989586621681559144"><span class="annot"><span class="annottext">drop0 :: c -&gt; Maybe c
</span><a href="#local-6989586621681559144"><span class="hs-identifier hs-var hs-var">drop0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(c -&gt; Bool) -&gt; c -&gt; Maybe c
forall a. (a -&gt; Bool) -&gt; a -&gt; Maybe a
</span><a href="Agda.Utils.Maybe.html#filterMaybe"><span class="hs-identifier hs-var">filterMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (c -&gt; Bool) -&gt; c -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; Bool
</span><a href="#local-6989586621681559141"><span class="hs-identifier hs-var">zero</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="hs-comment">-- | @'add' (+) m1 m2@ adds @m1@ and @m2@, using @(+)@ to add values.</span><span>
</span><span id="line-321"></span><span class="hs-comment">--   @O(n1 + n2)@.</span><span>
</span><span id="line-322"></span><span class="hs-comment">--</span><span>
</span><span id="line-323"></span><span class="hs-comment">--   Returns a matrix of size @'supSize' m1 m2@.</span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span id="local-6989586621681558496"><span id="local-6989586621681558497"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#add"><span class="hs-identifier hs-type">add</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681558496"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.Semiring.html#HasZero"><span class="hs-identifier hs-type">HasZero</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558497"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558497"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681558497"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681558497"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558496"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558497"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558496"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558497"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558496"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558497"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-326"></span><span id="add"><span class="annot"><span class="annottext">add :: forall i a.
(Ord i, HasZero a) =&gt;
(a -&gt; a -&gt; a) -&gt; Matrix i a -&gt; Matrix i a -&gt; Matrix i a
</span><a href="Agda.Termination.SparseMatrix.html#add"><span class="hs-identifier hs-var hs-var">add</span></a></span></span><span> </span><span id="local-6989586621681559154"><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621681559154"><span class="hs-identifier hs-var">plus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; Bool)
-&gt; Matrix i a
-&gt; Matrix i a
-&gt; Matrix i a
forall a b c i.
Ord i =&gt;
(a -&gt; c)
-&gt; (b -&gt; c)
-&gt; (a -&gt; b -&gt; c)
-&gt; (c -&gt; Bool)
-&gt; Matrix i a
-&gt; Matrix i b
-&gt; Matrix i c
</span><a href="Agda.Termination.SparseMatrix.html#zipMatrices"><span class="hs-identifier hs-var">zipMatrices</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621681559154"><span class="hs-identifier hs-var">plus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
forall a. HasZero a =&gt; a
</span><a href="Agda.Termination.Semiring.html#zeroElement"><span class="hs-identifier hs-var">zeroElement</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="hs-comment">-- | @'intersectWith' f m1 m2@ build the pointwise conjunction @m1@ and @m2@.</span><span>
</span><span id="line-329"></span><span class="hs-comment">--   Uses @f@ to combine non-zero values.</span><span>
</span><span id="line-330"></span><span class="hs-comment">--   @O(n1 + n2)@.</span><span>
</span><span id="line-331"></span><span class="hs-comment">--</span><span>
</span><span id="line-332"></span><span class="hs-comment">--   Returns a matrix of size @infSize m1 m2@.</span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span id="local-6989586621681558501"><span id="local-6989586621681558502"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#intersectWith"><span class="hs-identifier hs-type">intersectWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681558501"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558502"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681558502"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681558502"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558501"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558502"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558501"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558502"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558501"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558502"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-335"></span><span id="intersectWith"><span class="annot"><span class="annottext">intersectWith :: forall i a.
Ord i =&gt;
(a -&gt; a -&gt; a) -&gt; Matrix i a -&gt; Matrix i a -&gt; Matrix i a
</span><a href="Agda.Termination.SparseMatrix.html#intersectWith"><span class="hs-identifier hs-var hs-var">intersectWith</span></a></span></span><span> </span><span id="local-6989586621681559159"><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621681559159"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681559160"><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559160"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span id="local-6989586621681559161"><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559161"><span class="hs-identifier hs-var">m2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Size i -&gt; [(MIx i, a)] -&gt; Matrix i a
forall i b. Size i -&gt; [(MIx i, b)] -&gt; Matrix i b
</span><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-var">Matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix i a -&gt; Matrix i a -&gt; Size i
forall i a b. Ord i =&gt; Matrix i a -&gt; Matrix i b -&gt; Size i
</span><a href="Agda.Termination.SparseMatrix.html#infSize"><span class="hs-identifier hs-var">infSize</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559160"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559161"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(MIx i, a)] -&gt; Matrix i a) -&gt; [(MIx i, a)] -&gt; Matrix i a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; [(MIx i, a)] -&gt; [(MIx i, a)] -&gt; [(MIx i, a)]
forall i a.
Ord i =&gt;
(a -&gt; a -&gt; a) -&gt; [(i, a)] -&gt; [(i, a)] -&gt; [(i, a)]
</span><a href="Agda.Termination.SparseMatrix.html#interAssocWith"><span class="hs-identifier hs-var">interAssocWith</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621681559159"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix i a -&gt; [(MIx i, a)]
forall i b. Matrix i b -&gt; [(MIx i, b)]
</span><a href="Agda.Termination.SparseMatrix.html#unM"><span class="hs-identifier hs-var">unM</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559160"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix i a -&gt; [(MIx i, a)]
forall i b. Matrix i b -&gt; [(MIx i, b)]
</span><a href="Agda.Termination.SparseMatrix.html#unM"><span class="hs-identifier hs-var">unM</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559161"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="hs-comment">-- | Association list intersection.</span><span>
</span><span id="line-338"></span><span class="hs-comment">--   @O(n1 + n2)@.</span><span>
</span><span id="line-339"></span><span class="hs-comment">--</span><span>
</span><span id="line-340"></span><span class="hs-comment">--   @interAssocWith f l l' = { (i, f a b) | (i,a) &#8712; l and (i,b) &#8712; l' }@</span><span>
</span><span id="line-341"></span><span class="hs-comment">--</span><span>
</span><span id="line-342"></span><span class="hs-comment">--   Used to combine sparse matrices, it might introduce zero elements</span><span>
</span><span id="line-343"></span><span class="hs-comment">--   if @f@ can return zero for non-zero arguments.</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span id="local-6989586621681558505"><span id="local-6989586621681558506"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#interAssocWith"><span class="hs-identifier hs-type">interAssocWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681558505"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558506"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681558506"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681558506"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558505"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621681558506"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558505"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621681558506"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681558505"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621681558506"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-346"></span><span id="interAssocWith"><span class="annot"><span class="annottext">interAssocWith :: forall i a.
Ord i =&gt;
(a -&gt; a -&gt; a) -&gt; [(i, a)] -&gt; [(i, a)] -&gt; [(i, a)]
</span><a href="Agda.Termination.SparseMatrix.html#interAssocWith"><span class="hs-identifier hs-var hs-var">interAssocWith</span></a></span></span><span> </span><span id="local-6989586621681559168"><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621681559168"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621681559169"><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559169"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-347"></span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#interAssocWith"><span class="hs-identifier hs-var">interAssocWith</span></a></span><span> </span><span id="local-6989586621681559170"><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621681559170"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681559171"><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559171"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-348"></span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#interAssocWith"><span class="hs-identifier hs-var">interAssocWith</span></a></span><span> </span><span id="local-6989586621681559172"><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621681559172"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681559173"><span class="annot"><span class="annottext">l :: [(i, a)]
</span><a href="#local-6989586621681559173"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681559174"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559174"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681559175"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681559175"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681559176"><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559176"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681559177"><span class="annot"><span class="annottext">m :: [(i, a)]
</span><a href="#local-6989586621681559177"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681559178"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559178"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681559179"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681559179"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681559180"><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559180"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559174"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559178"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; [(i, a)] -&gt; [(i, a)] -&gt; [(i, a)]
forall i a.
Ord i =&gt;
(a -&gt; a -&gt; a) -&gt; [(i, a)] -&gt; [(i, a)] -&gt; [(i, a)]
</span><a href="Agda.Termination.SparseMatrix.html#interAssocWith"><span class="hs-identifier hs-var">interAssocWith</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621681559172"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559176"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559177"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559174"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559178"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; [(i, a)] -&gt; [(i, a)] -&gt; [(i, a)]
forall i a.
Ord i =&gt;
(a -&gt; a -&gt; a) -&gt; [(i, a)] -&gt; [(i, a)] -&gt; [(i, a)]
</span><a href="Agda.Termination.SparseMatrix.html#interAssocWith"><span class="hs-identifier hs-var">interAssocWith</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621681559172"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559173"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559180"><span class="hs-identifier hs-var">m'</span></a></span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559174"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621681559172"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681559175"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681559179"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(i, a) -&gt; [(i, a)] -&gt; [(i, a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; [(i, a)] -&gt; [(i, a)] -&gt; [(i, a)]
forall i a.
Ord i =&gt;
(a -&gt; a -&gt; a) -&gt; [(i, a)] -&gt; [(i, a)] -&gt; [(i, a)]
</span><a href="Agda.Termination.SparseMatrix.html#interAssocWith"><span class="hs-identifier hs-var">interAssocWith</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621681559172"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559176"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559180"><span class="hs-identifier hs-var">m'</span></a></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-comment">-- | @'mul' semiring m1 m2@ multiplies matrices @m1@ and @m2@.</span><span>
</span><span id="line-354"></span><span class="hs-comment">--   Uses the operations of the semiring @semiring@ to perform the</span><span>
</span><span id="line-355"></span><span class="hs-comment">--   multiplication.</span><span>
</span><span id="line-356"></span><span class="hs-comment">--</span><span>
</span><span id="line-357"></span><span class="hs-comment">--   @O(n1 + n2 log n2 + &#931;(i &lt;= r1) &#931;(j &lt;= c2) d(i,j))@ where</span><span>
</span><span id="line-358"></span><span class="hs-comment">--   @r1@ is the number of non-empty rows in @m1@ and</span><span>
</span><span id="line-359"></span><span class="hs-comment">--   @c2@ is the number of non-empty columns in @m2@ and</span><span>
</span><span id="line-360"></span><span class="hs-comment">--   @d(i,j)@  is the bigger one of the following two quantifies:</span><span>
</span><span id="line-361"></span><span class="hs-comment">--   the length of sparse row @i@ in @m1@ and</span><span>
</span><span id="line-362"></span><span class="hs-comment">--   the length of sparse column @j@ in @m2@.</span><span>
</span><span id="line-363"></span><span class="hs-comment">--</span><span>
</span><span id="line-364"></span><span class="hs-comment">--   Given dimensions @m1 : r1 &#215; c1@ and @m2 : r2 &#215; c2@,</span><span>
</span><span id="line-365"></span><span class="hs-comment">--   a matrix of size @r1 &#215; c2@ is returned.</span><span>
</span><span id="line-366"></span><span class="hs-comment">--   It is not necessary that @c1 == r2@, the matrices are implicitly</span><span>
</span><span id="line-367"></span><span class="hs-comment">--   patched with zeros to match up for multiplication.</span><span>
</span><span id="line-368"></span><span class="hs-comment">--   For sparse matrices, this patching is a no-op.</span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span id="local-6989586621681558509"><span id="local-6989586621681558510"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#mul"><span class="hs-identifier hs-type">mul</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621681558509"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621681558510"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Semiring.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558510"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558509"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558510"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558509"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558510"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558509"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558510"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-372"></span><span id="mul"><span class="annot"><span class="annottext">mul :: forall i a.
(Ix i, Eq a) =&gt;
Semiring a -&gt; Matrix i a -&gt; Matrix i a -&gt; Matrix i a
</span><a href="Agda.Termination.SparseMatrix.html#mul"><span class="hs-identifier hs-var hs-var">mul</span></a></span></span><span> </span><span id="local-6989586621681559191"><span class="annot"><span class="annottext">Semiring a
</span><a href="#local-6989586621681559191"><span class="hs-identifier hs-var">semiring</span></a></span></span><span> </span><span id="local-6989586621681559192"><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559192"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span id="local-6989586621681559193"><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559193"><span class="hs-identifier hs-var">m2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Size i -&gt; [(MIx i, a)] -&gt; Matrix i a
forall i b. Size i -&gt; [(MIx i, b)] -&gt; Matrix i b
</span><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-var">Matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rows :: i
</span><a href="Agda.Termination.SparseMatrix.html#rows"><span class="hs-identifier hs-var">rows</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Size i -&gt; i
forall i. Size i -&gt; i
</span><a href="Agda.Termination.SparseMatrix.html#rows"><span class="hs-identifier hs-var">rows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix i a -&gt; Size i
forall i b. Matrix i b -&gt; Size i
</span><a href="Agda.Termination.SparseMatrix.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559192"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cols :: i
</span><a href="Agda.Termination.SparseMatrix.html#cols"><span class="hs-identifier hs-var">cols</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Size i -&gt; i
forall i. Size i -&gt; i
</span><a href="Agda.Termination.SparseMatrix.html#cols"><span class="hs-identifier hs-var">cols</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix i a -&gt; Size i
forall i b. Matrix i b -&gt; Size i
</span><a href="Agda.Termination.SparseMatrix.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559193"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(MIx i, a)] -&gt; Matrix i a) -&gt; [(MIx i, a)] -&gt; Matrix i a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; i -&gt; MIx i
forall i. i -&gt; i -&gt; MIx i
</span><a href="Agda.Termination.SparseMatrix.html#MIx"><span class="hs-identifier hs-var">MIx</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559194"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559195"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681559196"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681559194"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559194"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681559197"><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559197"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Matrix i a -&gt; [(i, [(i, a)])]
forall i b. Eq i =&gt; Matrix i b -&gt; [(i, [(i, b)])]
</span><a href="Agda.Termination.SparseMatrix.html#toSparseRows"><span class="hs-identifier hs-var">toSparseRows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559192"><span class="hs-identifier hs-var">m1</span></a></span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681559195"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621681559195"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681559198"><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559198"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Matrix i a -&gt; [(i, [(i, a)])]
forall i b. Eq i =&gt; Matrix i b -&gt; [(i, [(i, b)])]
</span><a href="Agda.Termination.SparseMatrix.html#toSparseRows"><span class="hs-identifier hs-var">toSparseRows</span></a></span><span> </span><span class="annot"><span class="annottext">(Matrix i a -&gt; [(i, [(i, a)])]) -&gt; Matrix i a -&gt; [(i, [(i, a)])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix i a -&gt; Matrix i a
forall a. Transpose a =&gt; a -&gt; a
</span><a href="Agda.Termination.SparseMatrix.html#transpose"><span class="hs-identifier hs-var">transpose</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559193"><span class="hs-identifier hs-var">m2</span></a></span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681559196"><span class="annot"><span class="annottext">b :: a
</span><a href="#local-6989586621681559196"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(i, a)] -&gt; [(i, a)] -&gt; a
</span><a href="#local-6989586621681559199"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559197"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559198"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-377"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681559196"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681559200"><span class="hs-identifier hs-var">zero</span></a></span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-380"></span><span>     </span><span id="local-6989586621681559200"><span class="annot"><span class="annottext">zero :: a
</span><a href="#local-6989586621681559200"><span class="hs-identifier hs-var hs-var">zero</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Semiring a -&gt; a
forall a. Semiring a -&gt; a
</span><a href="Agda.Termination.Semiring.html#zero"><span class="hs-identifier hs-var">Semiring.zero</span></a></span><span> </span><span class="annot"><span class="annottext">Semiring a
</span><a href="#local-6989586621681559191"><span class="hs-identifier hs-var">semiring</span></a></span><span>
</span><span id="line-381"></span><span>     </span><span id="local-6989586621681559202"><span class="annot"><span class="annottext">plus :: a -&gt; a -&gt; a
</span><a href="#local-6989586621681559202"><span class="hs-identifier hs-var hs-var">plus</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Semiring a -&gt; a -&gt; a -&gt; a
forall a. Semiring a -&gt; a -&gt; a -&gt; a
</span><a href="Agda.Termination.Semiring.html#add"><span class="hs-identifier hs-var">Semiring.add</span></a></span><span>  </span><span class="annot"><span class="annottext">Semiring a
</span><a href="#local-6989586621681559191"><span class="hs-identifier hs-var">semiring</span></a></span><span>
</span><span id="line-382"></span><span>     </span><span id="local-6989586621681559204"><span class="annot"><span class="annottext">times :: a -&gt; a -&gt; a
</span><a href="#local-6989586621681559204"><span class="hs-identifier hs-var hs-var">times</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Semiring a -&gt; a -&gt; a -&gt; a
forall a. Semiring a -&gt; a -&gt; a -&gt; a
</span><a href="Agda.Termination.Semiring.html#mul"><span class="hs-identifier hs-var">Semiring.mul</span></a></span><span>  </span><span class="annot"><span class="annottext">Semiring a
</span><a href="#local-6989586621681559191"><span class="hs-identifier hs-var">semiring</span></a></span><span>
</span><span id="line-383"></span><span>     </span><span id="local-6989586621681559199"><span class="annot"><span class="annottext">inner :: [(i, a)] -&gt; [(i, a)] -&gt; a
</span><a href="#local-6989586621681559199"><span class="hs-identifier hs-var hs-var">inner</span></a></span></span><span> </span><span id="local-6989586621681559206"><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559206"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621681559207"><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559207"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; a -&gt; [a] -&gt; a
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">List.foldl'</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621681559202"><span class="hs-identifier hs-var">plus</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681559200"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; a) -&gt; [a] -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-384"></span><span>                   </span><span class="annot"><span class="annottext">((i, a) -&gt; a) -&gt; [(i, a)] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(i, a) -&gt; a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([(i, a)] -&gt; [a]) -&gt; [(i, a)] -&gt; [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; [(i, a)] -&gt; [(i, a)] -&gt; [(i, a)]
forall i a.
Ord i =&gt;
(a -&gt; a -&gt; a) -&gt; [(i, a)] -&gt; [(i, a)] -&gt; [(i, a)]
</span><a href="Agda.Termination.SparseMatrix.html#interAssocWith"><span class="hs-identifier hs-var">interAssocWith</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621681559204"><span class="hs-identifier hs-var">times</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559206"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621681559207"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-comment">-- | Pointwise comparison.</span><span>
</span><span id="line-387"></span><span class="hs-comment">--   Only matrices with the same dimension are comparable.</span><span>
</span><span id="line-388"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681558523"><span id="local-6989586621681558524"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621681558523"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.PartialOrd.html#PartialOrd"><span class="hs-identifier hs-type">PartialOrd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558524"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.PartialOrd.html#PartialOrd"><span class="hs-identifier hs-type">PartialOrd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558523"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558524"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-389"></span><span>  </span><span id="local-6989586621681559220"><span class="annot"><span class="annottext">comparable :: Comparable (Matrix i a)
</span><a href="#local-6989586621681559220"><span class="hs-identifier hs-var hs-var hs-var">comparable</span></a></span></span><span> </span><span id="local-6989586621681559222"><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559222"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681559223"><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559223"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-390"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Matrix i a -&gt; Size i
forall i b. Matrix i b -&gt; Size i
</span><a href="Agda.Termination.SparseMatrix.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559222"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Size i -&gt; Size i -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Matrix i a -&gt; Size i
forall i b. Matrix i b -&gt; Size i
</span><a href="Agda.Termination.SparseMatrix.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559223"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PartialOrdering
</span><a href="Agda.Utils.PartialOrd.html#POAny"><span class="hs-identifier hs-var">POAny</span></a></span><span>
</span><span id="line-391"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix i PartialOrdering -&gt; PartialOrdering
forall m. Monoid m =&gt; Matrix i m -&gt; m
forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><span class="hs-identifier hs-var">Fold.fold</span></span><span> </span><span class="annot"><span class="annottext">(Matrix i PartialOrdering -&gt; PartialOrdering)
-&gt; Matrix i PartialOrdering -&gt; PartialOrdering
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-392"></span><span>                           </span><span class="annot"><span class="annottext">(a -&gt; PartialOrdering)
-&gt; (a -&gt; PartialOrdering)
-&gt; (a -&gt; a -&gt; PartialOrdering)
-&gt; (PartialOrdering -&gt; Bool)
-&gt; Matrix i a
-&gt; Matrix i a
-&gt; Matrix i PartialOrdering
forall a b c i.
Ord i =&gt;
(a -&gt; c)
-&gt; (b -&gt; c)
-&gt; (a -&gt; b -&gt; c)
-&gt; (c -&gt; Bool)
-&gt; Matrix i a
-&gt; Matrix i b
-&gt; Matrix i c
</span><a href="Agda.Termination.SparseMatrix.html#zipMatrices"><span class="hs-identifier hs-var">zipMatrices</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; PartialOrdering
forall {p}. p -&gt; PartialOrdering
</span><a href="#local-6989586621681559226"><span class="hs-identifier hs-var">onlym</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; PartialOrdering
forall {p}. p -&gt; PartialOrdering
</span><a href="#local-6989586621681559227"><span class="hs-identifier hs-var">onlyn</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; PartialOrdering
</span><a href="#local-6989586621681559228"><span class="hs-identifier hs-var">both</span></a></span><span> </span><span class="annot"><span class="annottext">PartialOrdering -&gt; Bool
</span><a href="#local-6989586621681559229"><span class="hs-identifier hs-var">trivial</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559222"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i a
</span><a href="#local-6989586621681559223"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-393"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-394"></span><span>      </span><span class="hs-comment">-- If an element is only in @m@, then its 'Unknown' in @n@</span><span>
</span><span id="line-395"></span><span>      </span><span class="hs-comment">-- so it gotten better at best, in any case, not worse.</span><span>
</span><span id="line-396"></span><span>      </span><span id="local-6989586621681559226"><span class="annot"><span class="annottext">onlym :: p -&gt; PartialOrdering
</span><a href="#local-6989586621681559226"><span class="hs-identifier hs-var hs-var">onlym</span></a></span></span><span> </span><span id="local-6989586621681559230"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621681559230"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PartialOrdering
</span><a href="Agda.Utils.PartialOrd.html#POGT"><span class="hs-identifier hs-var">POGT</span></a></span><span>
</span><span id="line-397"></span><span>      </span><span class="hs-comment">-- If an element is only in @n@, then its 'Unknown' in @m@</span><span>
</span><span id="line-398"></span><span>      </span><span class="hs-comment">-- so we have strictly less information.</span><span>
</span><span id="line-399"></span><span>      </span><span id="local-6989586621681559227"><span class="annot"><span class="annottext">onlyn :: p -&gt; PartialOrdering
</span><a href="#local-6989586621681559227"><span class="hs-identifier hs-var hs-var">onlyn</span></a></span></span><span> </span><span id="local-6989586621681559232"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621681559232"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PartialOrdering
</span><a href="Agda.Utils.PartialOrd.html#POLT"><span class="hs-identifier hs-var">POLT</span></a></span><span>
</span><span id="line-400"></span><span>      </span><span id="local-6989586621681559228"><span class="annot"><span class="annottext">both :: a -&gt; a -&gt; PartialOrdering
</span><a href="#local-6989586621681559228"><span class="hs-identifier hs-var hs-var">both</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; PartialOrdering
forall a. PartialOrd a =&gt; Comparable a
</span><a href="Agda.Utils.PartialOrd.html#comparable"><span class="hs-identifier hs-var">comparable</span></a></span><span>
</span><span id="line-401"></span><span>      </span><span class="hs-comment">-- The zero element of the result sparse matrix is the</span><span>
</span><span id="line-402"></span><span>      </span><span class="hs-comment">-- neutral element of the monoid.</span><span>
</span><span id="line-403"></span><span>      </span><span id="local-6989586621681559229"><span class="annot"><span class="annottext">trivial :: PartialOrdering -&gt; Bool
</span><a href="#local-6989586621681559229"><span class="hs-identifier hs-var hs-var">trivial</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PartialOrdering -&gt; PartialOrdering -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PartialOrdering
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- Modifying matrices</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="hs-comment">-- | @'addColumn' x m@ adds a new column to @m@, after the columns</span><span>
</span><span id="line-409"></span><span class="hs-comment">-- already existing in the matrix. All elements in the new column get</span><span>
</span><span id="line-410"></span><span class="hs-comment">-- set to @x@.</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span id="local-6989586621681558529"><span id="local-6989586621681558530"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#addColumn"><span class="hs-identifier hs-type">addColumn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621681558529"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.Semiring.html#HasZero"><span class="hs-identifier hs-type">HasZero</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558530"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681558530"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558529"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558530"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558529"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558530"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-413"></span><span id="addColumn"><span class="annot"><span class="annottext">addColumn :: forall i b. (Num i, HasZero b) =&gt; b -&gt; Matrix i b -&gt; Matrix i b
</span><a href="Agda.Termination.SparseMatrix.html#addColumn"><span class="hs-identifier hs-var hs-var">addColumn</span></a></span></span><span> </span><span id="local-6989586621681559249"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681559249"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681559250"><span class="annot"><span class="annottext">Matrix i b
</span><a href="#local-6989586621681559250"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681559249"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">b
forall a. HasZero a =&gt; a
</span><a href="Agda.Termination.Semiring.html#zeroElement"><span class="hs-identifier hs-var">zeroElement</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix i b
</span><a href="#local-6989586621681559250"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681559250"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#cols"><span class="hs-identifier hs-var">cols</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#cols"><span class="hs-identifier hs-var">cols</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681559250"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-414"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix i b
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="hs-comment">-- | @'addRow' x m@ adds a new row to @m@, after the rows already</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- existing in the matrix. All elements in the new row get set to @x@.</span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span id="local-6989586621681559251"><span id="local-6989586621681559252"><span class="annot"><a href="Agda.Termination.SparseMatrix.html#addRow"><span class="hs-identifier hs-type">addRow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621681559251"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.Semiring.html#HasZero"><span class="hs-identifier hs-type">HasZero</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681559252"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681559252"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681559251"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681559252"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681559251"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681559252"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-420"></span><span id="addRow"><span class="annot"><span class="annottext">addRow :: forall i b. (Num i, HasZero b) =&gt; b -&gt; Matrix i b -&gt; Matrix i b
</span><a href="Agda.Termination.SparseMatrix.html#addRow"><span class="hs-identifier hs-var hs-var">addRow</span></a></span></span><span> </span><span id="local-6989586621681559262"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681559262"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681559263"><span class="annot"><span class="annottext">Matrix i b
</span><a href="#local-6989586621681559263"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681559262"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">b
forall a. HasZero a =&gt; a
</span><a href="Agda.Termination.Semiring.html#zeroElement"><span class="hs-identifier hs-var">zeroElement</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix i b
</span><a href="#local-6989586621681559263"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681559263"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#rows"><span class="hs-identifier hs-var">rows</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#rows"><span class="hs-identifier hs-var">rows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681559263"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-421"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix i b
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-424"></span><span class="annot"><span class="hs-comment">-- * Printing</span></span><span>
</span><span id="line-425"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681558537"><span id="local-6989586621681558538"><span id="local-6989586621681559270"><span id="local-6989586621681559274"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621681558537"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.Semiring.html#HasZero"><span class="hs-identifier hs-type">HasZero</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558538"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621681558537"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621681558538"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558537"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558538"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-428"></span><span>  </span><span id="local-6989586621681559282"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; Matrix i b -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var">showsPrec</span></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681559283"><span class="annot"><span class="annottext">Matrix i b
</span><a href="#local-6989586621681559283"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-429"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Agda.Termination.SparseMatrix.fromLists &quot;</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Size i -&gt; ShowS
forall a. Show a =&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">shows</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix i b -&gt; Size i
forall i b. Matrix i b -&gt; Size i
</span><a href="Agda.Termination.SparseMatrix.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i b
</span><a href="#local-6989586621681559283"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-430"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[[b]] -&gt; ShowS
forall a. Show a =&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">shows</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix i b -&gt; [[b]]
forall i b. (Integral i, HasZero b) =&gt; Matrix i b -&gt; [[b]]
</span><a href="Agda.Termination.SparseMatrix.html#toLists"><span class="hs-identifier hs-var">toLists</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix i b
</span><a href="#local-6989586621681559283"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681558546"><span id="local-6989586621681558547"><span id="local-6989586621681559291"><span id="local-6989586621681559295"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621681558546"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.Semiring.html#HasZero"><span class="hs-identifier hs-type">HasZero</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558547"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558547"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-433"></span><span>         </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.SparseMatrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558546"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681558547"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-434"></span><span class="hs-comment">--  pretty = vcat . map (hsep . map pretty) . toLists</span><span>
</span><span id="line-435"></span><span>  </span><span id="local-6989586621681559307"><span class="annot"><span class="annottext">pretty :: Matrix i b -&gt; Doc
</span><a href="#local-6989586621681559307"><span class="hs-identifier hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (t :: * -&gt; *). Foldable t =&gt; t Doc -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-436"></span><span>         </span><span class="annot"><span class="annottext">([Doc] -&gt; Doc) -&gt; (Matrix i b -&gt; [Doc]) -&gt; Matrix i b -&gt; Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc) -&gt; [String] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
forall a. String -&gt; Doc a
</span><span class="hs-identifier hs-var">text</span></span><span>
</span><span id="line-437"></span><span>         </span><span class="annot"><span class="annottext">([String] -&gt; [Doc])
-&gt; (Matrix i b -&gt; [String]) -&gt; Matrix i b -&gt; [Doc]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">lines</span></span><span>
</span><span id="line-438"></span><span>         </span><span class="annot"><span class="annottext">(String -&gt; [String])
-&gt; (Matrix i b -&gt; String) -&gt; Matrix i b -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Box -&gt; String
</span><span class="hs-identifier hs-var">Boxes.render</span></span><span>
</span><span id="line-439"></span><span>         </span><span class="annot"><span class="annottext">(Box -&gt; String) -&gt; (Matrix i b -&gt; Box) -&gt; Matrix i b -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Alignment -&gt; [Box] -&gt; Box
forall (f :: * -&gt; *).
Foldable f =&gt;
Int -&gt; Alignment -&gt; f Box -&gt; Box
</span><span class="hs-identifier hs-var">Boxes.hsep</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Alignment
</span><span class="hs-identifier hs-var">Boxes.right</span></span><span>
</span><span id="line-440"></span><span>         </span><span class="annot"><span class="annottext">([Box] -&gt; Box) -&gt; (Matrix i b -&gt; [Box]) -&gt; Matrix i b -&gt; Box
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([b] -&gt; Box) -&gt; [[b]] -&gt; [Box]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Alignment -&gt; [Box] -&gt; Box
forall (f :: * -&gt; *). Foldable f =&gt; Alignment -&gt; f Box -&gt; Box
</span><span class="hs-identifier hs-var">Boxes.vcat</span></span><span> </span><span class="annot"><span class="annottext">Alignment
</span><span class="hs-identifier hs-var">Boxes.right</span></span><span>
</span><span id="line-441"></span><span>               </span><span class="annot"><span class="annottext">([Box] -&gt; Box) -&gt; ([b] -&gt; [Box]) -&gt; [b] -&gt; Box
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Box) -&gt; [b] -&gt; [Box]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Alignment -&gt; Int -&gt; Box -&gt; Box
</span><span class="hs-identifier hs-var">Boxes.alignHoriz</span></span><span> </span><span class="annot"><span class="annottext">Alignment
</span><span class="hs-identifier hs-var">Boxes.right</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-442"></span><span>                     </span><span class="annot"><span class="annottext">(Box -&gt; Box) -&gt; (b -&gt; Box) -&gt; b -&gt; Box
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Box
</span><span class="hs-identifier hs-var">Boxes.text</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Box) -&gt; (b -&gt; String) -&gt; b -&gt; Box
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; String
forall a. Doc a -&gt; String
</span><span class="hs-identifier hs-var">render</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; String) -&gt; (b -&gt; Doc) -&gt; b -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span>
</span><span id="line-443"></span><span>                     </span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>               </span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>         </span><span class="annot"><span class="annottext">([[b]] -&gt; [Box]) -&gt; (Matrix i b -&gt; [[b]]) -&gt; Matrix i b -&gt; [Box]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Matrix i b -&gt; [[b]]
forall i b. (Integral i, HasZero b) =&gt; Matrix i b -&gt; [[b]]
</span><a href="Agda.Termination.SparseMatrix.html#toLists"><span class="hs-identifier hs-var">toLists</span></a></span><span>
</span><span id="line-446"></span><span>         </span><span class="annot"><span class="annottext">(Matrix i b -&gt; [[b]])
-&gt; (Matrix i b -&gt; Matrix i b) -&gt; Matrix i b -&gt; [[b]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Matrix i b -&gt; Matrix i b
forall a. Transpose a =&gt; a -&gt; a
</span><a href="Agda.Termination.SparseMatrix.html#transpose"><span class="hs-identifier hs-var">transpose</span></a></span><span>
</span><span id="line-447"></span><span class="hs-comment">-- ADAPTED FROM:</span><span>
</span><span id="line-448"></span><span class="hs-comment">-- http://www.tedreed.info/programming/2012/06/02/how-to-use-textprettyprintboxes/</span><span>
</span><span id="line-449"></span><span class="hs-comment">-- print_table :: [[String]] -&gt; IO ()</span><span>
</span><span id="line-450"></span><span class="hs-comment">-- print_table rows = printBox $ hsep 2 left (map (vcat left . map text) (transpose rows))</span><span>
</span><span id="line-451"></span></pre></body></html>