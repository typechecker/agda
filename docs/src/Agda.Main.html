<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{-| Agda main module.
-}</span></span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Agda.Main.html"><span class="hs-identifier">Agda.Main</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">null</span></span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">E</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">void</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadError</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ExceptT</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runExceptT</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadIO</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Environment</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Exit</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Console.GetOpt</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IO</span></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Paths_Agda.html"><span class="hs-identifier">Paths_Agda</span></a></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Paths_Agda.html#getDataDir"><span class="hs-identifier">getDataDir</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.CommandLine.html"><span class="hs-identifier">Agda.Interaction.CommandLine</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.ExitCode.html"><span class="hs-identifier">Agda.Interaction.ExitCode</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ExitCode</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.ExitCode.html#AgdaError"><span class="hs-identifier">AgdaError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">exitSuccess</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Interaction.ExitCode.html#exitAgdaWith"><span class="hs-identifier">exitAgdaWith</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.html"><span class="hs-identifier">Agda.Interaction.Options</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Help.html"><span class="hs-identifier">Agda.Interaction.Options.Help</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.Options.Help.html#Help"><span class="hs-identifier">Help</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.EmacsTop.html"><span class="hs-identifier">Agda.Interaction.EmacsTop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.EmacsTop.html#mimicGHCi"><span class="hs-identifier">mimicGHCi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.JSONTop.html"><span class="hs-identifier">Agda.Interaction.JSONTop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.JSONTop.html#jsonREPL"><span class="hs-identifier">jsonREPL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.FindFile.html"><span class="hs-identifier">Agda.Interaction.FindFile</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.Types.html#SourceFile"><span class="hs-identifier">SourceFile</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.Types.html#SourceFile"><span class="hs-identifier">SourceFile</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Interaction.Imports.html"><span class="hs-identifier">Agda.Interaction.Imports</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Imp</span></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.html"><span class="hs-identifier">Agda.TypeChecking.Monad</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Errors.html"><span class="hs-identifier">Agda.TypeChecking.Errors</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Benchmark.html"><span class="hs-identifier">Agda.TypeChecking.Monad.Benchmark</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bench</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Errors.html"><span class="hs-identifier">Agda.TypeChecking.Errors</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Warnings.html"><span class="hs-identifier">Agda.TypeChecking.Warnings</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html"><span class="hs-identifier">Agda.TypeChecking.Pretty</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.html"><span class="hs-identifier">Agda.Compiler.Backend</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.Builtin.html"><span class="hs-identifier">Agda.Compiler.Builtin</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.VersionCommit.html"><span class="hs-identifier">Agda.VersionCommit</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.Benchmark.html"><span class="hs-identifier">Agda.Utils.Benchmark</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UtilsBench</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.ANSI.html"><span class="hs-identifier">Agda.Syntax.Common.Pretty.ANSI</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ANSI</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html"><span class="hs-identifier">Agda.Syntax.Common.Pretty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html"><span class="hs-identifier">Agda.Utils.FileName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.FileName.html#absolute"><span class="hs-identifier">absolute</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html#filePath"><span class="hs-identifier">filePath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html#AbsolutePath"><span class="hs-identifier">AbsolutePath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.String.html"><span class="hs-identifier">Agda.Utils.String</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Maybe.html"><span class="hs-identifier">Agda.Utils.Maybe</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html"><span class="hs-identifier">Agda.Utils.Monad</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Null.html"><span class="hs-identifier">Agda.Utils.Null</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.Library.html"><span class="hs-identifier">Agda.Interaction.Library</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.Library.html#getAgdaAppDir"><span class="hs-identifier">getAgdaAppDir</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="annot"><span class="hs-comment">-- | The main function</span></span><span>
</span><span id="line-60"></span><span class="annot"><a href="Agda.Main.html#runAgda"><span class="hs-identifier hs-type">runAgda</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span id="runAgda"><span class="annot"><span class="annottext">runAgda :: [Backend] -&gt; IO ()
</span><a href="Agda.Main.html#runAgda"><span class="hs-identifier hs-var hs-var">runAgda</span></a></span></span><span> </span><span id="local-6989586621682033613"><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621682033613"><span class="hs-identifier hs-var">backends</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Backend] -&gt; IO ()
</span><a href="Agda.Main.html#runAgda%27"><span class="hs-identifier hs-var">runAgda'</span></a></span><span> </span><span class="annot"><span class="annottext">([Backend] -&gt; IO ()) -&gt; [Backend] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="Agda.Compiler.Builtin.html#builtinBackends"><span class="hs-identifier hs-var">builtinBackends</span></a></span><span> </span><span class="annot"><span class="annottext">[Backend] -&gt; [Backend] -&gt; [Backend]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621682033613"><span class="hs-identifier hs-var">backends</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="annot"><span class="hs-comment">-- | The main function without importing built-in backends</span></span><span>
</span><span id="line-64"></span><span class="annot"><a href="Agda.Main.html#runAgda%27"><span class="hs-identifier hs-type">runAgda'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span id="runAgda%27"><span class="annot"><span class="annottext">runAgda' :: [Backend] -&gt; IO ()
</span><a href="Agda.Main.html#runAgda%27"><span class="hs-identifier hs-var hs-var">runAgda'</span></a></span></span><span> </span><span id="local-6989586621682033616"><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621682033616"><span class="hs-identifier hs-var">backends</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-66"></span><span>  </span><span id="local-6989586621682033617"><span class="annot"><a href="#local-6989586621682033617"><span class="hs-identifier hs-var">progName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Char]
</span><span class="hs-identifier hs-var">getProgName</span></span><span>
</span><span id="line-67"></span><span>  </span><span id="local-6989586621682033619"><span class="annot"><a href="#local-6989586621682033619"><span class="hs-identifier hs-var">argv</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">getArgs</span></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682033621"><span class="annot"><a href="#local-6989586621682033621"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682033622"><span class="annot"><a href="#local-6989586621682033622"><span class="hs-identifier hs-var">warns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Base.html#runOptM"><span class="hs-identifier hs-type">runOptM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.html#parseBackendOptions"><span class="hs-identifier hs-type">parseBackendOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682033616"><span class="hs-identifier hs-type">backends</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682033619"><span class="hs-identifier hs-type">argv</span></a></span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Base.html#defaultOptions"><span class="hs-identifier hs-type">defaultOptions</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span id="local-6989586621682033626"><span class="annot"><a href="#local-6989586621682033626"><span class="hs-identifier hs-var">conf</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">runExceptT</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682033627"><span class="annot"><a href="#local-6989586621682033627"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682033628"><span class="annot"><a href="#local-6989586621682033628"><span class="hs-identifier hs-var">opts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621682033621"><span class="hs-identifier hs-type">z</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-comment">-- The absolute path of the input file, if provided</span><span>
</span><span id="line-72"></span><span>    </span><span id="local-6989586621682033630"><span class="annot"><a href="#local-6989586621682033630"><span class="hs-identifier hs-var">inputFile</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">liftIO</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html#absolute"><span class="hs-identifier hs-type">absolute</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Types.html#optInputFile"><span class="hs-identifier hs-var">optInputFile</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682033628"><span class="hs-identifier hs-type">opts</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span id="local-6989586621682033634"><span class="annot"><a href="#local-6989586621682033634"><span class="hs-identifier hs-var">mode</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Main.html#getMainMode"><span class="hs-identifier hs-type">getMainMode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682033627"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682033630"><span class="hs-identifier hs-type">inputFile</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682033628"><span class="hs-identifier hs-type">opts</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682033627"><span class="hs-identifier hs-type">bs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682033628"><span class="hs-identifier hs-type">opts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682033634"><span class="hs-identifier hs-type">mode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682033626"><span class="hs-identifier hs-type">conf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621682033636"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682033636"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><a href="Agda.Main.html#optionError"><span class="hs-identifier hs-var">optionError</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682033636"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682033638"><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621682033638"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682033639"><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682033639"><span class="hs-identifier hs-var">opts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682033640"><span class="annot"><span class="annottext">MainMode
</span><a href="#local-6989586621682033640"><span class="hs-identifier hs-var">mode</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MainMode
</span><a href="#local-6989586621682033640"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-81"></span><span>        </span><span class="annot"><a href="Agda.Main.html#MainModePrintHelp"><span class="hs-identifier hs-type">MainModePrintHelp</span></a></span><span> </span><span id="local-6989586621682033642"><span class="annot"><span class="annottext">Help
</span><a href="#local-6989586621682033642"><span class="hs-identifier hs-var">hp</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Backend] -&gt; Help -&gt; IO ()
</span><a href="Agda.Main.html#printUsage"><span class="hs-identifier hs-var">printUsage</span></a></span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621682033638"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Help
</span><a href="#local-6989586621682033642"><span class="hs-identifier hs-var">hp</span></a></span><span>
</span><span id="line-82"></span><span>        </span><span class="annot"><a href="Agda.Main.html#MainModePrintVersion"><span class="hs-identifier hs-type">MainModePrintVersion</span></a></span><span> </span><span id="local-6989586621682033645"><span class="annot"><span class="annottext">PrintAgdaVersion
</span><a href="#local-6989586621682033645"><span class="hs-identifier hs-var">o</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Backend] -&gt; PrintAgdaVersion -&gt; IO ()
</span><a href="Agda.Main.html#printVersion"><span class="hs-identifier hs-var">printVersion</span></a></span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621682033638"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">PrintAgdaVersion
</span><a href="#local-6989586621682033645"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-83"></span><span>        </span><span class="annot"><span class="annottext">MainMode
</span><a href="Agda.Main.html#MainModePrintAgdaDataDir"><span class="hs-identifier hs-var">MainModePrintAgdaDataDir</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="Agda.Main.html#printAgdaDataDir"><span class="hs-identifier hs-var">printAgdaDataDir</span></a></span><span>
</span><span id="line-84"></span><span>        </span><span class="annot"><span class="annottext">MainMode
</span><a href="Agda.Main.html#MainModePrintAgdaAppDir"><span class="hs-identifier hs-var">MainModePrintAgdaAppDir</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="Agda.Main.html#printAgdaAppDir"><span class="hs-identifier hs-var">printAgdaAppDir</span></a></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span>        </span><span class="annot"><a href="Agda.Main.html#MainModeRun"><span class="hs-identifier hs-type">MainModeRun</span></a></span><span> </span><span id="local-6989586621682033652"><span class="annot"><span class="annottext">Interactor ()
</span><a href="#local-6989586621682033652"><span class="hs-identifier hs-var">interactor</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCM () -&gt; IO ()
</span><a href="Agda.Main.html#runTCMPrettyErrors"><span class="hs-identifier hs-var">runTCMPrettyErrors</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span>          </span><span class="annot"><span class="annottext">(OptionWarning -&gt; TCM ()) -&gt; OptionWarnings -&gt; TCM ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Warning -&gt; TCM ()
forall (m :: * -&gt; *).
(?callStack::CallStack, MonadWarning m) =&gt;
Warning -&gt; m ()
</span><a href="Agda.TypeChecking.Warnings.html#warning"><span class="hs-identifier hs-var">warning</span></a></span><span> </span><span class="annot"><span class="annottext">(Warning -&gt; TCM ())
-&gt; (OptionWarning -&gt; Warning) -&gt; OptionWarning -&gt; TCM ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OptionWarning -&gt; Warning
</span><a href="Agda.TypeChecking.Monad.Base.html#OptionWarning"><span class="hs-identifier hs-var">OptionWarning</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OptionWarnings
</span><a href="#local-6989586621682033622"><span class="hs-identifier hs-var">warns</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; TCM () -&gt; TCM ()
forall b (m :: * -&gt; *). (IsBool b, Monad m) =&gt; b -&gt; m () -&gt; m ()
</span><a href="Agda.Utils.Monad.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Types.html#optTransliterate"><span class="hs-identifier hs-var">optTransliterate</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682033639"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; TCM ()
forall a. IO a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; TCM ()) -&gt; IO () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-91"></span><span>            </span><span class="hs-comment">-- When --interaction or --interaction-json is used, then we</span><span>
</span><span id="line-92"></span><span>            </span><span class="hs-comment">-- use UTF-8 when writing to stdout (and when reading from</span><span>
</span><span id="line-93"></span><span>            </span><span class="hs-comment">-- stdin).</span><span>
</span><span id="line-94"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Types.html#optGHCiInteraction"><span class="hs-identifier hs-var">optGHCiInteraction</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682033639"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Types.html#optJSONInteraction"><span class="hs-identifier hs-var">optJSONInteraction</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682033639"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-95"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><a href="Agda.Main.html#optionError"><span class="hs-identifier hs-var">optionError</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-96"></span><span>                   </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;The option --transliterate must not be combined with &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-97"></span><span>                   </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;--interaction or --interaction-json&quot;</span></span><span>
</span><span id="line-98"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-99"></span><span>              </span><span class="hs-comment">-- Transliterate unsupported code points.</span><span>
</span><span id="line-100"></span><span>              </span><span id="local-6989586621682033663"><span class="annot"><a href="#local-6989586621682033663"><span class="hs-identifier hs-var">enc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO TextEncoding
</span><span class="hs-identifier hs-var">IO.mkTextEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TextEncoding -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TextEncoding
</span><span class="hs-identifier hs-var">IO.localeEncoding</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;//TRANSLIT&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">IO.hSetEncoding</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO.stdout</span></span><span> </span><span class="annot"><a href="#local-6989586621682033663"><span class="hs-identifier hs-type">enc</span></a></span><span>
</span><span id="line-102"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">IO.hSetEncoding</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO.stderr</span></span><span> </span><span class="annot"><a href="#local-6989586621682033663"><span class="hs-identifier hs-type">enc</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span>          </span><span class="annot"><span class="annottext">Lens' TCState [Backend] -&gt; [Backend] -&gt; TCM ()
forall (m :: * -&gt; *) a.
MonadTCState m =&gt;
Lens' TCState a -&gt; a -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#setTCLens"><span class="hs-identifier hs-var">setTCLens</span></a></span><span> </span><span class="annot"><span class="annottext">([Backend] -&gt; f [Backend]) -&gt; TCState -&gt; f TCState
Lens' TCState [Backend]
</span><a href="Agda.TypeChecking.Monad.Base.html#stBackends"><span class="hs-identifier hs-var">stBackends</span></a></span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621682033638"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-105"></span><span>          </span><span class="annot"><span class="annottext">Interactor () -&gt; [Char] -&gt; CommandLineOptions -&gt; TCM ()
forall a. Interactor a -&gt; [Char] -&gt; CommandLineOptions -&gt; TCM a
</span><a href="Agda.Main.html#runAgdaWithOptions"><span class="hs-identifier hs-var">runAgdaWithOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Interactor ()
</span><a href="#local-6989586621682033652"><span class="hs-identifier hs-var">interactor</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682033617"><span class="hs-identifier hs-var">progName</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682033639"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><span class="hs-comment">-- | Main execution mode</span></span><span>
</span><span id="line-108"></span><span class="hs-keyword">data</span><span> </span><span id="MainMode"><span class="annot"><a href="Agda.Main.html#MainMode"><span class="hs-identifier hs-var">MainMode</span></a></span></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="MainModeRun"><span class="annot"><a href="Agda.Main.html#MainModeRun"><span class="hs-identifier hs-var">MainModeRun</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Main.html#Interactor"><span class="hs-identifier hs-type">Interactor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MainModePrintHelp"><span class="annot"><a href="Agda.Main.html#MainModePrintHelp"><span class="hs-identifier hs-var">MainModePrintHelp</span></a></span></span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Help.html#Help"><span class="hs-identifier hs-type">Help</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MainModePrintVersion"><span class="annot"><a href="Agda.Main.html#MainModePrintVersion"><span class="hs-identifier hs-var">MainModePrintVersion</span></a></span></span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Types.html#PrintAgdaVersion"><span class="hs-identifier hs-type">PrintAgdaVersion</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MainModePrintAgdaDataDir"><span class="annot"><a href="Agda.Main.html#MainModePrintAgdaDataDir"><span class="hs-identifier hs-var">MainModePrintAgdaDataDir</span></a></span></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MainModePrintAgdaAppDir"><span class="annot"><a href="Agda.Main.html#MainModePrintAgdaAppDir"><span class="hs-identifier hs-var">MainModePrintAgdaAppDir</span></a></span></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">-- | Determine the main execution mode to run, based on the configured backends and command line options.</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- | This is pure.</span><span>
</span><span id="line-117"></span><span id="local-6989586621682033243"><span class="annot"><a href="Agda.Main.html#getMainMode"><span class="hs-identifier hs-type">getMainMode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621682033243"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html#AbsolutePath"><span class="hs-identifier hs-type">AbsolutePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Types.html#CommandLineOptions"><span class="hs-identifier hs-type">CommandLineOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682033243"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Main.html#MainMode"><span class="hs-identifier hs-type">MainMode</span></a></span></span><span>
</span><span id="line-118"></span><span id="getMainMode"><span class="annot"><span class="annottext">getMainMode :: forall (m :: * -&gt; *).
MonadError [Char] m =&gt;
[Backend] -&gt; Maybe AbsolutePath -&gt; CommandLineOptions -&gt; m MainMode
</span><a href="Agda.Main.html#getMainMode"><span class="hs-identifier hs-var hs-var">getMainMode</span></a></span></span><span> </span><span id="local-6989586621682033685"><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621682033685"><span class="hs-identifier hs-var">configuredBackends</span></a></span></span><span> </span><span id="local-6989586621682033686"><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><a href="#local-6989586621682033686"><span class="hs-identifier hs-var">maybeInputFile</span></a></span></span><span> </span><span id="local-6989586621682033687"><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682033687"><span class="hs-identifier hs-var">opts</span></a></span></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682033688"><span class="annot"><span class="annottext">Help
</span><a href="#local-6989586621682033688"><span class="hs-identifier hs-var">hp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Maybe Help
</span><a href="Agda.Interaction.Options.Types.html#optPrintHelp"><span class="hs-identifier hs-var">optPrintHelp</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682033687"><span class="hs-identifier hs-var">opts</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MainMode -&gt; m MainMode
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MainMode -&gt; m MainMode) -&gt; MainMode -&gt; m MainMode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Help -&gt; MainMode
</span><a href="Agda.Main.html#MainModePrintHelp"><span class="hs-identifier hs-var">MainModePrintHelp</span></a></span><span> </span><span class="annot"><span class="annottext">Help
</span><a href="#local-6989586621682033688"><span class="hs-identifier hs-var">hp</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682033690"><span class="annot"><span class="annottext">PrintAgdaVersion
</span><a href="#local-6989586621682033690"><span class="hs-identifier hs-var">o</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Maybe PrintAgdaVersion
</span><a href="Agda.Interaction.Options.Types.html#optPrintVersion"><span class="hs-identifier hs-var">optPrintVersion</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682033687"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MainMode -&gt; m MainMode
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MainMode -&gt; m MainMode) -&gt; MainMode -&gt; m MainMode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrintAgdaVersion -&gt; MainMode
</span><a href="Agda.Main.html#MainModePrintVersion"><span class="hs-identifier hs-var">MainModePrintVersion</span></a></span><span> </span><span class="annot"><span class="annottext">PrintAgdaVersion
</span><a href="#local-6989586621682033690"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Types.html#optPrintAgdaDataDir"><span class="hs-identifier hs-var">optPrintAgdaDataDir</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682033687"><span class="hs-identifier hs-var">opts</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MainMode -&gt; m MainMode
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MainMode -&gt; m MainMode) -&gt; MainMode -&gt; m MainMode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MainMode
</span><a href="Agda.Main.html#MainModePrintAgdaDataDir"><span class="hs-identifier hs-var">MainModePrintAgdaDataDir</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Types.html#optPrintAgdaAppDir"><span class="hs-identifier hs-var">optPrintAgdaAppDir</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682033687"><span class="hs-identifier hs-var">opts</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MainMode -&gt; m MainMode
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MainMode -&gt; m MainMode) -&gt; MainMode -&gt; m MainMode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MainMode
</span><a href="Agda.Main.html#MainModePrintAgdaAppDir"><span class="hs-identifier hs-var">MainModePrintAgdaAppDir</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-124"></span><span>      </span><span id="local-6989586621682033694"><span class="annot"><a href="#local-6989586621682033694"><span class="hs-identifier hs-var">mi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Backend]
-&gt; Maybe AbsolutePath
-&gt; CommandLineOptions
-&gt; m (Maybe (Interactor ()))
forall (m :: * -&gt; *).
MonadError [Char] m =&gt;
[Backend]
-&gt; Maybe AbsolutePath
-&gt; CommandLineOptions
-&gt; m (Maybe (Interactor ()))
</span><a href="Agda.Main.html#getInteractor"><span class="hs-identifier hs-var">getInteractor</span></a></span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621682033685"><span class="hs-identifier hs-var">configuredBackends</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><a href="#local-6989586621682033686"><span class="hs-identifier hs-var">maybeInputFile</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682033687"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-125"></span><span>      </span><span class="hs-comment">-- If there was no selection whatsoever (e.g. just invoked &quot;agda&quot;), we just show help and exit.</span><span>
</span><span id="line-126"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Main.html#MainModePrintHelp"><span class="hs-identifier hs-type">MainModePrintHelp</span></a></span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Help.html#GeneralHelp"><span class="hs-identifier hs-type">GeneralHelp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Agda.Main.html#MainModeRun"><span class="hs-identifier hs-type">MainModeRun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682033694"><span class="hs-identifier hs-type">mi</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-keyword">type</span><span> </span><span id="Interactor"><span class="annot"><a href="Agda.Main.html#Interactor"><span class="hs-identifier hs-var">Interactor</span></a></span></span><span> </span><span id="local-6989586621682033698"><span class="annot"><a href="#local-6989586621682033698"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-comment">-- Setup/initialization action.</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-comment">-- This is separated so that errors can be reported in the appropriate format.</span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-comment">-- Type-checking action</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.FileName.html#AbsolutePath"><span class="hs-identifier hs-type">AbsolutePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Interaction.Imports.html#CheckResult"><span class="hs-identifier hs-type">CheckResult</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-comment">-- Main transformed action.</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682033698"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="annot"><span class="hs-comment">-- | Major mode of operation, not including the standard mode (checking the given main module).</span></span><span>
</span><span id="line-138"></span><span class="hs-keyword">data</span><span> </span><span id="FrontendType"><span class="annot"><a href="Agda.Main.html#FrontendType"><span class="hs-identifier hs-var">FrontendType</span></a></span></span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="FrontEndInteraction"><span class="annot"><a href="Agda.Main.html#FrontEndInteraction"><span class="hs-identifier hs-var">FrontEndInteraction</span></a></span></span><span> </span><span class="annot"><a href="Agda.Main.html#InteractionFormat"><span class="hs-identifier hs-type">InteractionFormat</span></a></span><span>
</span><span id="line-140"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ @--interaction@ or @--interaction-json@.</span></span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FrontEndRepl"><span class="annot"><a href="Agda.Main.html#FrontEndRepl"><span class="hs-identifier hs-var">FrontEndRepl</span></a></span></span><span>
</span><span id="line-142"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ @--interactive@.</span></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-keyword">data</span><span> </span><span id="InteractionFormat"><span class="annot"><a href="Agda.Main.html#InteractionFormat"><span class="hs-identifier hs-var">InteractionFormat</span></a></span></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="InteractionEmacs"><span class="annot"><a href="Agda.Main.html#InteractionEmacs"><span class="hs-identifier hs-var">InteractionEmacs</span></a></span></span><span>
</span><span id="line-146"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ @--interaction@.</span></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="InteractionJson"><span class="annot"><a href="Agda.Main.html#InteractionJson"><span class="hs-identifier hs-var">InteractionJson</span></a></span></span><span>
</span><span id="line-148"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ @--interaction-json@.</span></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Agda.Main.html#FrontEndEmacs"><span class="hs-identifier hs-type">FrontEndEmacs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Main.html#FrontendType"><span class="hs-identifier hs-type">FrontendType</span></a></span><span>
</span><span id="line-151"></span><span class="hs-keyword">pattern</span><span> </span><span id="FrontEndEmacs"><span id="%24mFrontEndEmacs"><span id="%24bFrontEndEmacs"><span class="annot"><span class="annottext">$mFrontEndEmacs :: forall {r}. FrontendType -&gt; ((# #) -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bFrontEndEmacs :: FrontendType
</span><a href="Agda.Main.html#FrontEndEmacs"><span class="hs-identifier hs-var hs-var hs-var">FrontEndEmacs</span></a></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Main.html#FrontEndInteraction"><span class="hs-identifier hs-type">FrontEndInteraction</span></a></span><span> </span><span class="annot"><a href="Agda.Main.html#InteractionEmacs"><span class="hs-identifier hs-type">InteractionEmacs</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Agda.Main.html#FrontEndJson"><span class="hs-identifier hs-type">FrontEndJson</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Main.html#FrontendType"><span class="hs-identifier hs-type">FrontendType</span></a></span><span>
</span><span id="line-154"></span><span class="hs-keyword">pattern</span><span> </span><span id="FrontEndJson"><span id="%24mFrontEndJson"><span id="%24bFrontEndJson"><span class="annot"><span class="annottext">$mFrontEndJson :: forall {r}. FrontendType -&gt; ((# #) -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bFrontEndJson :: FrontendType
</span><a href="Agda.Main.html#FrontEndJson"><span class="hs-identifier hs-var hs-var hs-var">FrontEndJson</span></a></span></span></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Main.html#FrontEndInteraction"><span class="hs-identifier hs-type">FrontEndInteraction</span></a></span><span> </span><span class="annot"><a href="Agda.Main.html#InteractionJson"><span class="hs-identifier hs-type">InteractionJson</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="annot"><a href="Agda.Main.html#FrontEndEmacs"><span class="hs-pragma hs-type">FrontEndEmacs</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Agda.Main.html#FrontEndJson"><span class="hs-pragma hs-type">FrontEndJson</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Agda.Main.html#FrontEndRepl"><span class="hs-pragma hs-type">FrontEndRepl</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="annot"><span class="hs-comment">-- | Emacs/JSON mode. Note that it ignores the &quot;check&quot; action because it calls typeCheck directly.</span></span><span>
</span><span id="line-159"></span><span class="annot"><a href="Agda.Main.html#interactionInteractor"><span class="hs-identifier hs-type">interactionInteractor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Main.html#InteractionFormat"><span class="hs-identifier hs-type">InteractionFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Main.html#Interactor"><span class="hs-identifier hs-type">Interactor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span id="interactionInteractor"><span class="annot"><span class="annottext">interactionInteractor :: InteractionFormat -&gt; Interactor ()
</span><a href="Agda.Main.html#interactionInteractor"><span class="hs-identifier hs-var hs-var">interactionInteractor</span></a></span></span><span> </span><span class="annot"><span class="annottext">InteractionFormat
</span><a href="Agda.Main.html#InteractionEmacs"><span class="hs-identifier hs-var">InteractionEmacs</span></a></span><span> </span><span id="local-6989586621682033710"><span class="annot"><span class="annottext">TCM ()
</span><a href="#local-6989586621682033710"><span class="hs-identifier hs-var">setup</span></a></span></span><span> </span><span id="local-6989586621682033711"><span class="annot"><span class="annottext">AbsolutePath -&gt; TCM CheckResult
</span><a href="#local-6989586621682033711"><span class="hs-identifier hs-var">_check</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCM () -&gt; TCM ()
</span><a href="Agda.Interaction.EmacsTop.html#mimicGHCi"><span class="hs-identifier hs-var">mimicGHCi</span></a></span><span> </span><span class="annot"><span class="annottext">TCM ()
</span><a href="#local-6989586621682033710"><span class="hs-identifier hs-var">setup</span></a></span><span>
</span><span id="line-161"></span><span class="annot"><a href="Agda.Main.html#interactionInteractor"><span class="hs-identifier hs-var">interactionInteractor</span></a></span><span> </span><span class="annot"><span class="annottext">InteractionFormat
</span><a href="Agda.Main.html#InteractionJson"><span class="hs-identifier hs-var">InteractionJson</span></a></span><span>  </span><span id="local-6989586621682033712"><span class="annot"><span class="annottext">TCM ()
</span><a href="#local-6989586621682033712"><span class="hs-identifier hs-var">setup</span></a></span></span><span> </span><span id="local-6989586621682033713"><span class="annot"><span class="annottext">AbsolutePath -&gt; TCM CheckResult
</span><a href="#local-6989586621682033713"><span class="hs-identifier hs-var">_check</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCM () -&gt; TCM ()
</span><a href="Agda.Interaction.JSONTop.html#jsonREPL"><span class="hs-identifier hs-var">jsonREPL</span></a></span><span>  </span><span class="annot"><span class="annottext">TCM ()
</span><a href="#local-6989586621682033712"><span class="hs-identifier hs-var">setup</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- The deprecated repl mode.</span><span>
</span><span id="line-164"></span><span class="annot"><a href="Agda.Main.html#replInteractor"><span class="hs-identifier hs-type">replInteractor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html#AbsolutePath"><span class="hs-identifier hs-type">AbsolutePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Main.html#Interactor"><span class="hs-identifier hs-type">Interactor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span id="replInteractor"><span class="annot"><span class="annottext">replInteractor :: Maybe AbsolutePath -&gt; Interactor ()
</span><a href="Agda.Main.html#replInteractor"><span class="hs-identifier hs-var hs-var">replInteractor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe AbsolutePath -&gt; Interactor ()
</span><a href="Agda.Interaction.CommandLine.html#runInteractionLoop"><span class="hs-identifier hs-var">runInteractionLoop</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- The interactor to use when there are no frontends or backends specified.</span><span>
</span><span id="line-168"></span><span class="annot"><a href="Agda.Main.html#defaultInteractor"><span class="hs-identifier hs-type">defaultInteractor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html#AbsolutePath"><span class="hs-identifier hs-type">AbsolutePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Main.html#Interactor"><span class="hs-identifier hs-type">Interactor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span id="defaultInteractor"><span class="annot"><span class="annottext">defaultInteractor :: AbsolutePath -&gt; Interactor ()
</span><a href="Agda.Main.html#defaultInteractor"><span class="hs-identifier hs-var hs-var">defaultInteractor</span></a></span></span><span> </span><span id="local-6989586621682033717"><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621682033717"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span id="local-6989586621682033718"><span class="annot"><span class="annottext">TCM ()
</span><a href="#local-6989586621682033718"><span class="hs-identifier hs-var">setup</span></a></span></span><span> </span><span id="local-6989586621682033719"><span class="annot"><span class="annottext">AbsolutePath -&gt; TCM CheckResult
</span><a href="#local-6989586621682033719"><span class="hs-identifier hs-var">check</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">TCM ()
</span><a href="#local-6989586621682033718"><span class="hs-identifier hs-var">setup</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">TCM CheckResult -&gt; TCM ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(TCM CheckResult -&gt; TCM ()) -&gt; TCM CheckResult -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AbsolutePath -&gt; TCM CheckResult
</span><a href="#local-6989586621682033719"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621682033717"><span class="hs-identifier hs-var">file</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span id="local-6989586621682033273"><span class="annot"><a href="Agda.Main.html#getInteractor"><span class="hs-identifier hs-type">getInteractor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621682033273"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html#AbsolutePath"><span class="hs-identifier hs-type">AbsolutePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Types.html#CommandLineOptions"><span class="hs-identifier hs-type">CommandLineOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682033273"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Main.html#Interactor"><span class="hs-identifier hs-type">Interactor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-172"></span><span id="getInteractor"><span class="annot"><span class="annottext">getInteractor :: forall (m :: * -&gt; *).
MonadError [Char] m =&gt;
[Backend]
-&gt; Maybe AbsolutePath
-&gt; CommandLineOptions
-&gt; m (Maybe (Interactor ()))
</span><a href="Agda.Main.html#getInteractor"><span class="hs-identifier hs-var hs-var">getInteractor</span></a></span></span><span> </span><span id="local-6989586621682033753"><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621682033753"><span class="hs-identifier hs-var">configuredBackends</span></a></span></span><span> </span><span id="local-6989586621682033754"><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><a href="#local-6989586621682033754"><span class="hs-identifier hs-var">maybeInputFile</span></a></span></span><span> </span><span id="local-6989586621682033755"><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682033755"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[FrontendType]
</span><a href="#local-6989586621682033756"><span class="hs-identifier hs-var">enabledFrontends</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><span class="annottext">FrontendType
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">FrontendType
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[FrontendType]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m (Maybe (Interactor ()))
forall a. [Char] -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; m (Maybe (Interactor ())))
-&gt; [Char] -&gt; m (Maybe (Interactor ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Must not specify multiple &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682033759"><span class="hs-identifier hs-var">enabledFrontendNames</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-comment">-- standard mode of operation</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-179"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><a href="#local-6989586621682033754"><span class="hs-identifier hs-var">maybeInputFile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621682033760"><span class="hs-identifier hs-var">enabledBackends</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-180"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682033761"><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621682033761"><span class="hs-identifier hs-var">inputFile</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Backend
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Backend]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Interactor ()) -&gt; m (Maybe (Interactor ()))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Interactor ()) -&gt; m (Maybe (Interactor ())))
-&gt; Maybe (Interactor ()) -&gt; m (Maybe (Interactor ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Interactor () -&gt; Maybe (Interactor ())
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Interactor () -&gt; Maybe (Interactor ()))
-&gt; Interactor () -&gt; Maybe (Interactor ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AbsolutePath -&gt; [Backend] -&gt; Interactor ()
</span><a href="Agda.Compiler.Backend.html#backendInteraction"><span class="hs-identifier hs-var">backendInteraction</span></a></span><span> </span><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621682033761"><span class="hs-identifier hs-var">inputFile</span></a></span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621682033760"><span class="hs-identifier hs-var">enabledBackends</span></a></span><span>
</span><span id="line-181"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682033763"><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621682033763"><span class="hs-identifier hs-var">inputFile</span></a></span></span><span class="hs-special">,</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Interactor ()) -&gt; m (Maybe (Interactor ()))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Interactor ()) -&gt; m (Maybe (Interactor ())))
-&gt; Maybe (Interactor ()) -&gt; m (Maybe (Interactor ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Interactor () -&gt; Maybe (Interactor ())
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Interactor () -&gt; Maybe (Interactor ()))
-&gt; Interactor () -&gt; Maybe (Interactor ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AbsolutePath -&gt; Interactor ()
</span><a href="Agda.Main.html#defaultInteractor"><span class="hs-identifier hs-var">defaultInteractor</span></a></span><span> </span><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621682033763"><span class="hs-identifier hs-var">inputFile</span></a></span><span>
</span><span id="line-182"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>         </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Interactor ()) -&gt; m (Maybe (Interactor ()))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Interactor ())
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- No backends, frontends, or input files specified.</span><span>
</span><span id="line-183"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>        </span><span class="annot"><span class="annottext">Backend
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Backend]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m (Maybe (Interactor ()))
forall a. [Char] -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; m (Maybe (Interactor ())))
-&gt; [Char] -&gt; m (Maybe (Interactor ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;No input file specified for &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682033764"><span class="hs-identifier hs-var">enabledBackendNames</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-comment">-- special mode of operation</span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621682033765"><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621682033765"><span class="hs-identifier hs-var">fe</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-187"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621682033765"><span class="hs-identifier hs-var">fe</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-188"></span><span>        </span><span class="hs-comment">-- --interactive</span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><span class="annottext">FrontendType
</span><a href="Agda.Main.html#FrontEndRepl"><span class="hs-identifier hs-var">FrontEndRepl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-190"></span><span>          </span><span class="annot"><span class="annottext">FrontendType -&gt; m ()
</span><a href="#local-6989586621682033766"><span class="hs-identifier hs-var">noBackends</span></a></span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621682033765"><span class="hs-identifier hs-var">fe</span></a></span><span>
</span><span id="line-191"></span><span>          </span><span class="annot"><span class="annottext">FrontendType -&gt; m ()
</span><a href="#local-6989586621682033767"><span class="hs-identifier hs-var">notJustScopeChecking</span></a></span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621682033765"><span class="hs-identifier hs-var">fe</span></a></span><span>
</span><span id="line-192"></span><span>          </span><span class="annot"><span class="annottext">Maybe (Interactor ()) -&gt; m (Maybe (Interactor ()))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Interactor ()) -&gt; m (Maybe (Interactor ())))
-&gt; Maybe (Interactor ()) -&gt; m (Maybe (Interactor ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Interactor () -&gt; Maybe (Interactor ())
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Interactor () -&gt; Maybe (Interactor ()))
-&gt; Interactor () -&gt; Maybe (Interactor ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe AbsolutePath -&gt; Interactor ()
</span><a href="Agda.Main.html#replInteractor"><span class="hs-identifier hs-var">replInteractor</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><a href="#local-6989586621682033754"><span class="hs-identifier hs-var">maybeInputFile</span></a></span><span>
</span><span id="line-193"></span><span>        </span><span class="hs-comment">-- --interaction(-json)</span><span>
</span><span id="line-194"></span><span>        </span><span class="annot"><a href="Agda.Main.html#FrontEndInteraction"><span class="hs-identifier hs-type">FrontEndInteraction</span></a></span><span> </span><span id="local-6989586621682033768"><span class="annot"><span class="annottext">InteractionFormat
</span><a href="#local-6989586621682033768"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-195"></span><span>          </span><span class="annot"><span class="annottext">FrontendType -&gt; m ()
</span><a href="#local-6989586621682033766"><span class="hs-identifier hs-var">noBackends</span></a></span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621682033765"><span class="hs-identifier hs-var">fe</span></a></span><span>
</span><span id="line-196"></span><span>          </span><span class="annot"><span class="annottext">FrontendType -&gt; m ()
</span><a href="#local-6989586621682033767"><span class="hs-identifier hs-var">notJustScopeChecking</span></a></span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621682033765"><span class="hs-identifier hs-var">fe</span></a></span><span>
</span><span id="line-197"></span><span>          </span><span class="annot"><span class="annottext">FrontendType -&gt; m ()
</span><a href="#local-6989586621682033769"><span class="hs-identifier hs-var">noInputFile</span></a></span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621682033765"><span class="hs-identifier hs-var">fe</span></a></span><span>
</span><span id="line-198"></span><span>          </span><span class="annot"><span class="annottext">Maybe (Interactor ()) -&gt; m (Maybe (Interactor ()))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Interactor ()) -&gt; m (Maybe (Interactor ())))
-&gt; Maybe (Interactor ()) -&gt; m (Maybe (Interactor ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Interactor () -&gt; Maybe (Interactor ())
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Interactor () -&gt; Maybe (Interactor ()))
-&gt; Interactor () -&gt; Maybe (Interactor ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">InteractionFormat -&gt; Interactor ()
</span><a href="Agda.Main.html#interactionInteractor"><span class="hs-identifier hs-var">interactionInteractor</span></a></span><span> </span><span class="annot"><span class="annottext">InteractionFormat
</span><a href="#local-6989586621682033768"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-comment">-- NOTE: The notion of a backend being &quot;enabled&quot; *just* refers to this top-level interaction mode selection. The</span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-comment">-- interaction/interactive front-ends may still invoke available backends even if they are not &quot;enabled&quot;.</span><span>
</span><span id="line-202"></span><span>    </span><span id="local-6989586621682033770"><span class="annot"><span class="annottext">isBackendEnabled :: Backend_boot definition tcm -&gt; Bool
</span><a href="#local-6989586621682033770"><span class="hs-identifier hs-var hs-var">isBackendEnabled</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.Backend.Base.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span id="local-6989586621682033773"><span class="annot"><span class="annottext">Backend'_boot definition tcm opts env menv mod def
</span><a href="#local-6989586621682033773"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Backend'_boot definition tcm opts env menv mod def -&gt; opts -&gt; Bool
forall definition (tcm :: * -&gt; *) opts env menv mod def.
Backend'_boot definition tcm opts env menv mod def -&gt; opts -&gt; Bool
</span><a href="Agda.Compiler.Backend.Base.html#isEnabled"><span class="hs-identifier hs-var">isEnabled</span></a></span><span> </span><span class="annot"><span class="annottext">Backend'_boot definition tcm opts env menv mod def
</span><a href="#local-6989586621682033773"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Backend'_boot definition tcm opts env menv mod def -&gt; opts
forall definition (tcm :: * -&gt; *) opts env menv mod def.
Backend'_boot definition tcm opts env menv mod def -&gt; opts
</span><a href="Agda.Compiler.Backend.Base.html#options"><span class="hs-identifier hs-var">options</span></a></span><span> </span><span class="annot"><span class="annottext">Backend'_boot definition tcm opts env menv mod def
</span><a href="#local-6989586621682033773"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>    </span><span id="local-6989586621682033760"><span class="annot"><span class="annottext">enabledBackends :: [Backend]
</span><a href="#local-6989586621682033760"><span class="hs-identifier hs-var hs-var">enabledBackends</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Backend -&gt; Bool) -&gt; [Backend] -&gt; [Backend]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Backend -&gt; Bool
forall {definition} {tcm :: * -&gt; *}.
Backend_boot definition tcm -&gt; Bool
</span><a href="#local-6989586621682033770"><span class="hs-identifier hs-var">isBackendEnabled</span></a></span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621682033753"><span class="hs-identifier hs-var">configuredBackends</span></a></span><span>
</span><span id="line-204"></span><span>    </span><span id="local-6989586621682033756"><span class="annot"><span class="annottext">enabledFrontends :: [FrontendType]
</span><a href="#local-6989586621682033756"><span class="hs-identifier hs-var hs-var">enabledFrontends</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[FrontendType]] -&gt; [FrontendType]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-205"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="Agda.Main.html#FrontEndRepl"><span class="hs-identifier hs-var">FrontEndRepl</span></a></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Types.html#optInteractive"><span class="hs-identifier hs-var">optInteractive</span></a></span><span>     </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682033755"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-206"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="Agda.Main.html#FrontEndEmacs"><span class="hs-identifier hs-var">FrontEndEmacs</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Types.html#optGHCiInteraction"><span class="hs-identifier hs-var">optGHCiInteraction</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682033755"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-207"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="Agda.Main.html#FrontEndJson"><span class="hs-identifier hs-var">FrontEndJson</span></a></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Types.html#optJSONInteraction"><span class="hs-identifier hs-var">optJSONInteraction</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682033755"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-208"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-comment">-- Constructs messages like &quot;(no backend)&quot;, &quot;backend ghc&quot;, &quot;backends (ghc, ocaml)&quot;</span><span>
</span><span id="line-210"></span><span>    </span><span id="local-6989586621682033788"><span class="annot"><span class="annottext">pluralize :: [Char] -&gt; [[Char]] -&gt; [Char]
</span><a href="#local-6989586621682033788"><span class="hs-identifier hs-var hs-var">pluralize</span></a></span></span><span> </span><span id="local-6989586621682033789"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682033789"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(no &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682033789"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><a href="#local-6989586621682033788"><span class="hs-identifier hs-var">pluralize</span></a></span><span> </span><span id="local-6989586621682033790"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682033790"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682033791"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682033791"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682033790"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682033791"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><a href="#local-6989586621682033788"><span class="hs-identifier hs-var">pluralize</span></a></span><span> </span><span id="local-6989586621682033792"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682033792"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682033793"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621682033793"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682033792"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;s (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [Char]
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">List.intercalate</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621682033793"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621682033764"><span class="annot"><span class="annottext">enabledBackendNames :: [Char]
</span><a href="#local-6989586621682033764"><span class="hs-identifier hs-var hs-var">enabledBackendNames</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [Char]
</span><a href="#local-6989586621682033788"><span class="hs-identifier hs-var">pluralize</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;backend&quot;</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; [Char]) -&gt; Text -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Backend'_boot Definition (TCMT IO) opts env menv mod def -&gt; Text
forall definition (tcm :: * -&gt; *) opts env menv mod def.
Backend'_boot definition tcm opts env menv mod def -&gt; Text
</span><a href="Agda.Compiler.Backend.Base.html#backendName"><span class="hs-identifier hs-var">backendName</span></a></span><span> </span><span class="annot"><span class="annottext">Backend'_boot Definition (TCMT IO) opts env menv mod def
</span><a href="#local-6989586621682033797"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.Base.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span id="local-6989586621682033797"><span class="annot"><span class="annottext">Backend'_boot Definition (TCMT IO) opts env menv mod def
</span><a href="#local-6989586621682033797"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621682033760"><span class="hs-identifier hs-var">enabledBackends</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621682033759"><span class="annot"><span class="annottext">enabledFrontendNames :: [Char]
</span><a href="#local-6989586621682033759"><span class="hs-identifier hs-var hs-var">enabledFrontendNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [Char]
</span><a href="#local-6989586621682033788"><span class="hs-identifier hs-var">pluralize</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;frontend&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FrontendType -&gt; [Char]
</span><a href="#local-6989586621682033799"><span class="hs-identifier hs-var">frontendFlagName</span></a></span><span> </span><span class="annot"><span class="annottext">(FrontendType -&gt; [Char]) -&gt; [FrontendType] -&gt; [[Char]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[FrontendType]
</span><a href="#local-6989586621682033756"><span class="hs-identifier hs-var">enabledFrontends</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>    </span><span id="local-6989586621682033799"><span class="annot"><span class="annottext">frontendFlagName :: FrontendType -&gt; [Char]
</span><a href="#local-6989586621682033799"><span class="hs-identifier hs-var hs-var">frontendFlagName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;--&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char])
-&gt; (FrontendType -&gt; [Char]) -&gt; FrontendType -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-216"></span><span>      </span><span class="annot"><span class="annottext">FrontendType
</span><a href="Agda.Main.html#FrontEndEmacs"><span class="hs-identifier hs-var">FrontEndEmacs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;interaction&quot;</span></span><span>
</span><span id="line-217"></span><span>      </span><span class="annot"><span class="annottext">FrontendType
</span><a href="Agda.Main.html#FrontEndJson"><span class="hs-identifier hs-var">FrontEndJson</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;interaction-json&quot;</span></span><span>
</span><span id="line-218"></span><span>      </span><span class="annot"><span class="annottext">FrontendType
</span><a href="Agda.Main.html#FrontEndRepl"><span class="hs-identifier hs-var">FrontEndRepl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;interactive&quot;</span></span><span>
</span><span id="line-219"></span><span>    </span><span id="local-6989586621682033766"><span class="annot"><span class="annottext">noBackends :: FrontendType -&gt; m ()
</span><a href="#local-6989586621682033766"><span class="hs-identifier hs-var hs-var">noBackends</span></a></span></span><span> </span><span id="local-6989586621682033807"><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621682033807"><span class="hs-identifier hs-var">fe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall b (m :: * -&gt; *). (IsBool b, Monad m) =&gt; b -&gt; m () -&gt; m ()
</span><a href="Agda.Utils.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Backend] -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621682033760"><span class="hs-identifier hs-var">enabledBackends</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-220"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; m ()
forall a. [Char] -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; m ()) -&gt; [Char] -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Cannot mix &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FrontendType -&gt; [Char]
</span><a href="#local-6989586621682033799"><span class="hs-identifier hs-var">frontendFlagName</span></a></span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621682033807"><span class="hs-identifier hs-var">fe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; with &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682033764"><span class="hs-identifier hs-var">enabledBackendNames</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-221"></span><span>    </span><span id="local-6989586621682033769"><span class="annot"><span class="annottext">noInputFile :: FrontendType -&gt; m ()
</span><a href="#local-6989586621682033769"><span class="hs-identifier hs-var hs-var">noInputFile</span></a></span></span><span> </span><span id="local-6989586621682033810"><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621682033810"><span class="hs-identifier hs-var">fe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe AbsolutePath -&gt; (AbsolutePath -&gt; m ()) -&gt; m ()
forall (m :: * -&gt; *) a. Monad m =&gt; Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="Agda.Utils.Maybe.html#whenJust"><span class="hs-identifier hs-var">whenJust</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><a href="#local-6989586621682033754"><span class="hs-identifier hs-var">maybeInputFile</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682033812"><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621682033812"><span class="hs-identifier hs-var">inputFile</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AbsolutePath -&gt; FrontendType -&gt; m ()
forall {m :: * -&gt; *} {a}.
MonadError [Char] m =&gt;
AbsolutePath -&gt; FrontendType -&gt; m a
</span><a href="#local-6989586621682033813"><span class="hs-identifier hs-var">errorFrontendFileDisallowed</span></a></span><span> </span><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621682033812"><span class="hs-identifier hs-var">inputFile</span></a></span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621682033810"><span class="hs-identifier hs-var">fe</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span id="local-6989586621682033767"><span class="annot"><span class="annottext">notJustScopeChecking :: FrontendType -&gt; m ()
</span><a href="#local-6989586621682033767"><span class="hs-identifier hs-var hs-var">notJustScopeChecking</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall b (m :: * -&gt; *). (IsBool b, Monad m) =&gt; b -&gt; m () -&gt; m ()
</span><a href="Agda.Utils.Monad.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Types.html#optOnlyScopeChecking"><span class="hs-identifier hs-var">optOnlyScopeChecking</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682033755"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; (FrontendType -&gt; m ()) -&gt; FrontendType -&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FrontendType -&gt; m ()
forall {m :: * -&gt; *} {a}.
MonadError [Char] m =&gt;
FrontendType -&gt; m a
</span><a href="#local-6989586621682033815"><span class="hs-identifier hs-var">errorFrontendScopeChecking</span></a></span><span>
</span><span id="line-223"></span><span>    </span><span id="local-6989586621682033815"><span class="annot"><span class="annottext">errorFrontendScopeChecking :: FrontendType -&gt; m a
</span><a href="#local-6989586621682033815"><span class="hs-identifier hs-var hs-var">errorFrontendScopeChecking</span></a></span></span><span> </span><span id="local-6989586621682033829"><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621682033829"><span class="hs-identifier hs-var">fe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m a
forall a. [Char] -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; m a) -&gt; [Char] -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-224"></span><span>      </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;The --only-scope-checking flag cannot be combined with &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FrontendType -&gt; [Char]
</span><a href="#local-6989586621682033799"><span class="hs-identifier hs-var">frontendFlagName</span></a></span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621682033829"><span class="hs-identifier hs-var">fe</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-225"></span><span>    </span><span id="local-6989586621682033813"><span class="annot"><span class="annottext">errorFrontendFileDisallowed :: AbsolutePath -&gt; FrontendType -&gt; m a
</span><a href="#local-6989586621682033813"><span class="hs-identifier hs-var hs-var">errorFrontendFileDisallowed</span></a></span></span><span> </span><span id="local-6989586621682033842"><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621682033842"><span class="hs-identifier hs-var">inputFile</span></a></span></span><span> </span><span id="local-6989586621682033843"><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621682033843"><span class="hs-identifier hs-var">fe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m a
forall a. [Char] -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; m a) -&gt; [Char] -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-226"></span><span>      </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Must not specify an input file (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AbsolutePath -&gt; [Char]
</span><a href="Agda.Utils.FileName.html#filePath"><span class="hs-identifier hs-var">filePath</span></a></span><span> </span><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621682033842"><span class="hs-identifier hs-var">inputFile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;) with &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FrontendType -&gt; [Char]
</span><a href="#local-6989586621682033799"><span class="hs-identifier hs-var">frontendFlagName</span></a></span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621682033843"><span class="hs-identifier hs-var">fe</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><span class="hs-comment">-- | Run Agda with parsed command line options</span></span><span>
</span><span id="line-229"></span><span id="local-6989586621682033269"><span class="annot"><a href="Agda.Main.html#runAgdaWithOptions"><span class="hs-identifier hs-type">runAgdaWithOptions</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Main.html#Interactor"><span class="hs-identifier hs-type">Interactor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682033269"><span class="hs-identifier hs-type">a</span></a></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Backend interaction</span></span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>             </span><span class="annot"><span class="hs-comment">-- ^ program name</span></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Types.html#CommandLineOptions"><span class="hs-identifier hs-type">CommandLineOptions</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ parsed command line options</span></span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682033269"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-234"></span><span id="runAgdaWithOptions"><span class="annot"><span class="annottext">runAgdaWithOptions :: forall a. Interactor a -&gt; [Char] -&gt; CommandLineOptions -&gt; TCM a
</span><a href="Agda.Main.html#runAgdaWithOptions"><span class="hs-identifier hs-var hs-var">runAgdaWithOptions</span></a></span></span><span> </span><span id="local-6989586621682033912"><span class="annot"><span class="annottext">Interactor a
</span><a href="#local-6989586621682033912"><span class="hs-identifier hs-var">interactor</span></a></span></span><span> </span><span id="local-6989586621682033913"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682033913"><span class="hs-identifier hs-var">progName</span></a></span></span><span> </span><span id="local-6989586621682033914"><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682033914"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-235"></span><span>          </span><span class="hs-comment">-- Main function.</span><span>
</span><span id="line-236"></span><span>          </span><span class="hs-comment">-- Bill everything to root of Benchmark trie.</span><span>
</span><span id="line-237"></span><span>          </span><span class="annot"><span class="annottext">BenchmarkOn (BenchPhase (TCMT IO)) -&gt; TCM ()
forall (m :: * -&gt; *).
MonadBench m =&gt;
BenchmarkOn (BenchPhase m) -&gt; m ()
</span><a href="Agda.Utils.Benchmark.html#setBenchmarking"><span class="hs-identifier hs-var">UtilsBench.setBenchmarking</span></a></span><span> </span><span class="annot"><span class="annottext">BenchmarkOn (BenchPhase (TCMT IO))
BenchmarkOn Phase
forall a. BenchmarkOn a
</span><a href="Agda.Utils.Benchmark.html#BenchmarkOn"><span class="hs-identifier hs-var">UtilsBench.BenchmarkOn</span></a></span><span>
</span><span id="line-238"></span><span>            </span><span class="hs-comment">-- Andreas, Nisse, 2016-10-11 AIM XXIV</span><span>
</span><span id="line-239"></span><span>            </span><span class="hs-comment">-- Turn benchmarking on provisionally, otherwise we lose track of time spent</span><span>
</span><span id="line-240"></span><span>            </span><span class="hs-comment">-- on e.g. LaTeX-code generation.</span><span>
</span><span id="line-241"></span><span>            </span><span class="hs-comment">-- Benchmarking might be turned off later by setCommandlineOptions</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span>          </span><span class="annot"><span class="annottext">Account (BenchPhase (TCMT IO)) -&gt; TCMT IO a -&gt; TCMT IO a
forall (m :: * -&gt; *) c.
MonadBench m =&gt;
Account (BenchPhase m) -&gt; m c -&gt; m c
</span><a href="Agda.Utils.Benchmark.html#billTo"><span class="hs-identifier hs-var">Bench.billTo</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(TCMT IO a -&gt; TCMT IO a) -&gt; TCMT IO a -&gt; TCMT IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-244"></span><span>            </span><span class="annot"><span class="annottext">Interactor a
</span><a href="#local-6989586621682033912"><span class="hs-identifier hs-var">interactor</span></a></span><span> </span><span class="annot"><span class="annottext">TCM ()
</span><a href="#local-6989586621682033918"><span class="hs-identifier hs-var">initialSetup</span></a></span><span> </span><span class="annot"><span class="annottext">AbsolutePath -&gt; TCM CheckResult
</span><a href="#local-6989586621682033919"><span class="hs-identifier hs-var">checkFile</span></a></span><span>
</span><span id="line-245"></span><span>          </span><span class="annot"><span class="annottext">TCMT IO a -&gt; TCM () -&gt; TCMT IO a
forall a b. TCM a -&gt; TCM b -&gt; TCM a
</span><a href="Agda.TypeChecking.Monad.Base.html#finally_"><span class="hs-operator hs-var">`finally_`</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-246"></span><span>            </span><span class="hs-comment">-- Print benchmarks.</span><span>
</span><span id="line-247"></span><span>            </span><span class="annot"><span class="annottext">TCM ()
forall (tcm :: * -&gt; *). MonadTCM tcm =&gt; tcm ()
</span><a href="Agda.TypeChecking.Monad.Benchmark.html#print"><span class="hs-identifier hs-var">Bench.print</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span>            </span><span class="hs-comment">-- Print accumulated statistics.</span><span>
</span><span id="line-250"></span><span>            </span><span class="annot"><span class="annottext">Maybe TopLevelModuleName -&gt; Statistics -&gt; TCM ()
forall (m :: * -&gt; *).
(MonadDebug m, MonadTCEnv m, HasOptions m) =&gt;
Maybe TopLevelModuleName -&gt; Statistics -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Statistics.html#printStatistics"><span class="hs-identifier hs-var">printStatistics</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TopLevelModuleName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">(Statistics -&gt; TCM ()) -&gt; TCMT IO Statistics -&gt; TCM ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' TCState Statistics -&gt; TCMT IO Statistics
forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' TCState a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#useTC"><span class="hs-identifier hs-var">useTC</span></a></span><span> </span><span class="annot"><span class="annottext">(Statistics -&gt; f Statistics) -&gt; TCState -&gt; f TCState
Lens' TCState Statistics
</span><a href="Agda.TypeChecking.Monad.State.html#lensAccumStatistics"><span class="hs-identifier hs-var">lensAccumStatistics</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-comment">-- Options are fleshed out here so that (most) errors like</span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-comment">-- &quot;bad library path&quot; are validated within the interactor,</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-comment">-- so that they are reported with the appropriate protocol/formatting.</span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><a href="#local-6989586621682033918"><span class="hs-identifier hs-type">initialSetup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>    </span><span id="local-6989586621682033918"><span class="annot"><span class="annottext">initialSetup :: TCM ()
</span><a href="#local-6989586621682033918"><span class="hs-identifier hs-var hs-var">initialSetup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-257"></span><span>      </span><span id="local-6989586621682033928"><span class="annot"><a href="#local-6989586621682033928"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; TCM CommandLineOptions
</span><a href="Agda.TypeChecking.Monad.Options.html#addTrustedExecutables"><span class="hs-identifier hs-var">addTrustedExecutables</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682033914"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-258"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Options.html#setCommandLineOptions"><span class="hs-identifier hs-type">setCommandLineOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682033928"><span class="hs-identifier hs-type">opts</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><a href="#local-6989586621682033919"><span class="hs-identifier hs-type">checkFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html#AbsolutePath"><span class="hs-identifier hs-type">AbsolutePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Interaction.Imports.html#CheckResult"><span class="hs-identifier hs-type">CheckResult</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span id="local-6989586621682033919"><span class="annot"><span class="annottext">checkFile :: AbsolutePath -&gt; TCM CheckResult
</span><a href="#local-6989586621682033919"><span class="hs-identifier hs-var hs-var">checkFile</span></a></span></span><span> </span><span id="local-6989586621682033931"><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621682033931"><span class="hs-identifier hs-var">inputFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-262"></span><span>        </span><span class="hs-comment">-- Andreas, 2013-10-30 The following 'resetState' kills the</span><span>
</span><span id="line-263"></span><span>        </span><span class="hs-comment">-- verbosity options.  That does not make sense (see fail/Issue641).</span><span>
</span><span id="line-264"></span><span>        </span><span class="hs-comment">-- 'resetState' here does not seem to serve any purpose,</span><span>
</span><span id="line-265"></span><span>        </span><span class="hs-comment">-- thus, I am removing it.</span><span>
</span><span id="line-266"></span><span>        </span><span class="hs-comment">-- resetState</span><span>
</span><span id="line-267"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682033932"><span class="annot"><span class="annottext">mode :: Mode
</span><a href="#local-6989586621682033932"><span class="hs-identifier hs-var hs-var hs-var">mode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Types.html#optOnlyScopeChecking"><span class="hs-identifier hs-var">optOnlyScopeChecking</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621682033914"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-268"></span><span>                     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Agda.Interaction.Imports.html#ScopeCheck"><span class="hs-identifier hs-var">Imp.ScopeCheck</span></a></span><span>
</span><span id="line-269"></span><span>                     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Agda.Interaction.Imports.html#TypeCheck"><span class="hs-identifier hs-var">Imp.TypeCheck</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span>          </span><span id="local-6989586621682033935"><span class="annot"><a href="#local-6989586621682033935"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AbsolutePath -&gt; TCMT IO SourceFile
forall (m :: * -&gt; *). MonadFileId m =&gt; AbsolutePath -&gt; m SourceFile
</span><a href="Agda.TypeChecking.Monad.Base.html#srcFromPath"><span class="hs-identifier hs-var">srcFromPath</span></a></span><span> </span><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621682033931"><span class="hs-identifier hs-var">inputFile</span></a></span><span>
</span><span id="line-272"></span><span>          </span><span id="local-6989586621682033937"><span class="annot"><a href="#local-6989586621682033937"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Interaction.Imports.html#typeCheckMain"><span class="hs-identifier hs-type">Imp.typeCheckMain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682033932"><span class="hs-identifier hs-type">mode</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="Agda.Interaction.Imports.html#parseSource"><span class="hs-identifier hs-type">Imp.parseSource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682033935"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span>          </span><span class="annot"><a href="Agda.Utils.Monad.html#unless"><span class="hs-identifier hs-type">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.Imports.html#crMode"><span class="hs-identifier hs-var">crMode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682033937"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ModuleScopeChecked"><span class="hs-identifier hs-type">ModuleScopeChecked</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-275"></span><span>            </span><span class="annot"><a href="Agda.Interaction.Imports.html#raiseNonFatalErrors"><span class="hs-identifier hs-type">Imp.raiseNonFatalErrors</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682033937"><span class="hs-identifier hs-type">result</span></a></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682033943"><span class="annot"><a href="#local-6989586621682033943"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; Interface
</span><a href="Agda.Interaction.Imports.html#crInterface"><span class="hs-identifier hs-var">crInterface</span></a></span><span> </span><span class="annot"><span class="annottext">CheckResult
</span><a href="#local-6989586621682033937"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-278"></span><span>          </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-type">reportSDoc</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;main&quot;</span></span><span> </span><span class="annot"><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682033943"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span>          </span><span class="hs-comment">-- Print accumulated warnings</span><span>
</span><span id="line-281"></span><span>          </span><span class="annot"><a href="Agda.Utils.Null.html#unlessNullM"><span class="hs-identifier hs-type">unlessNullM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#tcWarnings"><span class="hs-identifier hs-var">tcWarnings</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Warnings.html#classifyWarnings"><span class="hs-identifier hs-type">classifyWarnings</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.toAscList</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.Warning.html#getAllWarnings"><span class="hs-identifier hs-type">getAllWarnings</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Warnings.html#AllWarnings"><span class="hs-identifier hs-type">AllWarnings</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682033953"><span class="annot"><span class="annottext">Set TCWarning
</span><a href="#local-6989586621682033953"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-282"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682033958"><span class="annot"><span class="annottext">banner :: TCMT IO Doc
</span><a href="#local-6989586621682033958"><span class="hs-identifier hs-var hs-var">banner</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; [Char] -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; TCMT IO Doc) -&gt; [Char] -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><a href="Agda.Utils.String.html#delimiter"><span class="hs-identifier hs-var">delimiter</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;All done; warnings encountered&quot;</span></span><span>
</span><span id="line-283"></span><span>            </span><span class="annot"><span class="annottext">[Char] -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#alwaysReportSDoc"><span class="hs-identifier hs-var">alwaysReportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;warning&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-284"></span><span>              </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vsep"><span class="hs-identifier hs-var">vsep</span></a></span><span> </span><span class="annot"><span class="annottext">([TCMT IO Doc] -&gt; TCMT IO Doc) -&gt; [TCMT IO Doc] -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCMT IO Doc
</span><a href="#local-6989586621682033958"><span class="hs-identifier hs-var">banner</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; [TCMT IO Doc] -&gt; [TCMT IO Doc]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([TCMT IO Doc] -&gt; [TCMT IO Doc]) -&gt; [TCMT IO Doc] -&gt; [TCMT IO Doc]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(TCWarning -&gt; TCMT IO Doc) -&gt; [TCWarning] -&gt; [TCMT IO Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TCWarning -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; TCWarning -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">([TCWarning] -&gt; [TCMT IO Doc]) -&gt; [TCWarning] -&gt; [TCMT IO Doc]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set TCWarning -&gt; [TCWarning]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toAscList</span></span><span> </span><span class="annot"><span class="annottext">Set TCWarning
</span><a href="#local-6989586621682033953"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682033937"><span class="hs-identifier hs-type">result</span></a></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="annot"><span class="hs-comment">-- | Print usage information.</span></span><span>
</span><span id="line-291"></span><span class="annot"><a href="Agda.Main.html#printUsage"><span class="hs-identifier hs-type">printUsage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Help.html#Help"><span class="hs-identifier hs-type">Help</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span id="printUsage"><span class="annot"><span class="annottext">printUsage :: [Backend] -&gt; Help -&gt; IO ()
</span><a href="Agda.Main.html#printUsage"><span class="hs-identifier hs-var hs-var">printUsage</span></a></span></span><span> </span><span id="local-6989586621682033964"><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621682033964"><span class="hs-identifier hs-var">backends</span></a></span></span><span> </span><span id="local-6989586621682033965"><span class="annot"><span class="annottext">Help
</span><a href="#local-6989586621682033965"><span class="hs-identifier hs-var">hp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-293"></span><span>  </span><span id="local-6989586621682033966"><span class="annot"><a href="#local-6989586621682033966"><span class="hs-identifier hs-var">progName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Char]
</span><span class="hs-identifier hs-var">getProgName</span></span><span>
</span><span id="line-294"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">putStr</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Base.html#usage"><span class="hs-identifier hs-type">usage</span></a></span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Base.html#standardOptions_"><span class="hs-identifier hs-type">standardOptions_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682033966"><span class="hs-identifier hs-type">progName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682033965"><span class="hs-identifier hs-type">hp</span></a></span><span>
</span><span id="line-295"></span><span>  </span><span class="annot"><a href="Agda.Utils.Monad.html#when"><span class="hs-identifier hs-type">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682033965"><span class="hs-identifier hs-type">hp</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Help.html#GeneralHelp"><span class="hs-identifier hs-type">GeneralHelp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">putStr</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Agda.Main.html#backendUsage"><span class="hs-identifier hs-type">backendUsage</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682033964"><span class="hs-identifier hs-type">backends</span></a></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="annot"><a href="Agda.Main.html#backendUsage"><span class="hs-identifier hs-type">backendUsage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-298"></span><span id="backendUsage"><span class="annot"><span class="annottext">backendUsage :: Backend -&gt; [Char]
</span><a href="Agda.Main.html#backendUsage"><span class="hs-identifier hs-var hs-var">backendUsage</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.Backend.Base.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span id="local-6989586621682033976"><span class="annot"><span class="annottext">Backend'_boot Definition (TCMT IO) opts env menv mod def
</span><a href="#local-6989586621682033976"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-299"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; [OptDescr ()] -&gt; [Char]
forall a. [Char] -&gt; [OptDescr a] -&gt; [Char]
</span><span class="hs-identifier hs-var">usageInfo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Backend'_boot Definition (TCMT IO) opts env menv mod def -&gt; Text
forall definition (tcm :: * -&gt; *) opts env menv mod def.
Backend'_boot definition tcm opts env menv mod def -&gt; Text
</span><a href="Agda.Compiler.Backend.Base.html#backendName"><span class="hs-identifier hs-var">backendName</span></a></span><span> </span><span class="annot"><span class="annottext">Backend'_boot Definition (TCMT IO) opts env menv mod def
</span><a href="#local-6989586621682033976"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; backend options&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([OptDescr ()] -&gt; [Char]) -&gt; [OptDescr ()] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><span class="annottext">(OptDescr (Flag opts) -&gt; OptDescr ())
-&gt; [OptDescr (Flag opts)] -&gt; [OptDescr ()]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">OptDescr (Flag opts) -&gt; OptDescr ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Backend'_boot Definition (TCMT IO) opts env menv mod def
-&gt; [OptDescr (Flag opts)]
forall definition (tcm :: * -&gt; *) opts env menv mod def.
Backend'_boot definition tcm opts env menv mod def
-&gt; [OptDescr (Flag opts)]
</span><a href="Agda.Compiler.Backend.Base.html#commandLineFlags"><span class="hs-identifier hs-var">commandLineFlags</span></a></span><span> </span><span class="annot"><span class="annottext">Backend'_boot Definition (TCMT IO) opts env menv mod def
</span><a href="#local-6989586621682033976"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="annot"><span class="hs-comment">-- | Print version information.</span></span><span>
</span><span id="line-303"></span><span class="annot"><a href="Agda.Main.html#printVersion"><span class="hs-identifier hs-type">printVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Types.html#PrintAgdaVersion"><span class="hs-identifier hs-type">PrintAgdaVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span id="printVersion"><span class="annot"><span class="annottext">printVersion :: [Backend] -&gt; PrintAgdaVersion -&gt; IO ()
</span><a href="Agda.Main.html#printVersion"><span class="hs-identifier hs-var hs-var">printVersion</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PrintAgdaVersion
</span><a href="Agda.Interaction.Options.Types.html#PrintAgdaNumericVersion"><span class="hs-identifier hs-var">PrintAgdaNumericVersion</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="Agda.VersionCommit.html#versionWithCommitInfo"><span class="hs-identifier hs-var">versionWithCommitInfo</span></a></span><span>
</span><span id="line-305"></span><span class="annot"><a href="Agda.Main.html#printVersion"><span class="hs-identifier hs-var">printVersion</span></a></span><span> </span><span id="local-6989586621682033982"><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621682033982"><span class="hs-identifier hs-var">backends</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrintAgdaVersion
</span><a href="Agda.Interaction.Options.Types.html#PrintAgdaVersion"><span class="hs-identifier hs-var">PrintAgdaVersion</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-306"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Agda version &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="Agda.VersionCommit.html#versionWithCommitInfo"><span class="hs-identifier hs-var">versionWithCommitInfo</span></a></span><span>
</span><span id="line-307"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall b (m :: * -&gt; *). (IsBool b, Monad m) =&gt; b -&gt; m () -&gt; m ()
</span><a href="Agda.Utils.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Char]] -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621682033984"><span class="hs-identifier hs-var">flags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [[Char]] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; IO ()) -&gt; [[Char]] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Built with flags (cabal -f)&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [[Char]]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; [[Char]]) -&gt; [[Char]] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; [[Char]] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><a href="#local-6989586621682033985"><span class="hs-identifier hs-var">bullet</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621682033984"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-309"></span><span>  </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [[Char]] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><a href="#local-6989586621682033985"><span class="hs-identifier hs-var">bullet</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; [Char] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; [Char]) -&gt; Text -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.unwords</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682033987"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;backend version&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682033989"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.Base.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.Base.html#Backend%27"><span class="hs-identifier hs-type">Backend'</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">backendName :: forall definition (tcm :: * -&gt; *) opts env menv mod def.
Backend'_boot definition tcm opts env menv mod def -&gt; Text
</span><a href="Agda.Compiler.Backend.Base.html#backendName"><span class="hs-identifier hs-var">backendName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682033987"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682033987"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">backendVersion :: forall definition (tcm :: * -&gt; *) opts env menv mod def.
Backend'_boot definition tcm opts env menv mod def -&gt; Maybe Text
</span><a href="Agda.Compiler.Backend.Base.html#backendVersion"><span class="hs-identifier hs-var">backendVersion</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682033989"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682033989"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621682033982"><span class="hs-identifier hs-var">backends</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-313"></span><span>  </span><span id="local-6989586621682033985"><span class="annot"><span class="annottext">bullet :: [Char] -&gt; [Char]
</span><a href="#local-6989586621682033985"><span class="hs-identifier hs-var hs-var">bullet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; - &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-comment">-- Print cabal flags that were involved in compilation.</span><span>
</span><span id="line-315"></span><span>  </span><span id="local-6989586621682033984"><span class="annot"><span class="annottext">flags :: [[Char]]
</span><a href="#local-6989586621682033984"><span class="hs-identifier hs-var hs-var">flags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#ifdef COUNT_CLUSTERS
</span><span>    </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;enable-cluster-counting: unicode cluster counting in LaTeX backend using the ICU library&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [[Char]]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#ifdef OPTIMISE_HEAVILY
</span><span>    </span><span class="hs-string">&quot;optimise-heavily: extra optimisations&quot;</span><span> </span><span class="hs-glyph">:</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#ifdef DEBUG
</span><span>    </span><span class="hs-string">&quot;debug: enable debug printing ('-v' verbosity flags)&quot;</span><span> </span><span class="hs-glyph">:</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#ifdef DEBUG_PARSING
</span><span>    </span><span class="hs-string">&quot;debug-parsing: enable printing grammars for operator parsing via '-v scope.grammar:10'&quot;</span><span> </span><span class="hs-glyph">:</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#ifdef DEBUG_SERIALISATION
</span><span>    </span><span class="hs-string">&quot;debug-serialisation: extra debug info during serialisation into '.agdai' files&quot;</span><span> </span><span class="hs-glyph">:</span><span class="hs-cpp">
#endif
</span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="annot"><a href="Agda.Main.html#printAgdaDataDir"><span class="hs-identifier hs-type">printAgdaDataDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span id="printAgdaDataDir"><span class="annot"><span class="annottext">printAgdaDataDir :: IO ()
</span><a href="Agda.Main.html#printAgdaDataDir"><span class="hs-identifier hs-var hs-var">printAgdaDataDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; IO [Char] -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">IO [Char]
</span><a href="Paths_Agda.html#getDataDir"><span class="hs-identifier hs-var">getDataDir</span></a></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="annot"><a href="Agda.Main.html#printAgdaAppDir"><span class="hs-identifier hs-type">printAgdaAppDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span id="printAgdaAppDir"><span class="annot"><span class="annottext">printAgdaAppDir :: IO ()
</span><a href="Agda.Main.html#printAgdaAppDir"><span class="hs-identifier hs-var hs-var">printAgdaAppDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; IO [Char] -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">IO [Char]
</span><a href="Agda.Interaction.Library.html#getAgdaAppDir"><span class="hs-identifier hs-var">getAgdaAppDir</span></a></span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="annot"><span class="hs-comment">-- | What to do for bad options.</span></span><span>
</span><span id="line-340"></span><span class="annot"><a href="Agda.Main.html#optionError"><span class="hs-identifier hs-type">optionError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span id="optionError"><span class="annot"><span class="annottext">optionError :: [Char] -&gt; IO ()
</span><a href="Agda.Main.html#optionError"><span class="hs-identifier hs-var hs-var">optionError</span></a></span></span><span> </span><span id="local-6989586621682033997"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682033997"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-342"></span><span>  </span><span id="local-6989586621682033998"><span class="annot"><a href="#local-6989586621682033998"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Char]
</span><span class="hs-identifier hs-var">getProgName</span></span><span>
</span><span id="line-343"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">putStrLn</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Error: &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621682033997"><span class="hs-identifier hs-type">err</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\nRun '&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621682033998"><span class="hs-identifier hs-type">prog</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; --help' for help on command line options.&quot;</span></span><span>
</span><span id="line-344"></span><span>  </span><span class="annot"><a href="Agda.Interaction.ExitCode.html#exitAgdaWith"><span class="hs-identifier hs-type">exitAgdaWith</span></a></span><span> </span><span class="annot"><a href="Agda.Interaction.ExitCode.html#OptionError"><span class="hs-identifier hs-type">ExitCode.OptionError</span></a></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="annot"><span class="hs-comment">-- | Run a TCM action in IO; catch and pretty print errors.</span></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="hs-comment">-- If some error message cannot be printed due to locale issues, then</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- one may get the &quot;Error when handling error&quot; error message. There is</span><span>
</span><span id="line-350"></span><span class="hs-comment">-- currently no test case for this error, but on some systems one can</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- (at the time of writing) trigger it by running @LC_CTYPE=C agda</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- --no-libraries Bug.agda@, where @Bug.agda@ contains the following</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- code (if there is some other file in the same directory, for</span><span>
</span><span id="line-354"></span><span class="hs-comment">-- instance @Bug.lagda@, then the error message may be different):</span><span>
</span><span id="line-355"></span><span class="hs-comment">--</span><span>
</span><span id="line-356"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-357"></span><span class="hs-comment">-- _ : Set</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- _ = Set</span><span>
</span><span id="line-359"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="annot"><a href="Agda.Main.html#runTCMPrettyErrors"><span class="hs-identifier hs-type">runTCMPrettyErrors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span id="runTCMPrettyErrors"><span class="annot"><span class="annottext">runTCMPrettyErrors :: TCM () -&gt; IO ()
</span><a href="Agda.Main.html#runTCMPrettyErrors"><span class="hs-identifier hs-var hs-var">runTCMPrettyErrors</span></a></span></span><span> </span><span id="local-6989586621682034000"><span class="annot"><span class="annottext">TCM ()
</span><a href="#local-6989586621682034000"><span class="hs-identifier hs-var">tcm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-363"></span><span>  </span><span id="local-6989586621682034001"><span class="annot"><a href="#local-6989586621682034001"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM (Maybe AgdaError) -&gt; IO (Either TCErr (Maybe AgdaError))
forall a. TCM a -&gt; IO (Either TCErr a)
</span><a href="Agda.TypeChecking.Monad.Base.html#runTCMTop"><span class="hs-identifier hs-var">runTCMTop</span></a></span><span>
</span><span id="line-364"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe AgdaError
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe AgdaError -&gt; TCM () -&gt; TCM (Maybe AgdaError)
forall a b. a -&gt; TCMT IO b -&gt; TCMT IO a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">TCM ()
</span><a href="#local-6989586621682034000"><span class="hs-identifier hs-var">tcm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>          </span><span class="annot"><span class="annottext">TCM (Maybe AgdaError)
-&gt; (TCErr -&gt; TCM (Maybe AgdaError)) -&gt; TCM (Maybe AgdaError)
forall a. TCMT IO a -&gt; (TCErr -&gt; TCMT IO a) -&gt; TCMT IO a
forall e (m :: * -&gt; *) a.
MonadError e m =&gt;
m a -&gt; (e -&gt; m a) -&gt; m a
</span><span class="hs-operator hs-var">`catchError`</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682034005"><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621682034005"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-366"></span><span>            </span><span id="local-6989586621682034006"><span class="annot"><a href="#local-6989586621682034006"><span class="hs-identifier hs-var">s2s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set TCWarning -&gt; TCM [Doc]
</span><a href="Agda.TypeChecking.Pretty.Warning.html#prettyTCWarnings%27"><span class="hs-identifier hs-var">prettyTCWarnings'</span></a></span><span> </span><span class="annot"><span class="annottext">(Set TCWarning -&gt; TCM [Doc])
-&gt; TCMT IO (Set TCWarning) -&gt; TCM [Doc]
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">TCErr -&gt; TCMT IO (Set TCWarning)
</span><a href="Agda.TypeChecking.Pretty.Warning.html#getAllWarningsOfTCErr"><span class="hs-identifier hs-var">getAllWarningsOfTCErr</span></a></span><span> </span><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621682034005"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-367"></span><span>            </span><span id="local-6989586621682034009"><span class="annot"><a href="#local-6989586621682034009"><span class="hs-identifier hs-var">s1</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Errors.html#prettyError"><span class="hs-identifier hs-type">prettyError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682034005"><span class="hs-identifier hs-type">err</span></a></span><span>
</span><span id="line-368"></span><span>            </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.ANSI.html#putDoc"><span class="hs-identifier hs-type">ANSI.putDoc</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#vsep"><span class="hs-identifier hs-type">P.vsep</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682034006"><span class="hs-identifier hs-type">s2s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="#local-6989586621682034009"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-369"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">liftIO</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-370"></span><span>              </span><span class="annot"><a href="Agda.Main.html#helpForLocaleError"><span class="hs-identifier hs-type">helpForLocaleError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682034005"><span class="hs-identifier hs-type">err</span></a></span><span>
</span><span id="line-371"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Agda.Interaction.ExitCode.html#TCMError"><span class="hs-identifier hs-type">TCMError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>      </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCM (Maybe AgdaError)
-&gt; (Impossible -&gt; TCM (Maybe AgdaError)) -&gt; TCM (Maybe AgdaError)
forall a. TCMT IO a -&gt; (Impossible -&gt; TCMT IO a) -&gt; TCMT IO a
forall (m :: * -&gt; *) a.
CatchImpossible m =&gt;
m a -&gt; (Impossible -&gt; m a) -&gt; m a
</span><a href="Agda.Utils.Impossible.html#catchImpossible"><span class="hs-operator hs-var">`catchImpossible`</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682034016"><span class="annot"><span class="annottext">Impossible
</span><a href="#local-6989586621682034016"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-373"></span><span>          </span><span class="annot"><span class="annottext">Impossible -&gt; TCM ()
forall {m :: * -&gt; *} {e}. (MonadIO m, Exception e) =&gt; e -&gt; m ()
</span><a href="#local-6989586621682034017"><span class="hs-identifier hs-var">printException</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible
</span><a href="#local-6989586621682034016"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-374"></span><span>          </span><span class="annot"><span class="annottext">Maybe AgdaError -&gt; TCM (Maybe AgdaError)
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AgdaError -&gt; Maybe AgdaError
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">AgdaError
</span><a href="Agda.Interaction.ExitCode.html#ImpossibleError"><span class="hs-identifier hs-var">ImpossibleError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO (Either TCErr (Maybe AgdaError))
-&gt; [Handler (Either TCErr (Maybe AgdaError))]
-&gt; IO (Either TCErr (Maybe AgdaError))
forall a. IO a -&gt; [Handler a] -&gt; IO a
</span><span class="hs-operator hs-var">`E.catches`</span></span><span>
</span><span id="line-376"></span><span>        </span><span class="hs-comment">-- Catch all exceptions except for those of type ExitCode</span><span>
</span><span id="line-377"></span><span>        </span><span class="hs-comment">-- (which are thrown by exitWith) and asynchronous exceptions</span><span>
</span><span id="line-378"></span><span>        </span><span class="hs-comment">-- (which are for instance raised when Ctrl-C is used, or if</span><span>
</span><span id="line-379"></span><span>        </span><span class="hs-comment">-- the program runs out of heap or stack space).</span><span>
</span><span id="line-380"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(ExitCode -&gt; IO (Either TCErr (Maybe AgdaError)))
-&gt; Handler (Either TCErr (Maybe AgdaError))
forall a e. Exception e =&gt; (e -&gt; IO a) -&gt; Handler a
</span><span class="hs-identifier hs-var">E.Handler</span></span><span> </span><span class="annot"><span class="annottext">((ExitCode -&gt; IO (Either TCErr (Maybe AgdaError)))
 -&gt; Handler (Either TCErr (Maybe AgdaError)))
-&gt; (ExitCode -&gt; IO (Either TCErr (Maybe AgdaError)))
-&gt; Handler (Either TCErr (Maybe AgdaError))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621682034021"><span class="annot"><span class="annottext">ExitCode
</span><a href="#local-6989586621682034021"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExitCode</span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExitCode -&gt; IO (Either TCErr (Maybe AgdaError))
forall a e. (?callStack::CallStack, Exception e) =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">E.throw</span></span><span> </span><span class="annot"><span class="annottext">ExitCode
</span><a href="#local-6989586621682034021"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-381"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(AsyncException -&gt; IO (Either TCErr (Maybe AgdaError)))
-&gt; Handler (Either TCErr (Maybe AgdaError))
forall a e. Exception e =&gt; (e -&gt; IO a) -&gt; Handler a
</span><span class="hs-identifier hs-var">E.Handler</span></span><span> </span><span class="annot"><span class="annottext">((AsyncException -&gt; IO (Either TCErr (Maybe AgdaError)))
 -&gt; Handler (Either TCErr (Maybe AgdaError)))
-&gt; (AsyncException -&gt; IO (Either TCErr (Maybe AgdaError)))
-&gt; Handler (Either TCErr (Maybe AgdaError))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621682034023"><span class="annot"><span class="annottext">AsyncException
</span><a href="#local-6989586621682034023"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">E.AsyncException</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AsyncException -&gt; IO (Either TCErr (Maybe AgdaError))
forall a e. (?callStack::CallStack, Exception e) =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">E.throw</span></span><span> </span><span class="annot"><span class="annottext">AsyncException
</span><a href="#local-6989586621682034023"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-382"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(SomeException -&gt; IO (Either TCErr (Maybe AgdaError)))
-&gt; Handler (Either TCErr (Maybe AgdaError))
forall a e. Exception e =&gt; (e -&gt; IO a) -&gt; Handler a
</span><span class="hs-identifier hs-var">E.Handler</span></span><span> </span><span class="annot"><span class="annottext">((SomeException -&gt; IO (Either TCErr (Maybe AgdaError)))
 -&gt; Handler (Either TCErr (Maybe AgdaError)))
-&gt; (SomeException -&gt; IO (Either TCErr (Maybe AgdaError)))
-&gt; Handler (Either TCErr (Maybe AgdaError))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621682034024"><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621682034024"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">E.SomeException</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-383"></span><span>            </span><span class="annot"><span class="annottext">SomeException -&gt; IO ()
forall {m :: * -&gt; *} {e}. (MonadIO m, Exception e) =&gt; e -&gt; m ()
</span><a href="#local-6989586621682034017"><span class="hs-identifier hs-var">printException</span></a></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621682034024"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-384"></span><span>            </span><span class="annot"><span class="annottext">Either TCErr (Maybe AgdaError)
-&gt; IO (Either TCErr (Maybe AgdaError))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either TCErr (Maybe AgdaError)
 -&gt; IO (Either TCErr (Maybe AgdaError)))
-&gt; Either TCErr (Maybe AgdaError)
-&gt; IO (Either TCErr (Maybe AgdaError))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe AgdaError -&gt; Either TCErr (Maybe AgdaError)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AgdaError -&gt; Maybe AgdaError
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">AgdaError
</span><a href="Agda.Interaction.ExitCode.html#UnknownError"><span class="hs-identifier hs-var">UnknownError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-386"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682034001"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-387"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">Maybe AgdaError
</span><span class="hs-identifier hs-var">Nothing</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO ()
forall a. IO a
</span><span class="hs-identifier hs-var">exitSuccess</span></span><span>
</span><span id="line-388"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682034026"><span class="annot"><span class="annottext">AgdaError
</span><a href="#local-6989586621682034026"><span class="hs-identifier hs-var">reason</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AgdaError -&gt; IO ()
forall a. AgdaError -&gt; IO a
</span><a href="Agda.Interaction.ExitCode.html#exitAgdaWith"><span class="hs-identifier hs-var">exitAgdaWith</span></a></span><span> </span><span class="annot"><span class="annottext">AgdaError
</span><a href="#local-6989586621682034026"><span class="hs-identifier hs-var">reason</span></a></span><span>
</span><span id="line-389"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621682034027"><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621682034027"><span class="hs-identifier hs-var">err</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-390"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall a. IO a -&gt; IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-391"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n\nError when handling error:&quot;</span></span><span>
</span><span id="line-392"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCErr -&gt; [Char]
</span><a href="Agda.TypeChecking.Errors.html#tcErrString"><span class="hs-identifier hs-var">tcErrString</span></a></span><span> </span><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621682034027"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-393"></span><span>        </span><span class="annot"><span class="annottext">TCErr -&gt; IO ()
</span><a href="Agda.Main.html#helpForLocaleError"><span class="hs-identifier hs-var">helpForLocaleError</span></a></span><span> </span><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621682034027"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-394"></span><span>      </span><span class="annot"><span class="annottext">AgdaError -&gt; IO ()
forall a. AgdaError -&gt; IO a
</span><a href="Agda.Interaction.ExitCode.html#exitAgdaWith"><span class="hs-identifier hs-var">exitAgdaWith</span></a></span><span> </span><span class="annot"><span class="annottext">AgdaError
</span><a href="Agda.Interaction.ExitCode.html#UnknownError"><span class="hs-identifier hs-var">UnknownError</span></a></span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-396"></span><span>    </span><span id="local-6989586621682034017"><span class="annot"><span class="annottext">printException :: e -&gt; m ()
</span><a href="#local-6989586621682034017"><span class="hs-identifier hs-var hs-var">printException</span></a></span></span><span> </span><span id="local-6989586621682034046"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621682034046"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStr</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-397"></span><span>      </span><span class="hs-comment">-- Andreas, 2024-07-03, issue #7299</span><span>
</span><span id="line-398"></span><span>      </span><span class="hs-comment">-- Regression in base-4.20: printing of exception produces trailing whitespace.</span><span>
</span><span id="line-399"></span><span>      </span><span class="hs-comment">-- https://gitlab.haskell.org/ghc/ghc/-/issues/25052</span><span class="hs-cpp">
#if MIN_VERSION_base(4,20,0)
</span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><a href="Agda.Utils.String.html#rtrim"><span class="hs-identifier hs-var">rtrim</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; [Char] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span class="hs-cpp">
#endif
</span><span>      </span><span class="annot"><span class="annottext">e -&gt; [Char]
forall e. Exception e =&gt; e -&gt; [Char]
</span><span class="hs-identifier hs-var">E.displayException</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621682034046"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="hs-comment">-- | If the error is an IO error, and the error message suggests that</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- the problem is related to locales or code pages, print out some</span><span>
</span><span id="line-407"></span><span class="hs-comment">-- extra information.</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="annot"><a href="Agda.Main.html#helpForLocaleError"><span class="hs-identifier hs-type">helpForLocaleError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCErr"><span class="hs-identifier hs-type">TCErr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span id="helpForLocaleError"><span class="annot"><span class="annottext">helpForLocaleError :: TCErr -&gt; IO ()
</span><a href="Agda.Main.html#helpForLocaleError"><span class="hs-identifier hs-var hs-var">helpForLocaleError</span></a></span></span><span> </span><span id="local-6989586621682034049"><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621682034049"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621682034049"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-411"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#IOException"><span class="hs-identifier hs-type">IOException</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TCState
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682034051"><span class="annot"><span class="annottext">IOException
</span><a href="#local-6989586621682034051"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;invalid argument&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`List.isInfixOf`</span></span><span> </span><span class="annot"><span class="annottext">IOException -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">IOException
</span><a href="#local-6989586621682034051"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621682034053"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-413"></span><span>  </span><span class="annot"><span class="annottext">TCErr
</span><span class="hs-identifier">_</span></span><span>                                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-415"></span><span>  </span><span id="local-6989586621682034053"><span class="annot"><span class="annottext">msg :: IO ()
</span><a href="#local-6989586621682034053"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStr</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
</span><span class="hs-identifier hs-var">unlines</span></span><span>
</span><span id="line-416"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-417"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;This error may be due to the use of a locale or code page that does not&quot;</span></span><span>
</span><span id="line-418"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;support some character used in the program being type-checked.&quot;</span></span><span>
</span><span id="line-419"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-420"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;If it is, then one option is to use the option --transliterate, in which&quot;</span></span><span>
</span><span id="line-421"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;case unsupported characters are (hopefully) replaced with something else,&quot;</span></span><span>
</span><span id="line-422"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;perhaps question marks. However, that could make the output harder to&quot;</span></span><span>
</span><span id="line-423"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;read.&quot;</span></span><span>
</span><span id="line-424"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-425"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;If you want to fix the problem \&quot;properly\&quot;, then you could try one of the&quot;</span></span><span>
</span><span id="line-426"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;following suggestions:&quot;</span></span><span>
</span><span id="line-427"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-428"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;* If you are using Windows, try switching to a different code page (for&quot;</span></span><span>
</span><span id="line-429"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  instance by running the command 'CHCP 65001').&quot;</span></span><span>
</span><span id="line-430"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-431"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;* If you are using a Unix-like system, try using a different locale. The&quot;</span></span><span>
</span><span id="line-432"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  installed locales are perhaps printed by the command 'locale -a'. If&quot;</span></span><span>
</span><span id="line-433"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  you have a UTF-8 locale installed (for instance sv_SE.UTF-8), then you&quot;</span></span><span>
</span><span id="line-434"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  can perhaps make Agda use this locale by running something like&quot;</span></span><span>
</span><span id="line-435"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  'LC_ALL=sv_SE.UTF-8 agda &lt;...&gt;'.&quot;</span></span><span>
</span><span id="line-436"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-437"></span></pre></body></html>