<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="annot"><span class="hs-comment">-- | Utility functions used in the Happy parser.</span></span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html"><span class="hs-identifier">Agda.Syntax.Parser.Helpers</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">null</span></span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">modify'</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;&gt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sconcat</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html"><span class="hs-identifier">Agda.Syntax.Position</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html"><span class="hs-identifier">Agda.Syntax.Parser.Monad</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Lexer.html"><span class="hs-identifier">Agda.Syntax.Parser.Lexer</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html"><span class="hs-identifier">Agda.Syntax.Parser.Tokens</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html"><span class="hs-identifier">Agda.Syntax.Concrete</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Attribute.html"><span class="hs-identifier">Agda.Syntax.Concrete.Attribute</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CA</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Pattern.html"><span class="hs-identifier">Agda.Syntax.Concrete.Pattern</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html"><span class="hs-identifier">Agda.Syntax.Common</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Notation.html"><span class="hs-identifier">Agda.Syntax.Notation</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Literal.html"><span class="hs-identifier">Agda.Syntax.Literal</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Positivity.Occurrence.html"><span class="hs-identifier">Agda.TypeChecking.Positivity.Occurrence</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Either.html"><span class="hs-identifier">Agda.Utils.Either</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Functor.html"><span class="hs-identifier">Agda.Utils.Functor</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Hash.html"><span class="hs-identifier">Agda.Utils.Hash</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List.html"><span class="hs-identifier">Agda.Utils.List</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Utils.List.html#spanJust"><span class="hs-identifier">spanJust</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.List.html#chopWhen"><span class="hs-identifier">chopWhen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.List.html#initLast"><span class="hs-identifier">initLast</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html"><span class="hs-identifier">Agda.Utils.List1</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier">List1</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><span class="hs-operator">(:|)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;|)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html"><span class="hs-identifier">Agda.Utils.Monad</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Null.html"><span class="hs-identifier">Agda.Utils.Null</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html"><span class="hs-identifier">Agda.Syntax.Common.Pretty</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Singleton.html"><span class="hs-identifier">Agda.Utils.Singleton</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.Maybe.Strict.html"><span class="hs-identifier">Agda.Utils.Maybe.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Strict</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html"><span class="hs-identifier">Agda.Utils.List1</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List1</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.List2.html"><span class="hs-identifier">Agda.Utils.List2</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List2</span></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="annot"><span class="hs-comment">-- | Grab leading OPTIONS pragmas.</span></span><span>
</span><span id="line-47"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#takeOptionsPragmas"><span class="hs-identifier hs-type">takeOptionsPragmas</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Declaration"><span class="hs-identifier hs-type">Declaration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span>
</span><span id="line-48"></span><span id="takeOptionsPragmas"><span class="annot"><span class="annottext">takeOptionsPragmas :: [Declaration] -&gt; Module
</span><a href="Agda.Syntax.Parser.Helpers.html#takeOptionsPragmas"><span class="hs-identifier hs-var hs-var">takeOptionsPragmas</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Pragma] -&gt; [Declaration] -&gt; Module)
-&gt; ([Pragma], [Declaration]) -&gt; Module
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">[Pragma] -&gt; [Declaration] -&gt; Module
</span><a href="Agda.Syntax.Concrete.html#Mod"><span class="hs-identifier hs-var">Mod</span></a></span><span> </span><span class="annot"><span class="annottext">(([Pragma], [Declaration]) -&gt; Module)
-&gt; ([Declaration] -&gt; ([Pragma], [Declaration]))
-&gt; [Declaration]
-&gt; Module
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Declaration -&gt; Maybe Pragma)
-&gt; [Declaration] -&gt; ([Pragma], [Declaration])
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; (Prefix b, [a])
</span><a href="Agda.Utils.List.html#spanJust"><span class="hs-identifier hs-var">spanJust</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681649994"><span class="annot"><span class="annottext">Declaration
</span><a href="#local-6989586621681649994"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Declaration
</span><a href="#local-6989586621681649994"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pragma"><span class="hs-identifier hs-type">Pragma</span></a></span><span> </span><span id="local-6989586621681649996"><span class="annot"><span class="annottext">p :: Pragma
</span><a href="#local-6989586621681649996"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Concrete.html#OptionsPragma"><span class="hs-identifier hs-type">OptionsPragma</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pragma -&gt; Maybe Pragma
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Pragma
</span><a href="#local-6989586621681649996"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><span class="annottext">Declaration
</span><span class="hs-identifier">_</span></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Pragma
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-comment">-- | Insert a top-level module if there is none.</span><span>
</span><span id="line-53"></span><span class="hs-comment">--   Also fix-up for the case the declarations in the top-level module</span><span>
</span><span id="line-54"></span><span class="hs-comment">--   are not indented (this is allowed as a special case).</span><span>
</span><span id="line-55"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#figureOutTopLevelModule"><span class="hs-identifier hs-type">figureOutTopLevelModule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Declaration"><span class="hs-identifier hs-type">Declaration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Declaration"><span class="hs-identifier hs-type">Declaration</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-56"></span><span id="figureOutTopLevelModule"><span class="annot"><span class="annottext">figureOutTopLevelModule :: [Declaration] -&gt; [Declaration]
</span><a href="Agda.Syntax.Parser.Helpers.html#figureOutTopLevelModule"><span class="hs-identifier hs-var hs-var">figureOutTopLevelModule</span></a></span></span><span> </span><span id="local-6989586621681649999"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621681649999"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Declaration] -&gt; ([Declaration], [Declaration])
</span><a href="Agda.Syntax.Concrete.html#spanAllowedBeforeModule"><span class="hs-identifier hs-var">spanAllowedBeforeModule</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621681649999"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-comment">-- Andreas 2016-02-01, issue #1388.</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-comment">-- We need to distinguish two additional cases.</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-comment">-- Case 1: Regular file layout: imports followed by one module. Nothing to do.</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681650001"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621681650001"><span class="hs-identifier hs-var">ds0</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621681649999"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-comment">-- Case 2: The declarations in the module are not indented.</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-comment">-- This is allowed for the top level module, and thus rectified here.</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681650003"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621681650003"><span class="hs-identifier hs-var">ds0</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span id="local-6989586621681650004"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650004"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681650005"><span class="annot"><span class="annottext">Erased
</span><a href="#local-6989586621681650005"><span class="hs-identifier hs-var">erased</span></a></span></span><span> </span><span id="local-6989586621681650006"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681650006"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681650007"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681650007"><span class="hs-identifier hs-var">tel</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681650008"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621681650008"><span class="hs-identifier hs-var">ds2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-67"></span><span>      </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621681650003"><span class="hs-identifier hs-var">ds0</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration] -&gt; [Declaration] -&gt; [Declaration]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Range
-&gt; Erased -&gt; QName -&gt; Telescope -&gt; [Declaration] -&gt; Declaration
</span><a href="Agda.Syntax.Concrete.html#Module"><span class="hs-identifier hs-var">Module</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650004"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Erased
</span><a href="#local-6989586621681650005"><span class="hs-identifier hs-var">erased</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681650006"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681650007"><span class="hs-identifier hs-var">tel</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621681650008"><span class="hs-identifier hs-var">ds2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-comment">-- Case 3: There is a module with indented declarations,</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-comment">-- followed by non-indented declarations.  This should be a</span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-comment">-- parse error and be reported later (see @toAbstract TopLevel{}@),</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-comment">-- thus, we do not do anything here.</span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681650009"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621681650009"><span class="hs-identifier hs-var">ds0</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span id="local-6989586621681650010"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650010"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">Erased
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681650011"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681650011"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681650012"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681650012"><span class="hs-identifier hs-var">tel</span></a></span></span><span> </span><span id="local-6989586621681650013"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621681650013"><span class="hs-identifier hs-var">ds1</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681650014"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621681650014"><span class="hs-identifier hs-var">ds2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621681649999"><span class="hs-identifier hs-var">ds</span></a></span><span>  </span><span class="hs-comment">-- Gives parse error in scope checker.</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-comment">-- OLD code causing issue 1388:</span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-comment">-- (ds0, Module r m tel ds1 : ds2) -&gt; ds0 ++ [Module r m tel $ ds1 ++ ds2]</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-comment">-- Case 4: a top-level module declaration is missing.</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-comment">-- Andreas, 2017-01-01, issue #2229:</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-comment">-- Put everything (except OPTIONS pragmas) into an anonymous module.</span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><span class="annottext">([Declaration], [Declaration])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621681650015"><span class="hs-identifier hs-var">ds0</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration] -&gt; [Declaration] -&gt; [Declaration]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Range
-&gt; Erased -&gt; QName -&gt; Telescope -&gt; [Declaration] -&gt; Declaration
</span><a href="Agda.Syntax.Concrete.html#Module"><span class="hs-identifier hs-var">Module</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650016"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Erased
</span><a href="Agda.Syntax.Common.html#defaultErased"><span class="hs-identifier hs-var">defaultErased</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-var">QName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#noName"><span class="hs-identifier hs-var">noName</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650016"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621681650020"><span class="hs-identifier hs-var">ds1</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-81"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-82"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681650015"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621681650015"><span class="hs-identifier hs-var">ds0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681650020"><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621681650020"><span class="hs-identifier hs-var">ds1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Declaration -&gt; Bool)
-&gt; [Declaration] -&gt; ([Declaration], [Declaration])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-operator hs-var">`span`</span></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621681649999"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Declaration -&gt; Bool) -&gt; ([Declaration], [Declaration]))
-&gt; (Declaration -&gt; Bool) -&gt; ([Declaration], [Declaration])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-83"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pragma"><span class="hs-identifier hs-type">Pragma</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#OptionsPragma"><span class="hs-identifier hs-type">OptionsPragma</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-84"></span><span>        </span><span class="annot"><span class="annottext">Declaration
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-85"></span><span>      </span><span class="hs-comment">-- Andreas, 2017-05-17, issue #2574.</span><span>
</span><span id="line-86"></span><span>      </span><span class="hs-comment">-- Since the module noName will act as jump target, it needs a range.</span><span>
</span><span id="line-87"></span><span>      </span><span class="hs-comment">-- We use the beginning of the file as beginning of the top level module.</span><span>
</span><span id="line-88"></span><span>      </span><span id="local-6989586621681650016"><span class="annot"><span class="annottext">r :: Range
</span><a href="#local-6989586621681650016"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Range
</span><a href="Agda.Syntax.Position.html#beginningOfFile"><span class="hs-identifier hs-var">beginningOfFile</span></a></span><span> </span><span class="annot"><span class="annottext">(Range -&gt; Range) -&gt; Range -&gt; Range
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Declaration] -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration]
</span><a href="#local-6989586621681650020"><span class="hs-identifier hs-var">ds1</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">-- | Create a name from a string. The boolean indicates whether a part</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- of the name can be token 'constructor'.</span><span>
</span><span id="line-92"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#mkName%27"><span class="hs-identifier hs-type">mkName'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#Interval"><span class="hs-identifier hs-type">Interval</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-93"></span><span id="mkName%27"><span class="annot"><span class="annottext">mkName' :: Bool -&gt; (Interval, [Char]) -&gt; Parser Name
</span><a href="Agda.Syntax.Parser.Helpers.html#mkName%27"><span class="hs-identifier hs-var hs-var">mkName'</span></a></span></span><span> </span><span id="local-6989586621681650025"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681650025"><span class="hs-identifier hs-var">constructor'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681650026"><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681650026"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681650027"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650027"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-95"></span><span>      </span><span id="local-6989586621681650028"><span class="annot"><span class="annottext">xs :: NameParts
</span><a href="#local-6989586621681650028"><span class="hs-identifier hs-var hs-var hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; NameParts
</span><a href="Agda.Syntax.Concrete.Name.html#stringNameParts"><span class="hs-identifier hs-var">C.stringNameParts</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650027"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>      </span><span class="hs-comment">-- The keyword constructor can appear as the only NamePart in the</span><span>
</span><span id="line-98"></span><span>      </span><span class="hs-comment">-- last segment of a qualified name --- Foo.constructor refers to</span><span>
</span><span id="line-99"></span><span>      </span><span class="hs-comment">-- the constructor of the record Foo.</span><span>
</span><span id="line-100"></span><span>      </span><span id="local-6989586621681650030"><span class="annot"><span class="annottext">constructor :: Bool
</span><a href="#local-6989586621681650030"><span class="hs-identifier hs-var hs-var hs-var">constructor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681650028"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-101"></span><span>        </span><span class="annot"><span class="annottext">NamePart
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681650025"><span class="hs-identifier hs-var">constructor'</span></a></span><span>
</span><span id="line-102"></span><span>        </span><span class="annot"><span class="annottext">NameParts
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-103"></span><span>      </span><span class="hs-comment">--  The constructor' argument to mkName' determines whether this</span><span>
</span><span id="line-104"></span><span>      </span><span class="hs-comment">--  is the last segment of a QName, the local variable constructor</span><span>
</span><span id="line-105"></span><span>      </span><span class="hs-comment">--  additionally takes whether it's the only NamePart into</span><span>
</span><span id="line-106"></span><span>      </span><span class="hs-comment">--  consideration.</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><span class="annottext">(NamePart -&gt; Parser ()) -&gt; NameParts -&gt; Parser ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; NamePart -&gt; Parser ()
</span><a href="#local-6989586621681650032"><span class="hs-identifier hs-var">isValidId</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681650030"><span class="hs-identifier hs-var">constructor</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681650028"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Parser () -&gt; Parser ()
forall b (m :: * -&gt; *). (IsBool b, Monad m) =&gt; b -&gt; m () -&gt; m ()
</span><a href="Agda.Utils.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameParts -&gt; Bool
</span><a href="#local-6989586621681650034"><span class="hs-identifier hs-var">alternating</span></a></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681650028"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Parser () -&gt; Parser ()) -&gt; Parser () -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser ()
forall a. [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier hs-var">parseError</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser ()) -&gt; [Char] -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;a name cannot contain two consecutive underscores&quot;</span></span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><span class="annottext">Name -&gt; Parser Name
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Parser Name) -&gt; Name -&gt; Parser Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; NameInScope -&gt; NameParts -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Interval -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681650026"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#InScope"><span class="hs-identifier hs-var">InScope</span></a></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681650028"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-112"></span><span>        </span><span id="local-6989586621681650032"><span class="annot"><span class="annottext">isValidId :: Bool -&gt; NamePart -&gt; Parser ()
</span><a href="#local-6989586621681650032"><span class="hs-identifier hs-var hs-var">isValidId</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Parser ()
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>        </span><span class="annot"><a href="#local-6989586621681650032"><span class="hs-identifier hs-var">isValidId</span></a></span><span> </span><span id="local-6989586621681650039"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681650039"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span id="local-6989586621681650041"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650041"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-114"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681650042"><span class="annot"><span class="annottext">x :: [Char]
</span><a href="#local-6989586621681650042"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><a href="Agda.Syntax.Common.html#rawNameToString"><span class="hs-identifier hs-var">rawNameToString</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650041"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-115"></span><span>              </span><span id="local-6989586621681650044"><span class="annot"><span class="annottext">err :: [Char]
</span><a href="#local-6989586621681650044"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;in the name &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650027"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;, the part &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650042"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; is not valid&quot;</span></span><span>
</span><span id="line-116"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ParseFlags -&gt; [Int] -&gt; Parser Token -&gt; [Char] -&gt; ParseResult Token
forall a.
ParseFlags -&gt; [Int] -&gt; Parser a -&gt; [Char] -&gt; ParseResult a
</span><a href="Agda.Syntax.Parser.Monad.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">ParseFlags
</span><a href="Agda.Syntax.Parser.Monad.html#defaultParseFlags"><span class="hs-identifier hs-var">defaultParseFlags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Token -&gt; Parser Token) -&gt; Parser Token
forall a. (Token -&gt; Parser a) -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Lexer.html#lexer"><span class="hs-identifier hs-var">lexer</span></a></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Parser Token
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650042"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-117"></span><span>            </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseOk"><span class="hs-identifier hs-type">ParseOk</span></a></span><span> </span><span class="annot"><span class="annottext">ParseState
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#TokId"><span class="hs-identifier hs-type">TokId</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Parser ()
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>            </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseFailed"><span class="hs-identifier hs-type">ParseFailed</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser ()
forall a. [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier hs-var">parseError</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650044"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-119"></span><span>            </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseOk"><span class="hs-identifier hs-type">ParseOk</span></a></span><span> </span><span class="annot"><span class="annottext">ParseState
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#TokEOF"><span class="hs-identifier hs-type">TokEOF</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser ()
forall a. [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier hs-var">parseError</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650044"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-120"></span><span>            </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseOk"><span class="hs-identifier hs-type">ParseOk</span></a></span><span> </span><span class="annot"><span class="annottext">ParseState
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#TokKeyword"><span class="hs-identifier hs-type">TokKeyword</span></a></span><span> </span><span class="annot"><span class="annottext">Keyword
</span><a href="Agda.Syntax.Parser.Tokens.html#KwConstructor"><span class="hs-identifier hs-var">KwConstructor</span></a></span><span> </span><span class="annot"><span class="annottext">Interval
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681650039"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Parser ()
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>            </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#ParseOk"><span class="hs-identifier hs-type">ParseOk</span></a></span><span> </span><span class="annot"><span class="annottext">ParseState
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681650054"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621681650054"><span class="hs-identifier hs-var">t</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser ()
forall a. [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier hs-var">parseError</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser ()) -&gt; ([Char] -&gt; [Char]) -&gt; [Char] -&gt; Parser ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650044"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; because it is &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser ()) -&gt; [Char] -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621681650054"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-122"></span><span>              </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#TokQId"><span class="hs-identifier hs-type">TokQId</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="hs-comment">-- &quot;qualified&quot;</span><span>
</span><span id="line-123"></span><span>              </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#TokKeyword"><span class="hs-identifier hs-type">TokKeyword</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;a keyword&quot;</span></span><span>
</span><span id="line-124"></span><span>              </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#TokLiteral"><span class="hs-identifier hs-type">TokLiteral</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;a literal&quot;</span></span><span>
</span><span id="line-125"></span><span>              </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#TokSymbol"><span class="hs-identifier hs-type">TokSymbol</span></a></span><span> </span><span id="local-6989586621681650059"><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621681650059"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">Interval
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621681650059"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-126"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymDot"><span class="hs-identifier hs-var">SymDot</span></a></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="hs-comment">-- &quot;reserved&quot;</span><span>
</span><span id="line-127"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymSemi"><span class="hs-identifier hs-var">SymSemi</span></a></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;used to separate declarations&quot;</span></span><span>
</span><span id="line-128"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymVirtualSemi"><span class="hs-identifier hs-var">SymVirtualSemi</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-129"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymBar"><span class="hs-identifier hs-var">SymBar</span></a></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;used for with-arguments&quot;</span></span><span>
</span><span id="line-130"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymColon"><span class="hs-identifier hs-var">SymColon</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;part of declaration syntax&quot;</span></span><span>
</span><span id="line-131"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymArrow"><span class="hs-identifier hs-var">SymArrow</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;the function arrow&quot;</span></span><span>
</span><span id="line-132"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymEqual"><span class="hs-identifier hs-var">SymEqual</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;part of declaration syntax&quot;</span></span><span>
</span><span id="line-133"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymLambda"><span class="hs-identifier hs-var">SymLambda</span></a></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;used for lambda-abstraction&quot;</span></span><span>
</span><span id="line-134"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymUnderscore"><span class="hs-identifier hs-var">SymUnderscore</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;used for anonymous identifiers&quot;</span></span><span>
</span><span id="line-135"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymQuestionMark"><span class="hs-identifier hs-var">SymQuestionMark</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;a meta variable&quot;</span></span><span>
</span><span id="line-136"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymAs"><span class="hs-identifier hs-var">SymAs</span></a></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;used for as-patterns&quot;</span></span><span>
</span><span id="line-137"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymOpenParen"><span class="hs-identifier hs-var">SymOpenParen</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;used to parenthesize expressions&quot;</span></span><span>
</span><span id="line-138"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymCloseParen"><span class="hs-identifier hs-var">SymCloseParen</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;used to parenthesize expressions&quot;</span></span><span>
</span><span id="line-139"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymOpenIdiomBracket"><span class="hs-identifier hs-var">SymOpenIdiomBracket</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;an idiom bracket&quot;</span></span><span>
</span><span id="line-140"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymCloseIdiomBracket"><span class="hs-identifier hs-var">SymCloseIdiomBracket</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;an idiom bracket&quot;</span></span><span>
</span><span id="line-141"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymEmptyIdiomBracket"><span class="hs-identifier hs-var">SymEmptyIdiomBracket</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;an empty idiom bracket&quot;</span></span><span>
</span><span id="line-142"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymDoubleOpenBrace"><span class="hs-identifier hs-var">SymDoubleOpenBrace</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;used for instance arguments&quot;</span></span><span>
</span><span id="line-143"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymDoubleCloseBrace"><span class="hs-identifier hs-var">SymDoubleCloseBrace</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;used for instance arguments&quot;</span></span><span>
</span><span id="line-144"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymOpenBrace"><span class="hs-identifier hs-var">SymOpenBrace</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;used for hidden arguments&quot;</span></span><span>
</span><span id="line-145"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymCloseBrace"><span class="hs-identifier hs-var">SymCloseBrace</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;used for hidden arguments&quot;</span></span><span>
</span><span id="line-146"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymOpenVirtualBrace"><span class="hs-identifier hs-var">SymOpenVirtualBrace</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-147"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymCloseVirtualBrace"><span class="hs-identifier hs-var">SymCloseVirtualBrace</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-148"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymOpenPragma"><span class="hs-identifier hs-var">SymOpenPragma</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="hs-comment">-- &quot;used for pragmas&quot;</span><span>
</span><span id="line-149"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymClosePragma"><span class="hs-identifier hs-var">SymClosePragma</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="hs-comment">-- &quot;used for pragmas&quot;</span><span>
</span><span id="line-150"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymEllipsis"><span class="hs-identifier hs-var">SymEllipsis</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;used for function clauses&quot;</span></span><span>
</span><span id="line-151"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymDotDot"><span class="hs-identifier hs-var">SymDotDot</span></a></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="hs-comment">-- &quot;a modality&quot;</span><span>
</span><span id="line-152"></span><span>                </span><span class="annot"><span class="annottext">Symbol
</span><a href="Agda.Syntax.Parser.Tokens.html#SymEndComment"><span class="hs-identifier hs-var">SymEndComment</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;the end-of-comment brace&quot;</span></span><span>
</span><span id="line-153"></span><span>              </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#TokString"><span class="hs-identifier hs-type">TokString</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-154"></span><span>              </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#TokTeX"><span class="hs-identifier hs-type">TokTeX</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>  </span><span class="hs-comment">-- used by the LaTeX backend only</span><span>
</span><span id="line-155"></span><span>              </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#TokMarkup"><span class="hs-identifier hs-type">TokMarkup</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>  </span><span class="hs-comment">-- ditto</span><span>
</span><span id="line-156"></span><span>              </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#TokComment"><span class="hs-identifier hs-type">TokComment</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-157"></span><span>              </span><span class="annot"><a href="Agda.Syntax.Parser.Tokens.html#TokDummy"><span class="hs-identifier hs-type">TokDummy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span>        </span><span class="hs-comment">-- we know that there are no two Ids in a row</span><span>
</span><span id="line-160"></span><span>        </span><span id="local-6989586621681650034"><span class="annot"><span class="annottext">alternating :: NameParts -&gt; Bool
</span><a href="#local-6989586621681650034"><span class="hs-identifier hs-var hs-var">alternating</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[NamePart]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-161"></span><span>        </span><span class="annot"><a href="#local-6989586621681650034"><span class="hs-identifier hs-var">alternating</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamePart
</span><span class="hs-identifier">_</span></span><span>    </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621681650092"><span class="annot"><span class="annottext">NamePart
</span><a href="#local-6989586621681650092"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681650093"><span class="annot"><span class="annottext">[NamePart]
</span><a href="#local-6989586621681650093"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameParts -&gt; Bool
</span><a href="#local-6989586621681650034"><span class="hs-identifier hs-var">alternating</span></a></span><span> </span><span class="annot"><span class="annottext">(NameParts -&gt; Bool) -&gt; NameParts -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="#local-6989586621681650092"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">NamePart -&gt; [NamePart] -&gt; NameParts
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[NamePart]
</span><a href="#local-6989586621681650093"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-162"></span><span>        </span><span class="annot"><a href="#local-6989586621681650034"><span class="hs-identifier hs-var">alternating</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamePart
</span><span class="hs-identifier">_</span></span><span>    </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span>       </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="annot"><span class="hs-comment">-- | Create a name from a string</span></span><span>
</span><span id="line-165"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#mkName"><span class="hs-identifier hs-type">mkName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#Interval"><span class="hs-identifier hs-type">Interval</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-166"></span><span id="mkName"><span class="annot"><span class="annottext">mkName :: (Interval, [Char]) -&gt; Parser Name
</span><a href="Agda.Syntax.Parser.Helpers.html#mkName"><span class="hs-identifier hs-var hs-var">mkName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Interval, [Char]) -&gt; Parser Name
</span><a href="Agda.Syntax.Parser.Helpers.html#mkName%27"><span class="hs-identifier hs-var">mkName'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="annot"><span class="hs-comment">-- | Create a qualified name from a list of strings</span></span><span>
</span><span id="line-169"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#mkQName"><span class="hs-identifier hs-type">mkQName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#Interval"><span class="hs-identifier hs-type">Interval</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>
</span><span id="line-170"></span><span id="mkQName"><span class="annot"><span class="annottext">mkQName :: [(Interval, [Char])] -&gt; Parser QName
</span><a href="Agda.Syntax.Parser.Helpers.html#mkQName"><span class="hs-identifier hs-var hs-var">mkQName</span></a></span></span><span> </span><span id="local-6989586621681650096"><span class="annot"><span class="annottext">[(Interval, [Char])]
</span><a href="#local-6989586621681650096"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681650097"><span class="annot"><span class="annottext">[(Interval, [Char])]
</span><a href="#local-6989586621681650097"><span class="hs-identifier hs-var">ss0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681650098"><span class="annot"><span class="annottext">(Interval, [Char])
</span><a href="#local-6989586621681650098"><span class="hs-identifier hs-var">ss1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Interval, [Char])]
-&gt; Maybe ([(Interval, [Char])], (Interval, [Char]))
forall a. [a] -&gt; Maybe ([a], a)
</span><a href="Agda.Utils.List.html#initLast"><span class="hs-identifier hs-var">initLast</span></a></span><span> </span><span class="annot"><span class="annottext">[(Interval, [Char])]
</span><a href="#local-6989586621681650096"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-171"></span><span>  </span><span id="local-6989586621681650099"><span class="annot"><a href="#local-6989586621681650099"><span class="hs-identifier hs-var">xs0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((Interval, [Char]) -&gt; Parser Name)
-&gt; [(Interval, [Char])] -&gt; Parser [Name]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">(Interval, [Char]) -&gt; Parser Name
</span><a href="Agda.Syntax.Parser.Helpers.html#mkName"><span class="hs-identifier hs-var">mkName</span></a></span><span> </span><span class="annot"><span class="annottext">[(Interval, [Char])]
</span><a href="#local-6989586621681650097"><span class="hs-identifier hs-var">ss0</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span id="local-6989586621681650101"><span class="annot"><a href="#local-6989586621681650101"><span class="hs-identifier hs-var">xs1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#mkName%27"><span class="hs-identifier hs-type">mkName'</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="annot"><a href="#local-6989586621681650098"><span class="hs-identifier hs-type">ss1</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">foldr</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-type">Qual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681650101"><span class="hs-identifier hs-type">xs1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681650099"><span class="hs-identifier hs-type">xs0</span></a></span><span>
</span><span id="line-174"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#mkQName"><span class="hs-identifier hs-var">mkQName</span></a></span><span> </span><span class="annot"><span class="annottext">[(Interval, [Char])]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser QName
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="hs-comment">-- The lexer never gives us an empty list of parts</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#mkDomainFree_"><span class="hs-identifier hs-type">mkDomainFree_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span>
</span><span id="line-177"></span><span id="mkDomainFree_"><span class="annot"><span class="annottext">mkDomainFree_ :: (NamedArg Binder -&gt; NamedArg Binder)
-&gt; Maybe Pattern -&gt; Name -&gt; NamedArg Binder
</span><a href="Agda.Syntax.Parser.Helpers.html#mkDomainFree_"><span class="hs-identifier hs-var hs-var">mkDomainFree_</span></a></span></span><span> </span><span id="local-6989586621681650105"><span class="annot"><span class="annottext">NamedArg Binder -&gt; NamedArg Binder
</span><a href="#local-6989586621681650105"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681650106"><span class="annot"><span class="annottext">Maybe Pattern
</span><a href="#local-6989586621681650106"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681650107"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650107"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedArg Binder -&gt; NamedArg Binder
</span><a href="#local-6989586621681650105"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(NamedArg Binder -&gt; NamedArg Binder)
-&gt; NamedArg Binder -&gt; NamedArg Binder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Binder -&gt; NamedArg Binder
forall a. a -&gt; NamedArg a
</span><a href="Agda.Syntax.Common.html#defaultNamedArg"><span class="hs-identifier hs-var">defaultNamedArg</span></a></span><span> </span><span class="annot"><span class="annottext">(Binder -&gt; NamedArg Binder) -&gt; Binder -&gt; NamedArg Binder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Pattern -&gt; BinderNameOrigin -&gt; BoundName -&gt; Binder
forall a. Maybe Pattern -&gt; BinderNameOrigin -&gt; a -&gt; Binder' a
</span><a href="Agda.Syntax.Concrete.html#Binder"><span class="hs-identifier hs-var">Binder</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Pattern
</span><a href="#local-6989586621681650106"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">BinderNameOrigin
</span><a href="Agda.Syntax.Common.html#UserBinderName"><span class="hs-identifier hs-var">UserBinderName</span></a></span><span> </span><span class="annot"><span class="annottext">(BoundName -&gt; Binder) -&gt; BoundName -&gt; Binder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; BoundName
</span><a href="Agda.Syntax.Concrete.html#mkBoundName_"><span class="hs-identifier hs-var">mkBoundName_</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650107"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#mkRString"><span class="hs-identifier hs-type">mkRString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#Interval"><span class="hs-identifier hs-type">Interval</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#RString"><span class="hs-identifier hs-type">RString</span></a></span><span>
</span><span id="line-180"></span><span id="mkRString"><span class="annot"><span class="annottext">mkRString :: (Interval, [Char]) -&gt; RString
</span><a href="Agda.Syntax.Parser.Helpers.html#mkRString"><span class="hs-identifier hs-var hs-var">mkRString</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681650113"><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681650113"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681650114"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650114"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range -&gt; [Char] -&gt; RString
forall a. Range -&gt; a -&gt; Ranged a
</span><a href="Agda.Syntax.Common.html#Ranged"><span class="hs-identifier hs-var">Ranged</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Interval -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681650113"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650114"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#mkRText"><span class="hs-identifier hs-type">mkRText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#Interval"><span class="hs-identifier hs-type">Interval</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Ranged"><span class="hs-identifier hs-type">Ranged</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-183"></span><span id="mkRText"><span class="annot"><span class="annottext">mkRText :: (Interval, [Char]) -&gt; Ranged Text
</span><a href="Agda.Syntax.Parser.Helpers.html#mkRText"><span class="hs-identifier hs-var hs-var">mkRText</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681650117"><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681650117"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681650118"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650118"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Text -&gt; Ranged Text
forall a. Range -&gt; a -&gt; Ranged a
</span><a href="Agda.Syntax.Common.html#Ranged"><span class="hs-identifier hs-var">Ranged</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Interval -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681650117"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Ranged Text) -&gt; Text -&gt; Ranged Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650118"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-comment">-- | Create a qualified name from a string (used in pragmas).</span><span>
</span><span id="line-186"></span><span class="hs-comment">--   Range of each name component is range of whole string.</span><span>
</span><span id="line-187"></span><span class="hs-comment">--   TODO: precise ranges!</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#pragmaQName"><span class="hs-identifier hs-type">pragmaQName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#Interval"><span class="hs-identifier hs-type">Interval</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>
</span><span id="line-190"></span><span id="pragmaQName"><span class="annot"><span class="annottext">pragmaQName :: (Interval, [Char]) -&gt; Parser QName
</span><a href="Agda.Syntax.Parser.Helpers.html#pragmaQName"><span class="hs-identifier hs-var hs-var">pragmaQName</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681650121"><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681650121"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681650122"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650122"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681650123"><span class="annot"><span class="annottext">ss :: [[Char]]
</span><a href="#local-6989586621681650123"><span class="hs-identifier hs-var hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; [Char] -&gt; [[Char]]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><a href="Agda.Utils.List.html#chopWhen"><span class="hs-identifier hs-var">chopWhen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650122"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span class="annot"><span class="annottext">[(Interval, [Char])] -&gt; Parser QName
</span><a href="Agda.Syntax.Parser.Helpers.html#mkQName"><span class="hs-identifier hs-var">mkQName</span></a></span><span> </span><span class="annot"><span class="annottext">([(Interval, [Char])] -&gt; Parser QName)
-&gt; [(Interval, [Char])] -&gt; Parser QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; (Interval, [Char])) -&gt; [[Char]] -&gt; [(Interval, [Char])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681650121"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621681650123"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#mkNamedArg"><span class="hs-identifier hs-type">mkNamedArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#BoundName"><span class="hs-identifier hs-type">BoundName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span id="mkNamedArg"><span class="annot"><span class="annottext">mkNamedArg :: Maybe QName -&gt; Either QName Range -&gt; Parser (NamedArg BoundName)
</span><a href="Agda.Syntax.Parser.Helpers.html#mkNamedArg"><span class="hs-identifier hs-var hs-var">mkNamedArg</span></a></span></span><span> </span><span id="local-6989586621681650125"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681650125"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681650126"><span class="annot"><span class="annottext">Either QName Range
</span><a href="#local-6989586621681650126"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-196"></span><span>  </span><span id="local-6989586621681650127"><span class="annot"><a href="#local-6989586621681650127"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681650125"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-197"></span><span>           </span><span class="annot"><span class="annottext">Maybe QName
</span><span class="hs-identifier hs-var">Nothing</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe NamedName -&gt; Parser (Maybe NamedName)
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe NamedName -&gt; Parser (Maybe NamedName))
-&gt; Maybe NamedName -&gt; Parser (Maybe NamedName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NamedName -&gt; Maybe NamedName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(NamedName -&gt; Maybe NamedName) -&gt; NamedName -&gt; Maybe NamedName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Origin -&gt; RString -&gt; NamedName
forall a. Origin -&gt; a -&gt; WithOrigin a
</span><a href="Agda.Syntax.Common.html#WithOrigin"><span class="hs-identifier hs-var">WithOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">Origin
</span><a href="Agda.Syntax.Common.html#UserWritten"><span class="hs-identifier hs-var">UserWritten</span></a></span><span> </span><span class="annot"><span class="annottext">(RString -&gt; NamedName) -&gt; RString -&gt; NamedName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; RString
forall a. a -&gt; Ranged a
</span><a href="Agda.Syntax.Common.html#unranged"><span class="hs-identifier hs-var">unranged</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;_&quot;</span></span><span>
</span><span id="line-198"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681650131"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650131"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe NamedName -&gt; Parser (Maybe NamedName)
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe NamedName -&gt; Parser (Maybe NamedName))
-&gt; Maybe NamedName -&gt; Parser (Maybe NamedName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NamedName -&gt; Maybe NamedName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(NamedName -&gt; Maybe NamedName) -&gt; NamedName -&gt; Maybe NamedName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Origin -&gt; RString -&gt; NamedName
forall a. Origin -&gt; a -&gt; WithOrigin a
</span><a href="Agda.Syntax.Common.html#WithOrigin"><span class="hs-identifier hs-var">WithOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">Origin
</span><a href="Agda.Syntax.Common.html#UserWritten"><span class="hs-identifier hs-var">UserWritten</span></a></span><span> </span><span class="annot"><span class="annottext">(RString -&gt; NamedName) -&gt; RString -&gt; NamedName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; [Char] -&gt; RString
forall a. Range -&gt; a -&gt; Ranged a
</span><a href="Agda.Syntax.Common.html#Ranged"><span class="hs-identifier hs-var">Ranged</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650131"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; RString) -&gt; [Char] -&gt; RString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650131"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-199"></span><span>           </span><span class="annot"><span class="annottext">Maybe QName
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (Maybe NamedName)
forall a. [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier hs-var">parseError</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;expected unqualified variable name&quot;</span></span><span>
</span><span id="line-200"></span><span>  </span><span id="local-6989586621681650133"><span class="annot"><a href="#local-6989586621681650133"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621681650126"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-201"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681650134"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650134"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BoundName -&gt; Parser BoundName
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(BoundName -&gt; Parser BoundName) -&gt; BoundName -&gt; Parser BoundName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Fixity' -&gt; BoundName
</span><a href="Agda.Syntax.Concrete.html#mkBoundName"><span class="hs-identifier hs-var">mkBoundName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650134"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity'
</span><a href="Agda.Syntax.Common.html#noFixity%27"><span class="hs-identifier hs-var">noFixity'</span></a></span><span>
</span><span id="line-202"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621681650137"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650137"><span class="hs-identifier hs-var">r</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BoundName -&gt; Parser BoundName
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(BoundName -&gt; Parser BoundName) -&gt; BoundName -&gt; Parser BoundName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Fixity' -&gt; BoundName
</span><a href="Agda.Syntax.Concrete.html#mkBoundName"><span class="hs-identifier hs-var">mkBoundName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#noName"><span class="hs-identifier hs-var">noName</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650137"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fixity'
</span><a href="Agda.Syntax.Common.html#noFixity%27"><span class="hs-identifier hs-var">noFixity'</span></a></span><span>
</span><span id="line-203"></span><span>           </span><span class="annot"><span class="annottext">Either QName Range
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser BoundName
forall a. [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier hs-var">parseError</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;expected unqualified variable name&quot;</span></span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#defaultArg"><span class="hs-identifier hs-type">defaultArg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681650127"><span class="hs-identifier hs-type">lbl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681650133"><span class="hs-identifier hs-type">var</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="annot"><span class="hs-comment">-- | Polarity parser.</span></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#polarity"><span class="hs-identifier hs-type">polarity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#Interval"><span class="hs-identifier hs-type">Interval</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Positivity.Occurrence.html#Occurrence"><span class="hs-identifier hs-type">Occurrence</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span id="polarity"><span class="annot"><span class="annottext">polarity :: (Interval, [Char]) -&gt; Parser (Range, Occurrence)
</span><a href="Agda.Syntax.Parser.Helpers.html#polarity"><span class="hs-identifier hs-var hs-var">polarity</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681650141"><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681650141"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681650142"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650142"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650142"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;_&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Occurrence -&gt; Parser (Range, Occurrence)
</span><a href="#local-6989586621681650143"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Occurrence
</span><a href="Agda.TypeChecking.Positivity.Occurrence.html#Unused"><span class="hs-identifier hs-var">Unused</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;++&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Occurrence -&gt; Parser (Range, Occurrence)
</span><a href="#local-6989586621681650143"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Occurrence
</span><a href="Agda.TypeChecking.Positivity.Occurrence.html#StrictPos"><span class="hs-identifier hs-var">StrictPos</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;+&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Occurrence -&gt; Parser (Range, Occurrence)
</span><a href="#local-6989586621681650143"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Occurrence
</span><a href="Agda.TypeChecking.Positivity.Occurrence.html#JustPos"><span class="hs-identifier hs-var">JustPos</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Occurrence -&gt; Parser (Range, Occurrence)
</span><a href="#local-6989586621681650143"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Occurrence
</span><a href="Agda.TypeChecking.Positivity.Occurrence.html#JustNeg"><span class="hs-identifier hs-var">JustNeg</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;*&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Occurrence -&gt; Parser (Range, Occurrence)
</span><a href="#local-6989586621681650143"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Occurrence
</span><a href="Agda.TypeChecking.Positivity.Occurrence.html#Mixed"><span class="hs-identifier hs-var">Mixed</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (Range, Occurrence)
forall a. [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier hs-var">parseError</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser (Range, Occurrence))
-&gt; [Char] -&gt; Parser (Range, Occurrence)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Not a valid polarity: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650142"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-218"></span><span>  </span><span id="local-6989586621681650143"><span class="annot"><span class="annottext">ret :: Occurrence -&gt; Parser (Range, Occurrence)
</span><a href="#local-6989586621681650143"><span class="hs-identifier hs-var hs-var">ret</span></a></span></span><span> </span><span id="local-6989586621681650149"><span class="annot"><span class="annottext">Occurrence
</span><a href="#local-6989586621681650149"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Range, Occurrence) -&gt; Parser (Range, Occurrence)
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Interval -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681650141"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Occurrence
</span><a href="#local-6989586621681650149"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#recoverLayout"><span class="hs-identifier hs-type">recoverLayout</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#Interval"><span class="hs-identifier hs-type">Interval</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-221"></span><span id="recoverLayout"><span class="annot"><span class="annottext">recoverLayout :: [(Interval, [Char])] -&gt; [Char]
</span><a href="Agda.Syntax.Parser.Helpers.html#recoverLayout"><span class="hs-identifier hs-var hs-var">recoverLayout</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-222"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#recoverLayout"><span class="hs-identifier hs-var">recoverLayout</span></a></span><span> </span><span id="local-6989586621681650151"><span class="annot"><span class="annottext">xs :: [(Interval, [Char])]
</span><a href="#local-6989586621681650151"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681650152"><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681650152"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[(Interval, [Char])]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position' SrcFile -&gt; [(Interval, [Char])] -&gt; [Char]
</span><a href="#local-6989586621681650153"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Interval -&gt; Position' SrcFile
forall a. Interval' a -&gt; Position' a
</span><a href="Agda.Syntax.Position.html#iStart"><span class="hs-identifier hs-var">iStart</span></a></span><span> </span><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681650152"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Interval, [Char])]
</span><a href="#local-6989586621681650151"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-224"></span><span>    </span><span id="local-6989586621681650155"><span class="annot"><span class="annottext">c0 :: Word32
</span><a href="#local-6989586621681650155"><span class="hs-identifier hs-var hs-var">c0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position' SrcFile -&gt; Word32
forall a. Position' a -&gt; Word32
</span><a href="Agda.Syntax.Position.html#posCol"><span class="hs-identifier hs-var">posCol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Interval -&gt; Position' SrcFile
forall a. Interval' a -&gt; Position' a
</span><a href="Agda.Syntax.Position.html#iStart"><span class="hs-identifier hs-var">iStart</span></a></span><span> </span><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681650152"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621681650153"><span class="annot"><span class="annottext">go :: Position' SrcFile -&gt; [(Interval, [Char])] -&gt; [Char]
</span><a href="#local-6989586621681650153"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681650157"><span class="annot"><span class="annottext">Position' SrcFile
</span><a href="#local-6989586621681650157"><span class="hs-identifier hs-var">cur</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><a href="#local-6989586621681650153"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681650158"><span class="annot"><span class="annottext">Position' SrcFile
</span><a href="#local-6989586621681650158"><span class="hs-identifier hs-var">cur</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681650159"><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681650159"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681650160"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650160"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681650161"><span class="annot"><span class="annottext">[(Interval, [Char])]
</span><a href="#local-6989586621681650161"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position' SrcFile -&gt; Position' SrcFile -&gt; [Char]
</span><a href="#local-6989586621681650162"><span class="hs-identifier hs-var">padding</span></a></span><span> </span><span class="annot"><span class="annottext">Position' SrcFile
</span><a href="#local-6989586621681650158"><span class="hs-identifier hs-var">cur</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Interval -&gt; Position' SrcFile
forall a. Interval' a -&gt; Position' a
</span><a href="Agda.Syntax.Position.html#iStart"><span class="hs-identifier hs-var">iStart</span></a></span><span> </span><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681650159"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650160"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Position' SrcFile -&gt; [(Interval, [Char])] -&gt; [Char]
</span><a href="#local-6989586621681650153"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Interval -&gt; Position' SrcFile
forall a. Interval' a -&gt; Position' a
</span><a href="Agda.Syntax.Position.html#iEnd"><span class="hs-identifier hs-var">iEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Interval
</span><a href="#local-6989586621681650159"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Interval, [Char])]
</span><a href="#local-6989586621681650161"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span>    </span><span id="local-6989586621681650162"><span class="annot"><span class="annottext">padding :: Position' SrcFile -&gt; Position' SrcFile -&gt; [Char]
</span><a href="#local-6989586621681650162"><span class="hs-identifier hs-var hs-var">padding</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Pn"><span class="hs-identifier hs-type">Pn</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">posLine :: forall a. Position' a -&gt; Word32
</span><a href="Agda.Syntax.Position.html#posLine"><span class="hs-identifier hs-var">posLine</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681650166"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621681650166"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">posCol :: forall a. Position' a -&gt; Word32
</span><a href="Agda.Syntax.Position.html#posCol"><span class="hs-identifier hs-var">posCol</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681650167"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621681650167"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Pn"><span class="hs-identifier hs-type">Pn</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">posLine :: forall a. Position' a -&gt; Word32
</span><a href="Agda.Syntax.Position.html#posLine"><span class="hs-identifier hs-var">posLine</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681650168"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621681650168"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">posCol :: forall a. Position' a -&gt; Word32
</span><a href="Agda.Syntax.Position.html#posCol"><span class="hs-identifier hs-var">posCol</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681650169"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621681650169"><span class="hs-identifier hs-var">c2</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-230"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621681650166"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621681650168"><span class="hs-identifier hs-var">l2</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Char -&gt; [Char]
forall i a. Integral i =&gt; i -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">List.genericReplicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621681650168"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621681650166"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Char -&gt; [Char]
forall i a. Integral i =&gt; i -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">List.genericReplicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621681650169"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621681650155"><span class="hs-identifier hs-var">c0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span>
</span><span id="line-231"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621681650166"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621681650168"><span class="hs-identifier hs-var">l2</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Char -&gt; [Char]
forall i a. Integral i =&gt; i -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">List.genericReplicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621681650169"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621681650167"><span class="hs-identifier hs-var">c1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span>
</span><span id="line-232"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#ensureUnqual"><span class="hs-identifier hs-type">ensureUnqual</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-235"></span><span id="ensureUnqual"><span class="annot"><span class="annottext">ensureUnqual :: QName -&gt; Parser Name
</span><a href="Agda.Syntax.Parser.Helpers.html#ensureUnqual"><span class="hs-identifier hs-var hs-var">ensureUnqual</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681650174"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650174"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Parser Name
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650174"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-236"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#ensureUnqual"><span class="hs-identifier hs-var">ensureUnqual</span></a></span><span> </span><span id="local-6989586621681650175"><span class="annot"><span class="annottext">q :: QName
</span><a href="#local-6989586621681650175"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-type">Qual</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PositionWithoutFile -&gt; [Char] -&gt; Parser Name
forall a. Maybe PositionWithoutFile -&gt; [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError%27"><span class="hs-identifier hs-var">parseError'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Maybe PositionWithoutFile
forall a. Range' a -&gt; Maybe PositionWithoutFile
</span><a href="Agda.Syntax.Position.html#rStart%27"><span class="hs-identifier hs-var">rStart'</span></a></span><span> </span><span class="annot"><span class="annottext">(Range -&gt; Maybe PositionWithoutFile)
-&gt; Range -&gt; Maybe PositionWithoutFile
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681650175"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Qualified name not allowed here&quot;</span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- Lambinds</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="annot"><span class="hs-comment">-- | Result of parsing @LamBinds@.</span></span><span>
</span><span id="line-242"></span><span class="hs-keyword">data</span><span> </span><span id="LamBinds%27"><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#LamBinds%27"><span class="hs-identifier hs-var">LamBinds'</span></a></span></span><span> </span><span id="local-6989586621681649450"><span class="annot"><a href="#local-6989586621681649450"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LamBinds"><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#LamBinds"><span class="hs-identifier hs-var">LamBinds</span></a></span></span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="lamBindings"><span class="annot"><span class="annottext">forall a. LamBinds' a -&gt; a
</span><a href="Agda.Syntax.Parser.Helpers.html#lamBindings"><span class="hs-identifier hs-var hs-var">lamBindings</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681649450"><span class="hs-identifier hs-type">a</span></a></span><span>             </span><span class="annot"><span class="hs-comment">-- ^ A number of domain-free or typed bindings or record patterns.</span></span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="absurdBinding"><span class="annot"><span class="annottext">forall a. LamBinds' a -&gt; Maybe Hiding
</span><a href="Agda.Syntax.Parser.Helpers.html#absurdBinding"><span class="hs-identifier hs-var hs-var">absurdBinding</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Hiding"><span class="hs-identifier hs-type">Hiding</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Followed by possibly a final absurd pattern.</span></span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681650182"><span id="local-6989586621681650184"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; LamBinds' a -&gt; LamBinds' b)
-&gt; (forall a b. a -&gt; LamBinds' b -&gt; LamBinds' a)
-&gt; Functor LamBinds'
forall a b. a -&gt; LamBinds' b -&gt; LamBinds' a
forall a b. (a -&gt; b) -&gt; LamBinds' a -&gt; LamBinds' b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; LamBinds' a -&gt; LamBinds' b
fmap :: forall a b. (a -&gt; b) -&gt; LamBinds' a -&gt; LamBinds' b
$c&lt;$ :: forall a b. a -&gt; LamBinds' b -&gt; LamBinds' a
&lt;$ :: forall a b. a -&gt; LamBinds' b -&gt; LamBinds' a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-keyword">type</span><span> </span><span id="LamBinds"><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#LamBinds"><span class="hs-identifier hs-var">LamBinds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#LamBinds%27"><span class="hs-identifier hs-type">LamBinds'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#LamBinding"><span class="hs-identifier hs-type">LamBinding</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#mkAbsurdBinding"><span class="hs-identifier hs-type">mkAbsurdBinding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Hiding"><span class="hs-identifier hs-type">Hiding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#LamBinds"><span class="hs-identifier hs-type">LamBinds</span></a></span><span>
</span><span id="line-250"></span><span id="mkAbsurdBinding"><span class="annot"><span class="annottext">mkAbsurdBinding :: Hiding -&gt; LamBinds
</span><a href="Agda.Syntax.Parser.Helpers.html#mkAbsurdBinding"><span class="hs-identifier hs-var hs-var">mkAbsurdBinding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LamBinding] -&gt; Maybe Hiding -&gt; LamBinds
forall a. a -&gt; Maybe Hiding -&gt; LamBinds' a
</span><a href="Agda.Syntax.Parser.Helpers.html#LamBinds"><span class="hs-identifier hs-var">LamBinds</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Maybe Hiding -&gt; LamBinds)
-&gt; (Hiding -&gt; Maybe Hiding) -&gt; Hiding -&gt; LamBinds
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Hiding -&gt; Maybe Hiding
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span id="local-6989586621681649461"><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#mkLamBinds"><span class="hs-identifier hs-type">mkLamBinds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681649461"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#LamBinds%27"><span class="hs-identifier hs-type">LamBinds'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681649461"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-253"></span><span id="mkLamBinds"><span class="annot"><span class="annottext">mkLamBinds :: forall a. a -&gt; LamBinds' a
</span><a href="Agda.Syntax.Parser.Helpers.html#mkLamBinds"><span class="hs-identifier hs-var hs-var">mkLamBinds</span></a></span></span><span> </span><span id="local-6989586621681650190"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681650190"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe Hiding -&gt; LamBinds' a
forall a. a -&gt; Maybe Hiding -&gt; LamBinds' a
</span><a href="Agda.Syntax.Parser.Helpers.html#LamBinds"><span class="hs-identifier hs-var">LamBinds</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681650190"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Hiding
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="annot"><span class="hs-comment">-- | Build a forall pi (forall x y z -&gt; ...)</span></span><span>
</span><span id="line-256"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#forallPi"><span class="hs-identifier hs-type">forallPi</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LamBinding"><span class="hs-identifier hs-type">LamBinding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-257"></span><span id="forallPi"><span class="annot"><span class="annottext">forallPi :: List1 LamBinding -&gt; Expr -&gt; Expr
</span><a href="Agda.Syntax.Parser.Helpers.html#forallPi"><span class="hs-identifier hs-var hs-var">forallPi</span></a></span></span><span> </span><span id="local-6989586621681650192"><span class="annot"><span class="annottext">List1 LamBinding
</span><a href="#local-6989586621681650192"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621681650193"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650193"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope1 -&gt; Expr -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Pi"><span class="hs-identifier hs-var">Pi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LamBinding -&gt; TypedBinding) -&gt; List1 LamBinding -&gt; Telescope1
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">LamBinding -&gt; TypedBinding
</span><a href="Agda.Syntax.Parser.Helpers.html#addType"><span class="hs-identifier hs-var">addType</span></a></span><span> </span><span class="annot"><span class="annottext">List1 LamBinding
</span><a href="#local-6989586621681650192"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650193"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="annot"><span class="hs-comment">-- | Converts lambda bindings to typed bindings.</span></span><span>
</span><span id="line-260"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#addType"><span class="hs-identifier hs-type">addType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LamBinding"><span class="hs-identifier hs-type">LamBinding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#TypedBinding"><span class="hs-identifier hs-type">TypedBinding</span></a></span><span>
</span><span id="line-261"></span><span id="addType"><span class="annot"><span class="annottext">addType :: LamBinding -&gt; TypedBinding
</span><a href="Agda.Syntax.Parser.Helpers.html#addType"><span class="hs-identifier hs-var hs-var">addType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#DomainFull"><span class="hs-identifier hs-type">DomainFull</span></a></span><span> </span><span id="local-6989586621681650197"><span class="annot"><span class="annottext">TypedBinding
</span><a href="#local-6989586621681650197"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypedBinding
</span><a href="#local-6989586621681650197"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-262"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#addType"><span class="hs-identifier hs-var">addType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#DomainFree"><span class="hs-identifier hs-type">DomainFree</span></a></span><span> </span><span id="local-6989586621681650199"><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621681650199"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range -&gt; List1 (NamedArg Binder) -&gt; Expr -&gt; TypedBinding
forall e. Range -&gt; List1 (NamedArg Binder) -&gt; e -&gt; TypedBinding' e
</span><a href="Agda.Syntax.Concrete.html#TBind"><span class="hs-identifier hs-var">TBind</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650201"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedArg Binder -&gt; List1 (NamedArg Binder)
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621681650199"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; TypedBinding) -&gt; Expr -&gt; TypedBinding
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Maybe [Char] -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Underscore"><span class="hs-identifier hs-var">Underscore</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650201"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681650201"><span class="annot"><span class="annottext">r :: Range
</span><a href="#local-6989586621681650201"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedArg Binder -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621681650199"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-comment">-- | Returns the value of the first erasure attribute, if any, or else</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- the default value of type 'Erased'.</span><span>
</span><span id="line-267"></span><span class="hs-comment">--</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- Raises warnings for all attributes except for erasure attributes,</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- and for multiple erasure attributes.</span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#onlyErased"><span class="hs-identifier hs-type">onlyErased</span></a></span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-type">Attr</span></a></span><span class="hs-special">]</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The attributes, in reverse order.</span></span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Erased"><span class="hs-identifier hs-type">Erased</span></a></span><span>
</span><span id="line-274"></span><span id="onlyErased"><span class="annot"><span class="annottext">onlyErased :: [Attr] -&gt; Parser Erased
</span><a href="Agda.Syntax.Parser.Helpers.html#onlyErased"><span class="hs-identifier hs-var hs-var">onlyErased</span></a></span></span><span> </span><span id="local-6989586621681650206"><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650206"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-275"></span><span>  </span><span id="local-6989586621681650207"><span class="annot"><a href="#local-6989586621681650207"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Maybe Erased] -&gt; [Erased]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">([Maybe Erased] -&gt; [Erased])
-&gt; Parser [Maybe Erased] -&gt; Parser [Erased]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Attr -&gt; Parser (Maybe Erased)) -&gt; [Attr] -&gt; Parser [Maybe Erased]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Attr -&gt; Parser (Maybe Erased)
</span><a href="#local-6989586621681650210"><span class="hs-identifier hs-var">onlyErased'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Attr] -&gt; [Attr]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650206"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621681650207"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Erased -&gt; Parser Erased
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Erased
</span><a href="Agda.Syntax.Common.html#defaultErased"><span class="hs-identifier hs-var">defaultErased</span></a></span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621681650212"><span class="annot"><span class="annottext">Erased
</span><a href="#local-6989586621681650212"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Erased -&gt; Parser Erased
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Erased
</span><a href="#local-6989586621681650212"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span id="local-6989586621681650213"><span class="annot"><span class="annottext">Erased
</span><a href="#local-6989586621681650213"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681650214"><span class="annot"><span class="annottext">[Erased]
</span><a href="#local-6989586621681650214"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-280"></span><span>      </span><span class="annot"><span class="annottext">ParseWarning -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#parseWarning"><span class="hs-identifier hs-var">parseWarning</span></a></span><span> </span><span class="annot"><span class="annottext">(ParseWarning -&gt; Parser ()) -&gt; ParseWarning -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Maybe [Char] -&gt; ParseWarning
</span><a href="Agda.Syntax.Parser.Monad.html#MultipleAttributes"><span class="hs-identifier hs-var">MultipleAttributes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Erased] -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">[Erased]
</span><a href="#local-6989586621681650214"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Maybe [Char]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;erasure&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>      </span><span class="annot"><span class="annottext">Erased -&gt; Parser Erased
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Erased
</span><a href="#local-6989586621681650213"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-283"></span><span>  </span><span id="local-6989586621681650210"><span class="annot"><span class="annottext">onlyErased' :: Attr -&gt; Parser (Maybe Erased)
</span><a href="#local-6989586621681650210"><span class="hs-identifier hs-var hs-var">onlyErased'</span></a></span></span><span> </span><span id="local-6989586621681650227"><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621681650227"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Attr -&gt; Attribute
</span><a href="Agda.Syntax.Parser.Helpers.html#theAttr"><span class="hs-identifier hs-var">theAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621681650227"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.Attribute.html#RelevanceAttribute"><span class="hs-identifier hs-type">RelevanceAttribute</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (Maybe Erased)
</span><a href="#local-6989586621681650230"><span class="hs-identifier hs-var">unsup</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Relevance&quot;</span></span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.Attribute.html#CohesionAttribute"><span class="hs-identifier hs-type">CohesionAttribute</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (Maybe Erased)
</span><a href="#local-6989586621681650230"><span class="hs-identifier hs-var">unsup</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Cohesion&quot;</span></span><span>
</span><span id="line-286"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.Attribute.html#LockAttribute"><span class="hs-identifier hs-type">LockAttribute</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (Maybe Erased)
</span><a href="#local-6989586621681650230"><span class="hs-identifier hs-var">unsup</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Lock&quot;</span></span><span>
</span><span id="line-287"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.Attribute.html#TacticAttribute"><span class="hs-identifier hs-type">CA.TacticAttribute</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (Maybe Erased)
</span><a href="#local-6989586621681650230"><span class="hs-identifier hs-var">unsup</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Tactic&quot;</span></span><span>
</span><span id="line-288"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.Attribute.html#PolarityAttribute"><span class="hs-identifier hs-type">PolarityAttribute</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (Maybe Erased)
</span><a href="#local-6989586621681650230"><span class="hs-identifier hs-var">unsup</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Polarity&quot;</span></span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.Attribute.html#QuantityAttribute"><span class="hs-identifier hs-type">QuantityAttribute</span></a></span><span> </span><span id="local-6989586621681650236"><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621681650236"><span class="hs-identifier hs-var">q</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Parser (Maybe Erased)
-&gt; (Erased -&gt; Parser (Maybe Erased))
-&gt; Maybe Erased
-&gt; Parser (Maybe Erased)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Parser (Maybe Erased)
</span><a href="#local-6989586621681650230"><span class="hs-identifier hs-var">unsup</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Linearity&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Erased -&gt; Parser (Maybe Erased)
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Erased -&gt; Parser (Maybe Erased))
-&gt; (Erased -&gt; Maybe Erased) -&gt; Erased -&gt; Parser (Maybe Erased)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Erased -&gt; Maybe Erased
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Erased -&gt; Parser (Maybe Erased))
-&gt; Maybe Erased -&gt; Parser (Maybe Erased)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Quantity -&gt; Maybe Erased
</span><a href="Agda.Syntax.Common.html#erasedFromQuantity"><span class="hs-identifier hs-var">erasedFromQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621681650236"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-291"></span><span>    </span><span id="local-6989586621681650230"><span class="annot"><span class="annottext">unsup :: [Char] -&gt; Parser (Maybe Erased)
</span><a href="#local-6989586621681650230"><span class="hs-identifier hs-var hs-var">unsup</span></a></span></span><span> </span><span id="local-6989586621681650239"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650239"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-292"></span><span>      </span><span class="annot"><span class="annottext">ParseWarning -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#parseWarning"><span class="hs-identifier hs-var">parseWarning</span></a></span><span> </span><span class="annot"><span class="annottext">(ParseWarning -&gt; Parser ()) -&gt; ParseWarning -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Maybe [Char] -&gt; ParseWarning
</span><a href="Agda.Syntax.Parser.Monad.html#UnsupportedAttribute"><span class="hs-identifier hs-var">UnsupportedAttribute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attr -&gt; Range
</span><a href="Agda.Syntax.Parser.Helpers.html#attrRange"><span class="hs-identifier hs-var">attrRange</span></a></span><span> </span><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621681650227"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Maybe [Char]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650239"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>      </span><span class="annot"><span class="annottext">Maybe Erased -&gt; Parser (Maybe Erased)
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe Erased
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="annot"><span class="hs-comment">-- | Constructs extended lambdas.</span></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#extLam"><span class="hs-identifier hs-type">extLam</span></a></span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span>            </span><span class="hs-comment">-- ^ The range of the lambda symbol and @where@ or</span><span>
</span><span id="line-299"></span><span>                      </span><span class="hs-comment">--   the braces.</span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-type">Attr</span></a></span><span class="hs-special">]</span><span>           </span><span class="annot"><span class="hs-comment">-- ^ The attributes in reverse order.</span></span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LamClause"><span class="hs-identifier hs-type">LamClause</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The clauses in reverse order.</span></span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-303"></span><span id="extLam"><span class="annot"><span class="annottext">extLam :: Range -&gt; [Attr] -&gt; NonEmpty LamClause -&gt; Parser Expr
</span><a href="Agda.Syntax.Parser.Helpers.html#extLam"><span class="hs-identifier hs-var hs-var">extLam</span></a></span></span><span> </span><span id="local-6989586621681650243"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650243"><span class="hs-identifier hs-var">symbolRange</span></a></span></span><span> </span><span id="local-6989586621681650244"><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650244"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621681650245"><span class="annot"><span class="annottext">NonEmpty LamClause
</span><a href="#local-6989586621681650245"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-304"></span><span>  </span><span id="local-6989586621681650246"><span class="annot"><a href="#local-6989586621681650246"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Attr] -&gt; Parser Erased
</span><a href="Agda.Syntax.Parser.Helpers.html#onlyErased"><span class="hs-identifier hs-var">onlyErased</span></a></span><span> </span><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650244"><span class="hs-identifier hs-var">attrs</span></a></span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681650247"><span class="annot"><a href="#local-6989586621681650247"><span class="hs-identifier hs-var hs-var">cs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty LamClause -&gt; NonEmpty LamClause
forall a. NonEmpty a -&gt; NonEmpty a
</span><span class="hs-identifier hs-var">List1.reverse</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty LamClause
</span><a href="#local-6989586621681650245"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-306"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#ExtendedLam"><span class="hs-identifier hs-type">ExtendedLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681650243"><span class="hs-identifier hs-type">symbolRange</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681650246"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681650247"><span class="hs-identifier hs-type">cs'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681650246"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681650247"><span class="hs-identifier hs-type">cs'</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="annot"><span class="hs-comment">-- | Constructs extended or absurd lambdas.</span></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#extOrAbsLam"><span class="hs-identifier hs-type">extOrAbsLam</span></a></span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ The range of the lambda symbol.</span></span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-type">Attr</span></a></span><span class="hs-special">]</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The attributes, in reverse order.</span></span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#LamBinding"><span class="hs-identifier hs-type">LamBinding</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Hiding"><span class="hs-identifier hs-type">Hiding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-315"></span><span id="extOrAbsLam"><span class="annot"><span class="annottext">extOrAbsLam :: Range
-&gt; [Attr]
-&gt; Either ([LamBinding], Hiding) (List1 Expr)
-&gt; Parser Expr
</span><a href="Agda.Syntax.Parser.Helpers.html#extOrAbsLam"><span class="hs-identifier hs-var hs-var">extOrAbsLam</span></a></span></span><span> </span><span id="local-6989586621681650251"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650251"><span class="hs-identifier hs-var">lambdaRange</span></a></span></span><span> </span><span id="local-6989586621681650252"><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650252"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621681650253"><span class="annot"><span class="annottext">Either ([LamBinding], Hiding) (List1 Expr)
</span><a href="#local-6989586621681650253"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either ([LamBinding], Hiding) (List1 Expr)
</span><a href="#local-6989586621681650253"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-316"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621681650254"><span class="annot"><span class="annottext">List1 Expr
</span><a href="#local-6989586621681650254"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-comment">-- It is of the form @\ { p1 ... () }@.</span><span>
</span><span id="line-318"></span><span>    </span><span id="local-6989586621681650255"><span class="annot"><a href="#local-6989586621681650255"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Attr] -&gt; Parser Erased
</span><a href="Agda.Syntax.Parser.Helpers.html#onlyErased"><span class="hs-identifier hs-var">onlyErased</span></a></span><span> </span><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650252"><span class="hs-identifier hs-var">attrs</span></a></span><span>
</span><span id="line-319"></span><span>    </span><span id="local-6989586621681650256"><span class="annot"><a href="#local-6989586621681650256"><span class="hs-identifier hs-var">cl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#mkAbsurdLamClause"><span class="hs-identifier hs-type">mkAbsurdLamClause</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621681650254"><span class="hs-identifier hs-type">es</span></a></span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#ExtendedLam"><span class="hs-identifier hs-type">ExtendedLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681650251"><span class="hs-identifier hs-type">lambdaRange</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681650255"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681650254"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681650255"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-type">singleton</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681650256"><span class="hs-identifier hs-type">cl</span></a></span><span>
</span><span id="line-321"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681650258"><span class="annot"><span class="annottext">[LamBinding]
</span><a href="#local-6989586621681650258"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681650259"><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621681650259"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><span class="annottext">(Attr -&gt; Parser ()) -&gt; [Attr] -&gt; Parser ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681650260"><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621681650260"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ParseWarning -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Monad.html#parseWarning"><span class="hs-identifier hs-var">parseWarning</span></a></span><span> </span><span class="annot"><span class="annottext">(ParseWarning -&gt; Parser ()) -&gt; ParseWarning -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-323"></span><span>                   </span><span class="annot"><span class="annottext">Range -&gt; Maybe [Char] -&gt; ParseWarning
</span><a href="Agda.Syntax.Parser.Monad.html#UnsupportedAttribute"><span class="hs-identifier hs-var">UnsupportedAttribute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attr -&gt; Range
</span><a href="Agda.Syntax.Parser.Helpers.html#attrRange"><span class="hs-identifier hs-var">attrRange</span></a></span><span> </span><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621681650260"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Attr] -&gt; [Attr]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650252"><span class="hs-identifier hs-var">attrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>    </span><span class="annot"><span class="annottext">[LamBinding]
-&gt; Parser Expr -&gt; (List1 LamBinding -&gt; Parser Expr) -&gt; Parser Expr
forall a b. [a] -&gt; b -&gt; (List1 a -&gt; b) -&gt; b
</span><a href="Agda.Utils.List1.html#ifNull"><span class="hs-identifier hs-var">List1.ifNull</span></a></span><span> </span><span class="annot"><span class="annottext">[LamBinding]
</span><a href="#local-6989586621681650258"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-326"></span><span>      </span><span class="hs-comment">{-then-}</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Parser Expr
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Parser Expr) -&gt; Expr -&gt; Parser Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Hiding -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#AbsurdLam"><span class="hs-identifier hs-var">AbsurdLam</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650263"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621681650259"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>      </span><span class="hs-comment">{-else-}</span><span> </span><span class="annot"><span class="annottext">((List1 LamBinding -&gt; Parser Expr) -&gt; Parser Expr)
-&gt; (List1 LamBinding -&gt; Parser Expr) -&gt; Parser Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681650264"><span class="annot"><span class="annottext">List1 LamBinding
</span><a href="#local-6989586621681650264"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Parser Expr
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Parser Expr) -&gt; Expr -&gt; Parser Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; List1 LamBinding -&gt; Expr -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650263"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">List1 LamBinding
</span><a href="#local-6989586621681650264"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Hiding -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#AbsurdLam"><span class="hs-identifier hs-var">AbsurdLam</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650263"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621681650259"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-329"></span><span>    </span><span id="local-6989586621681650263"><span class="annot"><span class="annottext">r :: Range
</span><a href="#local-6989586621681650263"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range -&gt; [LamBinding] -&gt; Range
forall u t. (HasRange u, HasRange t) =&gt; u -&gt; t -&gt; Range
</span><a href="Agda.Syntax.Position.html#fuseRange"><span class="hs-identifier hs-var">fuseRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650251"><span class="hs-identifier hs-var">lambdaRange</span></a></span><span> </span><span class="annot"><span class="annottext">[LamBinding]
</span><a href="#local-6989586621681650258"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="annot"><span class="hs-comment">-- | Interpret an expression as a list of names and (not parsed yet) as-patterns</span></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#exprAsNamesAndPatterns"><span class="hs-identifier hs-type">exprAsNamesAndPatterns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span id="exprAsNamesAndPatterns"><span class="annot"><span class="annottext">exprAsNamesAndPatterns :: Expr -&gt; Maybe (List1 (Name, Maybe Expr))
</span><a href="Agda.Syntax.Parser.Helpers.html#exprAsNamesAndPatterns"><span class="hs-identifier hs-var hs-var">exprAsNamesAndPatterns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Maybe (Name, Maybe Expr))
-&gt; List1 Expr -&gt; Maybe (List1 (Name, Maybe Expr))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; NonEmpty a -&gt; m (NonEmpty b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Maybe (Name, Maybe Expr)
</span><a href="Agda.Syntax.Parser.Helpers.html#exprAsNameAndPattern"><span class="hs-identifier hs-var">exprAsNameAndPattern</span></a></span><span> </span><span class="annot"><span class="annottext">(List1 Expr -&gt; Maybe (List1 (Name, Maybe Expr)))
-&gt; (Expr -&gt; List1 Expr) -&gt; Expr -&gt; Maybe (List1 (Name, Maybe Expr))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; List1 Expr
</span><a href="#local-6989586621681650269"><span class="hs-identifier hs-var">exprAsTele</span></a></span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-336"></span><span>    </span><span class="annot"><a href="#local-6989586621681650269"><span class="hs-identifier hs-type">exprAsTele</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-337"></span><span>    </span><span id="local-6989586621681650269"><span class="annot"><span class="annottext">exprAsTele :: Expr -&gt; List1 Expr
</span><a href="#local-6989586621681650269"><span class="hs-identifier hs-var hs-var">exprAsTele</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#RawApp"><span class="hs-identifier hs-type">RawApp</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681650271"><span class="annot"><span class="annottext">List2 Expr
</span><a href="#local-6989586621681650271"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">List2 Expr -&gt; List1 Expr
forall a. List2 a -&gt; List1 a
</span><a href="Agda.Utils.List2.html#toList1"><span class="hs-identifier hs-var">List2.toList1</span></a></span><span> </span><span class="annot"><span class="annottext">List2 Expr
</span><a href="#local-6989586621681650271"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-338"></span><span>    </span><span class="annot"><a href="#local-6989586621681650269"><span class="hs-identifier hs-var">exprAsTele</span></a></span><span> </span><span id="local-6989586621681650273"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650273"><span class="hs-identifier hs-var">e</span></a></span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; List1 Expr
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650273"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#exprAsNameAndPattern"><span class="hs-identifier hs-type">exprAsNameAndPattern</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span id="exprAsNameAndPattern"><span class="annot"><span class="annottext">exprAsNameAndPattern :: Expr -&gt; Maybe (Name, Maybe Expr)
</span><a href="Agda.Syntax.Parser.Helpers.html#exprAsNameAndPattern"><span class="hs-identifier hs-var hs-var">exprAsNameAndPattern</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Ident"><span class="hs-identifier hs-type">Ident</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681650275"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650275"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Maybe Expr) -&gt; Maybe (Name, Maybe Expr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650275"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Expr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#exprAsNameAndPattern"><span class="hs-identifier hs-var">exprAsNameAndPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Underscore"><span class="hs-identifier hs-type">Underscore</span></a></span><span> </span><span id="local-6989586621681650276"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650276"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Maybe Expr) -&gt; Maybe (Name, Maybe Expr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Name -&gt; Name
forall a. SetRange a =&gt; Range -&gt; a -&gt; a
</span><a href="Agda.Syntax.Position.html#setRange"><span class="hs-identifier hs-var">setRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650276"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Agda.Syntax.Concrete.Name.html#simpleHole"><span class="hs-identifier hs-var">simpleHole</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Expr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#exprAsNameAndPattern"><span class="hs-identifier hs-var">exprAsNameAndPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#As"><span class="hs-identifier hs-type">As</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681650280"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650280"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681650281"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650281"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Maybe Expr) -&gt; Maybe (Name, Maybe Expr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650280"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Maybe Expr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650281"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#exprAsNameAndPattern"><span class="hs-identifier hs-var">exprAsNameAndPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Paren"><span class="hs-identifier hs-type">Paren</span></a></span><span> </span><span id="local-6989586621681650283"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650283"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681650284"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650284"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Maybe Expr) -&gt; Maybe (Name, Maybe Expr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Name -&gt; Name
forall a. SetRange a =&gt; Range -&gt; a -&gt; a
</span><a href="Agda.Syntax.Position.html#setRange"><span class="hs-identifier hs-var">setRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650283"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Agda.Syntax.Concrete.Name.html#simpleHole"><span class="hs-identifier hs-var">simpleHole</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Maybe Expr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650284"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#exprAsNameAndPattern"><span class="hs-identifier hs-var">exprAsNameAndPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Name, Maybe Expr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="hs-comment">-- interpret an expression as name or list of hidden / instance names</span><span>
</span><span id="line-348"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#exprAsNameOrHiddenNames"><span class="hs-identifier hs-type">exprAsNameOrHiddenNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span id="exprAsNameOrHiddenNames"><span class="annot"><span class="annottext">exprAsNameOrHiddenNames :: Expr -&gt; Maybe (List1 (NamedArg (Name, Maybe Expr)))
</span><a href="Agda.Syntax.Parser.Helpers.html#exprAsNameOrHiddenNames"><span class="hs-identifier hs-var hs-var">exprAsNameOrHiddenNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-350"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Concrete.html#HiddenArg"><span class="hs-identifier hs-type">HiddenArg</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamedName
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621681650287"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650287"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-351"></span><span>    </span><span class="annot"><span class="annottext">((Name, Maybe Expr) -&gt; NamedArg (Name, Maybe Expr))
-&gt; List1 (Name, Maybe Expr) -&gt; List1 (NamedArg (Name, Maybe Expr))
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedArg (Name, Maybe Expr) -&gt; NamedArg (Name, Maybe Expr)
forall a. LensHiding a =&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#hide"><span class="hs-identifier hs-var">hide</span></a></span><span> </span><span class="annot"><span class="annottext">(NamedArg (Name, Maybe Expr) -&gt; NamedArg (Name, Maybe Expr))
-&gt; ((Name, Maybe Expr) -&gt; NamedArg (Name, Maybe Expr))
-&gt; (Name, Maybe Expr)
-&gt; NamedArg (Name, Maybe Expr)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Name, Maybe Expr) -&gt; NamedArg (Name, Maybe Expr)
forall a. a -&gt; NamedArg a
</span><a href="Agda.Syntax.Common.html#defaultNamedArg"><span class="hs-identifier hs-var">defaultNamedArg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(List1 (Name, Maybe Expr) -&gt; List1 (NamedArg (Name, Maybe Expr)))
-&gt; Maybe (List1 (Name, Maybe Expr))
-&gt; Maybe (List1 (NamedArg (Name, Maybe Expr)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Maybe (List1 (Name, Maybe Expr))
</span><a href="Agda.Syntax.Parser.Helpers.html#exprAsNamesAndPatterns"><span class="hs-identifier hs-var">exprAsNamesAndPatterns</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650287"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-352"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Concrete.html#InstanceArg"><span class="hs-identifier hs-type">InstanceArg</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamedName
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621681650290"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650290"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-353"></span><span>    </span><span class="annot"><span class="annottext">((Name, Maybe Expr) -&gt; NamedArg (Name, Maybe Expr))
-&gt; List1 (Name, Maybe Expr) -&gt; List1 (NamedArg (Name, Maybe Expr))
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedArg (Name, Maybe Expr) -&gt; NamedArg (Name, Maybe Expr)
forall a. LensHiding a =&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#makeInstance"><span class="hs-identifier hs-var">makeInstance</span></a></span><span> </span><span class="annot"><span class="annottext">(NamedArg (Name, Maybe Expr) -&gt; NamedArg (Name, Maybe Expr))
-&gt; ((Name, Maybe Expr) -&gt; NamedArg (Name, Maybe Expr))
-&gt; (Name, Maybe Expr)
-&gt; NamedArg (Name, Maybe Expr)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Name, Maybe Expr) -&gt; NamedArg (Name, Maybe Expr)
forall a. a -&gt; NamedArg a
</span><a href="Agda.Syntax.Common.html#defaultNamedArg"><span class="hs-identifier hs-var">defaultNamedArg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(List1 (Name, Maybe Expr) -&gt; List1 (NamedArg (Name, Maybe Expr)))
-&gt; Maybe (List1 (Name, Maybe Expr))
-&gt; Maybe (List1 (NamedArg (Name, Maybe Expr)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Maybe (List1 (Name, Maybe Expr))
</span><a href="Agda.Syntax.Parser.Helpers.html#exprAsNamesAndPatterns"><span class="hs-identifier hs-var">exprAsNamesAndPatterns</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650290"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-354"></span><span>  </span><span id="local-6989586621681650292"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650292"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-355"></span><span>    </span><span class="annot"><span class="annottext">NamedArg (Name, Maybe Expr) -&gt; List1 (NamedArg (Name, Maybe Expr))
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">(NamedArg (Name, Maybe Expr)
 -&gt; List1 (NamedArg (Name, Maybe Expr)))
-&gt; ((Name, Maybe Expr) -&gt; NamedArg (Name, Maybe Expr))
-&gt; (Name, Maybe Expr)
-&gt; List1 (NamedArg (Name, Maybe Expr))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Name, Maybe Expr) -&gt; NamedArg (Name, Maybe Expr)
forall a. a -&gt; NamedArg a
</span><a href="Agda.Syntax.Common.html#defaultNamedArg"><span class="hs-identifier hs-var">defaultNamedArg</span></a></span><span> </span><span class="annot"><span class="annottext">((Name, Maybe Expr) -&gt; List1 (NamedArg (Name, Maybe Expr)))
-&gt; Maybe (Name, Maybe Expr)
-&gt; Maybe (List1 (NamedArg (Name, Maybe Expr)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Maybe (Name, Maybe Expr)
</span><a href="Agda.Syntax.Parser.Helpers.html#exprAsNameAndPattern"><span class="hs-identifier hs-var">exprAsNameAndPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650292"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#boundNamesOrAbsurd"><span class="hs-identifier hs-type">boundNamesOrAbsurd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span id="boundNamesOrAbsurd"><span class="annot"><span class="annottext">boundNamesOrAbsurd :: List1 Expr
-&gt; Parser (Either (List1 (NamedArg Binder)) (List1 Expr))
</span><a href="Agda.Syntax.Parser.Helpers.html#boundNamesOrAbsurd"><span class="hs-identifier hs-var hs-var">boundNamesOrAbsurd</span></a></span></span><span> </span><span id="local-6989586621681650294"><span class="annot"><span class="annottext">List1 Expr
</span><a href="#local-6989586621681650294"><span class="hs-identifier hs-var">es</span></a></span></span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Bool) -&gt; List1 Expr -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Bool
</span><a href="#local-6989586621681650296"><span class="hs-identifier hs-var">isAbsurd</span></a></span><span> </span><span class="annot"><span class="annottext">List1 Expr
</span><a href="#local-6989586621681650294"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either (List1 (NamedArg Binder)) (List1 Expr)
-&gt; Parser (Either (List1 (NamedArg Binder)) (List1 Expr))
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either (List1 (NamedArg Binder)) (List1 Expr)
 -&gt; Parser (Either (List1 (NamedArg Binder)) (List1 Expr)))
-&gt; Either (List1 (NamedArg Binder)) (List1 Expr)
-&gt; Parser (Either (List1 (NamedArg Binder)) (List1 Expr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">List1 Expr -&gt; Either (List1 (NamedArg Binder)) (List1 Expr)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">List1 Expr
</span><a href="#local-6989586621681650294"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-360"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>       </span><span class="hs-glyph">=</span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Maybe (Name, Maybe Expr))
-&gt; List1 Expr -&gt; Maybe (List1 (Name, Maybe Expr))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; NonEmpty a -&gt; m (NonEmpty b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Maybe (Name, Maybe Expr)
</span><a href="Agda.Syntax.Parser.Helpers.html#exprAsNameAndPattern"><span class="hs-identifier hs-var">exprAsNameAndPattern</span></a></span><span> </span><span class="annot"><span class="annottext">List1 Expr
</span><a href="#local-6989586621681650294"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-362"></span><span>        </span><span class="annot"><span class="annottext">Maybe (List1 (Name, Maybe Expr))
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (Either (List1 (NamedArg Binder)) (List1 Expr))
forall a. [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier hs-var">parseError</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser (Either (List1 (NamedArg Binder)) (List1 Expr)))
-&gt; [Char] -&gt; Parser (Either (List1 (NamedArg Binder)) (List1 Expr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;expected sequence of bound identifiers&quot;</span></span><span>
</span><span id="line-363"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681650297"><span class="annot"><span class="annottext">List1 (Name, Maybe Expr)
</span><a href="#local-6989586621681650297"><span class="hs-identifier hs-var">good</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(List1 (NamedArg Binder)
 -&gt; Either (List1 (NamedArg Binder)) (List1 Expr))
-&gt; Parser (List1 (NamedArg Binder))
-&gt; Parser (Either (List1 (NamedArg Binder)) (List1 Expr))
forall a b. (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">List1 (NamedArg Binder)
-&gt; Either (List1 (NamedArg Binder)) (List1 Expr)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Parser (List1 (NamedArg Binder))
 -&gt; Parser (Either (List1 (NamedArg Binder)) (List1 Expr)))
-&gt; Parser (List1 (NamedArg Binder))
-&gt; Parser (Either (List1 (NamedArg Binder)) (List1 Expr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">List1 (Name, Maybe Expr)
-&gt; ((Name, Maybe Expr) -&gt; Parser (NamedArg Binder))
-&gt; Parser (List1 (NamedArg Binder))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">List1 (Name, Maybe Expr)
</span><a href="#local-6989586621681650297"><span class="hs-identifier hs-var">good</span></a></span><span> </span><span class="annot"><span class="annottext">(((Name, Maybe Expr) -&gt; Parser (NamedArg Binder))
 -&gt; Parser (List1 (NamedArg Binder)))
-&gt; ((Name, Maybe Expr) -&gt; Parser (NamedArg Binder))
-&gt; Parser (List1 (NamedArg Binder))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681650299"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650299"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681650300"><span class="annot"><span class="annottext">Maybe Expr
</span><a href="#local-6989586621681650300"><span class="hs-identifier hs-var">me</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-364"></span><span>                       </span><span id="local-6989586621681650301"><span class="annot"><a href="#local-6989586621681650301"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Parser Pattern) -&gt; Maybe Expr -&gt; Parser (Maybe Pattern)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Maybe a -&gt; f (Maybe b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Parser Pattern
</span><a href="Agda.Syntax.Parser.Helpers.html#exprToPattern"><span class="hs-identifier hs-var">exprToPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Expr
</span><a href="#local-6989586621681650300"><span class="hs-identifier hs-var">me</span></a></span><span>
</span><span id="line-365"></span><span>                       </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#defaultNamedArg"><span class="hs-identifier hs-type">defaultNamedArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681650301"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#UserBinderName"><span class="hs-identifier hs-type">UserBinderName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#mkBoundName_"><span class="hs-identifier hs-type">mkBoundName_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681650299"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span>    </span><span class="annot"><a href="#local-6989586621681650296"><span class="hs-identifier hs-type">isAbsurd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-370"></span><span>    </span><span id="local-6989586621681650296"><span class="annot"><span class="annottext">isAbsurd :: Expr -&gt; Bool
</span><a href="#local-6989586621681650296"><span class="hs-identifier hs-var hs-var">isAbsurd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Absurd"><span class="hs-identifier hs-type">Absurd</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-371"></span><span>    </span><span class="annot"><a href="#local-6989586621681650296"><span class="hs-identifier hs-var">isAbsurd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#HiddenArg"><span class="hs-identifier hs-type">HiddenArg</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamedName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681650305"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650305"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Bool
</span><a href="#local-6989586621681650296"><span class="hs-identifier hs-var">isAbsurd</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650305"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-372"></span><span>    </span><span class="annot"><a href="#local-6989586621681650296"><span class="hs-identifier hs-var">isAbsurd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#InstanceArg"><span class="hs-identifier hs-type">InstanceArg</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamedName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681650306"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650306"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Bool
</span><a href="#local-6989586621681650296"><span class="hs-identifier hs-var">isAbsurd</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650306"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span class="annot"><a href="#local-6989586621681650296"><span class="hs-identifier hs-var">isAbsurd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Paren"><span class="hs-identifier hs-type">Paren</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681650307"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650307"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Bool
</span><a href="#local-6989586621681650296"><span class="hs-identifier hs-var">isAbsurd</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650307"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-374"></span><span>    </span><span class="annot"><a href="#local-6989586621681650296"><span class="hs-identifier hs-var">isAbsurd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#As"><span class="hs-identifier hs-type">As</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681650308"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650308"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Bool
</span><a href="#local-6989586621681650296"><span class="hs-identifier hs-var">isAbsurd</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650308"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-375"></span><span>    </span><span class="annot"><a href="#local-6989586621681650296"><span class="hs-identifier hs-var">isAbsurd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#RawApp"><span class="hs-identifier hs-type">RawApp</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681650309"><span class="annot"><span class="annottext">List2 Expr
</span><a href="#local-6989586621681650309"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Bool) -&gt; List2 Expr -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Bool
</span><a href="#local-6989586621681650296"><span class="hs-identifier hs-var">isAbsurd</span></a></span><span> </span><span class="annot"><span class="annottext">List2 Expr
</span><a href="#local-6989586621681650309"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-376"></span><span>    </span><span class="annot"><a href="#local-6989586621681650296"><span class="hs-identifier hs-var">isAbsurd</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="annot"><span class="hs-comment">-- | Match a pattern-matching &quot;assignment&quot; statement @p &lt;- e@</span></span><span>
</span><span id="line-379"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#exprToAssignment"><span class="hs-identifier hs-type">exprToAssignment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span id="exprToAssignment"><span class="annot"><span class="annottext">exprToAssignment :: Expr -&gt; Parser (Maybe (Pattern, Range, Expr))
</span><a href="Agda.Syntax.Parser.Helpers.html#exprToAssignment"><span class="hs-identifier hs-var hs-var">exprToAssignment</span></a></span></span><span> </span><span id="local-6989586621681650311"><span class="annot"><span class="annottext">e :: Expr
</span><a href="#local-6989586621681650311"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#RawApp"><span class="hs-identifier hs-type">RawApp</span></a></span><span> </span><span id="local-6989586621681650312"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650312"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681650313"><span class="annot"><span class="annottext">List2 Expr
</span><a href="#local-6989586621681650313"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681650314"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621681650314"><span class="hs-identifier hs-var">es1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681650315"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650315"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681650316"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621681650316"><span class="hs-identifier hs-var">es2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Bool) -&gt; List2 Expr -&gt; ([Expr], [Expr])
forall a. (a -&gt; Bool) -&gt; List2 a -&gt; ([a], [a])
</span><a href="Agda.Utils.List2.html#break"><span class="hs-identifier hs-var">List2.break</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Bool
</span><a href="#local-6989586621681650318"><span class="hs-identifier hs-var">isLeftArrow</span></a></span><span> </span><span class="annot"><span class="annottext">List2 Expr
</span><a href="#local-6989586621681650313"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-382"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Bool) -&gt; [Expr] -&gt; [Expr]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Bool
</span><a href="#local-6989586621681650318"><span class="hs-identifier hs-var">isLeftArrow</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621681650316"><span class="hs-identifier hs-var">es2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-383"></span><span>      </span><span id="local-6989586621681650319"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650319"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe PositionWithoutFile
-&gt; [Char] -&gt; Parser (Maybe (Pattern, Range, Expr))
forall a. Maybe PositionWithoutFile -&gt; [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError%27"><span class="hs-identifier hs-var">parseError'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Maybe PositionWithoutFile
forall a. Range' a -&gt; Maybe PositionWithoutFile
</span><a href="Agda.Syntax.Position.html#rStart%27"><span class="hs-identifier hs-var">rStart'</span></a></span><span> </span><span class="annot"><span class="annottext">(Range -&gt; Maybe PositionWithoutFile)
-&gt; Range -&gt; Maybe PositionWithoutFile
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650319"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser (Maybe (Pattern, Range, Expr)))
-&gt; [Char] -&gt; Parser (Maybe (Pattern, Range, Expr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unexpected &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650319"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-384"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-385"></span><span>        </span><span class="hs-comment">-- Andreas, 2021-05-06, issue #5365</span><span>
</span><span id="line-386"></span><span>        </span><span class="hs-comment">-- Handle pathological cases like @do &lt;-@ and @do x &lt;-@.</span><span>
</span><span id="line-387"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621681650314"><span class="hs-identifier hs-var">es1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621681650316"><span class="hs-identifier hs-var">es2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-388"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621681650320"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650320"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681650321"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621681650321"><span class="hs-identifier hs-var">rest1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681650322"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650322"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681650323"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621681650323"><span class="hs-identifier hs-var">rest2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-389"></span><span>            </span><span id="local-6989586621681650324"><span class="annot"><a href="#local-6989586621681650324"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Parser Pattern
</span><a href="Agda.Syntax.Parser.Helpers.html#exprToPattern"><span class="hs-identifier hs-var">exprToPattern</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Parser Pattern) -&gt; Expr -&gt; Parser Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">List1 Expr -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#rawApp"><span class="hs-identifier hs-var">rawApp</span></a></span><span> </span><span class="annot"><span class="annottext">(List1 Expr -&gt; Expr) -&gt; List1 Expr -&gt; Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650320"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; [Expr] -&gt; List1 Expr
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621681650321"><span class="hs-identifier hs-var">rest1</span></a></span><span>
</span><span id="line-390"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681650324"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-type">getRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681650315"><span class="hs-identifier hs-type">arr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#rawApp"><span class="hs-identifier hs-type">rawApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681650322"><span class="hs-identifier hs-type">e2</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="annot"><a href="#local-6989586621681650323"><span class="hs-identifier hs-type">rest2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>          </span><span class="annot"><span class="annottext">([Expr], [Expr])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe PositionWithoutFile
-&gt; [Char] -&gt; Parser (Maybe (Pattern, Range, Expr))
forall a. Maybe PositionWithoutFile -&gt; [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError%27"><span class="hs-identifier hs-var">parseError'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Maybe PositionWithoutFile
forall a. Range' a -&gt; Maybe PositionWithoutFile
</span><a href="Agda.Syntax.Position.html#rStart%27"><span class="hs-identifier hs-var">rStart'</span></a></span><span> </span><span class="annot"><span class="annottext">(Range -&gt; Maybe PositionWithoutFile)
-&gt; Range -&gt; Maybe PositionWithoutFile
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650311"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser (Maybe (Pattern, Range, Expr)))
-&gt; [Char] -&gt; Parser (Maybe (Pattern, Range, Expr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Incomplete binding &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650311"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-393"></span><span>    </span><span id="local-6989586621681650318"><span class="annot"><span class="annottext">isLeftArrow :: Expr -&gt; Bool
</span><a href="#local-6989586621681650318"><span class="hs-identifier hs-var hs-var">isLeftArrow</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Ident"><span class="hs-identifier hs-type">Ident</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span id="local-6989586621681650332"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650332"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-394"></span><span>      </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650332"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\x2190&quot;</span></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- \leftarrow [issue #5465, unicode might crash happy]</span><span>
</span><span id="line-395"></span><span>    </span><span class="annot"><a href="#local-6989586621681650318"><span class="hs-identifier hs-var">isLeftArrow</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-396"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#exprToAssignment"><span class="hs-identifier hs-var">exprToAssignment</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Pattern, Range, Expr)
-&gt; Parser (Maybe (Pattern, Range, Expr))
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Pattern, Range, Expr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="annot"><span class="hs-comment">-- | Build a with-block</span></span><span>
</span><span id="line-399"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#buildWithBlock"><span class="hs-identifier hs-type">buildWithBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RewriteEqn"><span class="hs-identifier hs-type">RewriteEqn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-401"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#RewriteEqn"><span class="hs-identifier hs-type">RewriteEqn</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span id="buildWithBlock"><span class="annot"><span class="annottext">buildWithBlock :: [Either RewriteEqn (List1 (Named Name Expr))]
-&gt; Parser ([RewriteEqn], [Named Name Expr])
</span><a href="Agda.Syntax.Parser.Helpers.html#buildWithBlock"><span class="hs-identifier hs-var hs-var">buildWithBlock</span></a></span></span><span> </span><span id="local-6989586621681650335"><span class="annot"><span class="annottext">[Either RewriteEqn (List1 (Named Name Expr))]
</span><a href="#local-6989586621681650335"><span class="hs-identifier hs-var">rees</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Either RewriteEqn (List1 (Named Name Expr))]
-&gt; [Either (List1 RewriteEqn) (List1 (List1 (Named Name Expr)))]
forall a b. [Either a b] -&gt; [Either (List1 a) (List1 b)]
</span><a href="Agda.Utils.Either.html#groupByEither"><span class="hs-identifier hs-var">groupByEither</span></a></span><span> </span><span class="annot"><span class="annottext">[Either RewriteEqn (List1 (Named Name Expr))]
</span><a href="#local-6989586621681650335"><span class="hs-identifier hs-var">rees</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621681650337"><span class="annot"><span class="annottext">List1 RewriteEqn
</span><a href="#local-6989586621681650337"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681650338"><span class="annot"><span class="annottext">[Either (List1 RewriteEqn) (List1 (List1 (Named Name Expr)))]
</span><a href="#local-6989586621681650338"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">List1 RewriteEqn -&gt; [Item (List1 RewriteEqn)]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">List1.toList</span></span><span> </span><span class="annot"><span class="annottext">List1 RewriteEqn
</span><a href="#local-6989586621681650337"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Named Name Expr] -&gt; ([RewriteEqn], [Named Name Expr]))
-&gt; Parser [Named Name Expr]
-&gt; Parser ([RewriteEqn], [Named Name Expr])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Either (List1 RewriteEqn) (List1 (List1 (Named Name Expr)))]
-&gt; Parser [Named Name Expr]
forall a b.
(HasRange a, HasRange b) =&gt;
[Either (List1 a) (List1 (List1 b))] -&gt; Parser [b]
</span><a href="#local-6989586621681650339"><span class="hs-identifier hs-var">finalWith</span></a></span><span> </span><span class="annot"><span class="annottext">[Either (List1 RewriteEqn) (List1 (List1 (Named Name Expr)))]
</span><a href="#local-6989586621681650338"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-404"></span><span>  </span><span id="local-6989586621681650340"><span class="annot"><span class="annottext">[Either (List1 RewriteEqn) (List1 (List1 (Named Name Expr)))]
</span><a href="#local-6989586621681650340"><span class="hs-identifier hs-var">rest</span></a></span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Named Name Expr] -&gt; ([RewriteEqn], [Named Name Expr]))
-&gt; Parser [Named Name Expr]
-&gt; Parser ([RewriteEqn], [Named Name Expr])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Either (List1 RewriteEqn) (List1 (List1 (Named Name Expr)))]
-&gt; Parser [Named Name Expr]
forall a b.
(HasRange a, HasRange b) =&gt;
[Either (List1 a) (List1 (List1 b))] -&gt; Parser [b]
</span><a href="#local-6989586621681650339"><span class="hs-identifier hs-var">finalWith</span></a></span><span> </span><span class="annot"><span class="annottext">[Either (List1 RewriteEqn) (List1 (List1 (Named Name Expr)))]
</span><a href="#local-6989586621681650340"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span>    </span><span id="local-6989586621681649504"><span id="local-6989586621681649505"><span class="annot"><a href="#local-6989586621681650339"><span class="hs-identifier hs-type">finalWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#HasRange"><span class="hs-identifier hs-type">HasRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681649504"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#HasRange"><span class="hs-identifier hs-type">HasRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681649505"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-409"></span><span>                 </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681649504"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681649505"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681649505"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-410"></span><span>    </span><span id="local-6989586621681650339"><span class="annot"><span class="annottext">finalWith :: forall a b.
(HasRange a, HasRange b) =&gt;
[Either (List1 a) (List1 (List1 b))] -&gt; Parser [b]
</span><a href="#local-6989586621681650339"><span class="hs-identifier hs-var hs-var">finalWith</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[b] -&gt; Parser [b]
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([b] -&gt; Parser [b]) -&gt; [b] -&gt; Parser [b]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-411"></span><span>    </span><span class="annot"><a href="#local-6989586621681650339"><span class="hs-identifier hs-var">finalWith</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621681650355"><span class="annot"><span class="annottext">List1 (List1 b)
</span><a href="#local-6989586621681650355"><span class="hs-identifier hs-var">ees</span></a></span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[b] -&gt; Parser [b]
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([b] -&gt; Parser [b]) -&gt; [b] -&gt; Parser [b]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">List1 b -&gt; [Item (List1 b)]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">List1.toList</span></span><span> </span><span class="annot"><span class="annottext">(List1 b -&gt; [Item (List1 b)]) -&gt; List1 b -&gt; [Item (List1 b)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">List1 (List1 b) -&gt; List1 b
forall a. Semigroup a =&gt; NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">sconcat</span></span><span> </span><span class="annot"><span class="annottext">List1 (List1 b)
</span><a href="#local-6989586621681650355"><span class="hs-identifier hs-var">ees</span></a></span><span>
</span><span id="line-412"></span><span>    </span><span class="annot"><a href="#local-6989586621681650339"><span class="hs-identifier hs-var">finalWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681650356"><span class="annot"><span class="annottext">[Either (List1 a) (List1 (List1 b))]
</span><a href="#local-6989586621681650356"><span class="hs-identifier hs-var">tl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PositionWithoutFile -&gt; [Char] -&gt; Parser [b]
forall a. Maybe PositionWithoutFile -&gt; [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError%27"><span class="hs-identifier hs-var">parseError'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Maybe PositionWithoutFile
forall a. Range' a -&gt; Maybe PositionWithoutFile
</span><a href="Agda.Syntax.Position.html#rStart%27"><span class="hs-identifier hs-var">rStart'</span></a></span><span> </span><span class="annot"><span class="annottext">(Range -&gt; Maybe PositionWithoutFile)
-&gt; Range -&gt; Maybe PositionWithoutFile
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Either (List1 a) (List1 (List1 b))] -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">[Either (List1 a) (List1 (List1 b))]
</span><a href="#local-6989586621681650356"><span class="hs-identifier hs-var">tl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span>      </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Cannot use rewrite / pattern-matching with after a with-abstraction.&quot;</span></span><span>
</span><span id="line-414"></span><span>    </span><span class="annot"><a href="#local-6989586621681650339"><span class="hs-identifier hs-var">finalWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Either (List1 a) (List1 (List1 b))]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser [b]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="annot"><span class="hs-comment">-- | Build a with-statement</span></span><span>
</span><span id="line-417"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#buildWithStmt"><span class="hs-identifier hs-type">buildWithStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-418"></span><span>                 </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RewriteEqn"><span class="hs-identifier hs-type">RewriteEqn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-419"></span><span id="buildWithStmt"><span class="annot"><span class="annottext">buildWithStmt :: List1 (Named Name Expr)
-&gt; Parser [Either RewriteEqn (List1 (Named Name Expr))]
</span><a href="Agda.Syntax.Parser.Helpers.html#buildWithStmt"><span class="hs-identifier hs-var hs-var">buildWithStmt</span></a></span></span><span> </span><span id="local-6989586621681650358"><span class="annot"><span class="annottext">List1 (Named Name Expr)
</span><a href="#local-6989586621681650358"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-420"></span><span>  </span><span id="local-6989586621681650359"><span class="annot"><a href="#local-6989586621681650359"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Named Name Expr
 -&gt; Parser (Either (Named Name (Pattern, Expr)) (Named Name Expr)))
-&gt; [Named Name Expr]
-&gt; Parser [Either (Named Name (Pattern, Expr)) (Named Name Expr)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Named Name Expr
-&gt; Parser (Either (Named Name (Pattern, Expr)) (Named Name Expr))
</span><a href="Agda.Syntax.Parser.Helpers.html#buildSingleWithStmt"><span class="hs-identifier hs-var">buildSingleWithStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">List1 (Named Name Expr) -&gt; [Item (List1 (Named Name Expr))]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">List1.toList</span></span><span> </span><span class="annot"><span class="annottext">List1 (Named Name Expr)
</span><a href="#local-6989586621681650358"><span class="hs-identifier hs-var">nes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681650361"><span class="annot"><a href="#local-6989586621681650361"><span class="hs-identifier hs-var hs-var">rws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either (Named Name (Pattern, Expr)) (Named Name Expr)]
-&gt; [Either
      (List1 (Named Name (Pattern, Expr))) (List1 (Named Name Expr))]
forall a b. [Either a b] -&gt; [Either (List1 a) (List1 b)]
</span><a href="Agda.Utils.Either.html#groupByEither"><span class="hs-identifier hs-var">groupByEither</span></a></span><span> </span><span class="annot"><span class="annottext">[Either (Named Name (Pattern, Expr)) (Named Name Expr)]
</span><a href="#local-6989586621681650359"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-422"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Invert"><span class="hs-identifier hs-type">Invert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681650361"><span class="hs-identifier hs-type">rws</span></a></span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#buildUsingStmt"><span class="hs-identifier hs-type">buildUsingStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RewriteEqn"><span class="hs-identifier hs-type">RewriteEqn</span></a></span><span>
</span><span id="line-425"></span><span id="buildUsingStmt"><span class="annot"><span class="annottext">buildUsingStmt :: List1 Expr -&gt; Parser RewriteEqn
</span><a href="Agda.Syntax.Parser.Helpers.html#buildUsingStmt"><span class="hs-identifier hs-var hs-var">buildUsingStmt</span></a></span></span><span> </span><span id="local-6989586621681650364"><span class="annot"><span class="annottext">List1 Expr
</span><a href="#local-6989586621681650364"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-426"></span><span>  </span><span id="local-6989586621681650365"><span class="annot"><a href="#local-6989586621681650365"><span class="hs-identifier hs-var">mpatexprs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Parser (Maybe (Pattern, Range, Expr)))
-&gt; List1 Expr -&gt; Parser (NonEmpty (Maybe (Pattern, Range, Expr)))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; NonEmpty a -&gt; m (NonEmpty b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Parser (Maybe (Pattern, Range, Expr))
</span><a href="Agda.Syntax.Parser.Helpers.html#exprToAssignment"><span class="hs-identifier hs-var">exprToAssignment</span></a></span><span> </span><span class="annot"><span class="annottext">List1 Expr
</span><a href="#local-6989586621681650364"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-427"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fmap</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621681650366"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681650366"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681650367"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650367"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681650366"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650367"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681650365"><span class="hs-identifier hs-type">mpatexprs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-428"></span><span>    </span><span class="annot"><span class="annottext">Maybe (NonEmpty (Pattern, Expr))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe PositionWithoutFile -&gt; [Char] -&gt; Parser RewriteEqn
forall a. Maybe PositionWithoutFile -&gt; [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError%27"><span class="hs-identifier hs-var">parseError'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Maybe PositionWithoutFile
forall a. Range' a -&gt; Maybe PositionWithoutFile
</span><a href="Agda.Syntax.Position.html#rStart%27"><span class="hs-identifier hs-var">rStart'</span></a></span><span> </span><span class="annot"><span class="annottext">(Range -&gt; Maybe PositionWithoutFile)
-&gt; Range -&gt; Maybe PositionWithoutFile
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">List1 Expr -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">List1 Expr
</span><a href="#local-6989586621681650364"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Expected assignments&quot;</span></span><span>
</span><span id="line-429"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681650368"><span class="annot"><span class="annottext">NonEmpty (Pattern, Expr)
</span><a href="#local-6989586621681650368"><span class="hs-identifier hs-var">assignments</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RewriteEqn -&gt; Parser RewriteEqn
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(RewriteEqn -&gt; Parser RewriteEqn)
-&gt; RewriteEqn -&gt; Parser RewriteEqn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Pattern, Expr) -&gt; RewriteEqn
forall qn nm p e. List1 (p, e) -&gt; RewriteEqn' qn nm p e
</span><a href="Agda.Syntax.Common.html#LeftLet"><span class="hs-identifier hs-var">LeftLet</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Pattern, Expr)
</span><a href="#local-6989586621681650368"><span class="hs-identifier hs-var">assignments</span></a></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#buildSingleWithStmt"><span class="hs-identifier hs-type">buildSingleWithStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-432"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-433"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span id="buildSingleWithStmt"><span class="annot"><span class="annottext">buildSingleWithStmt :: Named Name Expr
-&gt; Parser (Either (Named Name (Pattern, Expr)) (Named Name Expr))
</span><a href="Agda.Syntax.Parser.Helpers.html#buildSingleWithStmt"><span class="hs-identifier hs-var hs-var">buildSingleWithStmt</span></a></span></span><span> </span><span id="local-6989586621681650370"><span class="annot"><span class="annottext">Named Name Expr
</span><a href="#local-6989586621681650370"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-435"></span><span>  </span><span id="local-6989586621681650371"><span class="annot"><a href="#local-6989586621681650371"><span class="hs-identifier hs-var">mpatexpr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Parser (Maybe (Pattern, Range, Expr))
</span><a href="Agda.Syntax.Parser.Helpers.html#exprToAssignment"><span class="hs-identifier hs-var">exprToAssignment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Named Name Expr -&gt; Expr
forall name a. Named name a -&gt; a
</span><a href="Agda.Syntax.Common.html#namedThing"><span class="hs-identifier hs-var">namedThing</span></a></span><span> </span><span class="annot"><span class="annottext">Named Name Expr
</span><a href="#local-6989586621681650370"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621681650371"><span class="hs-identifier hs-type">mpatexpr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-437"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681650373"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681650373"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681650374"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650374"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Named Name (Pattern, Expr)
-&gt; Either (Named Name (Pattern, Expr)) (Named Name Expr)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681650373"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650374"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Pattern, Expr) -&gt; Named Name Expr -&gt; Named Name (Pattern, Expr)
forall a b. a -&gt; Named Name b -&gt; Named Name a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Named Name Expr
</span><a href="#local-6989586621681650370"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Pattern, Range, Expr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Named Name Expr
-&gt; Either (Named Name (Pattern, Expr)) (Named Name Expr)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Named Name Expr
</span><a href="#local-6989586621681650370"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="annot"><span class="hs-comment">-- | Build a do-statement</span></span><span>
</span><span id="line-441"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#defaultBuildDoStmt"><span class="hs-identifier hs-type">defaultBuildDoStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#LamClause"><span class="hs-identifier hs-type">LamClause</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#DoStmt"><span class="hs-identifier hs-type">DoStmt</span></a></span><span>
</span><span id="line-442"></span><span id="defaultBuildDoStmt"><span class="annot"><span class="annottext">defaultBuildDoStmt :: Expr -&gt; [LamClause] -&gt; Parser DoStmt
</span><a href="Agda.Syntax.Parser.Helpers.html#defaultBuildDoStmt"><span class="hs-identifier hs-var hs-var">defaultBuildDoStmt</span></a></span></span><span> </span><span id="local-6989586621681650376"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650376"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LamClause
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[LamClause]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PositionWithoutFile -&gt; [Char] -&gt; Parser DoStmt
forall a. Maybe PositionWithoutFile -&gt; [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError%27"><span class="hs-identifier hs-var">parseError'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Maybe PositionWithoutFile
forall a. Range' a -&gt; Maybe PositionWithoutFile
</span><a href="Agda.Syntax.Position.html#rStart%27"><span class="hs-identifier hs-var">rStart'</span></a></span><span> </span><span class="annot"><span class="annottext">(Range -&gt; Maybe PositionWithoutFile)
-&gt; Range -&gt; Maybe PositionWithoutFile
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650376"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Only pattern matching do-statements can have where clauses.&quot;</span></span><span>
</span><span id="line-443"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#defaultBuildDoStmt"><span class="hs-identifier hs-var">defaultBuildDoStmt</span></a></span><span> </span><span id="local-6989586621681650377"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650377"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DoStmt -&gt; Parser DoStmt
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(DoStmt -&gt; Parser DoStmt) -&gt; DoStmt -&gt; Parser DoStmt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; DoStmt
</span><a href="Agda.Syntax.Concrete.html#DoThen"><span class="hs-identifier hs-var">DoThen</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650377"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#buildDoStmt"><span class="hs-identifier hs-type">buildDoStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#LamClause"><span class="hs-identifier hs-type">LamClause</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#DoStmt"><span class="hs-identifier hs-type">DoStmt</span></a></span><span>
</span><span id="line-446"></span><span id="buildDoStmt"><span class="annot"><span class="annottext">buildDoStmt :: Expr -&gt; [LamClause] -&gt; Parser DoStmt
</span><a href="Agda.Syntax.Parser.Helpers.html#buildDoStmt"><span class="hs-identifier hs-var hs-var">buildDoStmt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621681650381"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650381"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681650382"><span class="annot"><span class="annottext">List1 Declaration
</span><a href="#local-6989586621681650382"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Expr
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DoStmt -&gt; Parser DoStmt
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DoStmt -&gt; Parser DoStmt) -&gt; DoStmt -&gt; Parser DoStmt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; List1 Declaration -&gt; DoStmt
</span><a href="Agda.Syntax.Concrete.html#DoLet"><span class="hs-identifier hs-var">DoLet</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650381"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">List1 Declaration
</span><a href="#local-6989586621681650382"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-447"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#buildDoStmt"><span class="hs-identifier hs-var">buildDoStmt</span></a></span><span> </span><span id="local-6989586621681650384"><span class="annot"><span class="annottext">e :: Expr
</span><a href="#local-6989586621681650384"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#RawApp"><span class="hs-identifier hs-type">RawApp</span></a></span><span> </span><span id="local-6989586621681650385"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650385"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">List2 Expr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span id="local-6989586621681650386"><span class="annot"><span class="annottext">[LamClause]
</span><a href="#local-6989586621681650386"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-448"></span><span>  </span><span id="local-6989586621681650387"><span class="annot"><a href="#local-6989586621681650387"><span class="hs-identifier hs-var">mpatexpr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Parser (Maybe (Pattern, Range, Expr))
</span><a href="Agda.Syntax.Parser.Helpers.html#exprToAssignment"><span class="hs-identifier hs-var">exprToAssignment</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650384"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621681650387"><span class="hs-identifier hs-type">mpatexpr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-450"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681650388"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681650388"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681650389"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650389"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681650390"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650390"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DoStmt -&gt; Parser DoStmt
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(DoStmt -&gt; Parser DoStmt) -&gt; DoStmt -&gt; Parser DoStmt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; Pattern -&gt; Expr -&gt; [LamClause] -&gt; DoStmt
</span><a href="Agda.Syntax.Concrete.html#DoBind"><span class="hs-identifier hs-var">DoBind</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650389"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681650388"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650390"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">[LamClause]
</span><a href="#local-6989586621681650386"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-451"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Pattern, Range, Expr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; [LamClause] -&gt; Parser DoStmt
</span><a href="Agda.Syntax.Parser.Helpers.html#defaultBuildDoStmt"><span class="hs-identifier hs-var">defaultBuildDoStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650384"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[LamClause]
</span><a href="#local-6989586621681650386"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-452"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#buildDoStmt"><span class="hs-identifier hs-var">buildDoStmt</span></a></span><span> </span><span id="local-6989586621681650392"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650392"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621681650393"><span class="annot"><span class="annottext">[LamClause]
</span><a href="#local-6989586621681650393"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; [LamClause] -&gt; Parser DoStmt
</span><a href="Agda.Syntax.Parser.Helpers.html#defaultBuildDoStmt"><span class="hs-identifier hs-var">defaultBuildDoStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650392"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[LamClause]
</span><a href="#local-6989586621681650393"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="hs-comment">{--------------------------------------------------------------------------
    Patterns
 --------------------------------------------------------------------------}</span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="annot"><span class="hs-comment">-- | Turn an expression into a left hand side.</span></span><span>
</span><span id="line-460"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#exprToLHS"><span class="hs-identifier hs-type">exprToLHS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#RewriteEqn"><span class="hs-identifier hs-type">RewriteEqn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#WithExpr"><span class="hs-identifier hs-type">WithExpr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">LHS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span id="exprToLHS"><span class="annot"><span class="annottext">exprToLHS :: Expr -&gt; Parser ([RewriteEqn] -&gt; [WithExpr] -&gt; LHS)
</span><a href="Agda.Syntax.Parser.Helpers.html#exprToLHS"><span class="hs-identifier hs-var hs-var">exprToLHS</span></a></span></span><span> </span><span id="local-6989586621681650395"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650395"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; [RewriteEqn] -&gt; [WithExpr] -&gt; LHS
</span><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-var">LHS</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; [RewriteEqn] -&gt; [WithExpr] -&gt; LHS)
-&gt; Parser Pattern -&gt; Parser ([RewriteEqn] -&gt; [WithExpr] -&gt; LHS)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Parser Pattern
</span><a href="Agda.Syntax.Parser.Helpers.html#exprToPattern"><span class="hs-identifier hs-var">exprToPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650395"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span class="hs-comment">-- | Turn an expression into a pattern. Fails if the expression is not a</span><span>
</span><span id="line-464"></span><span class="hs-comment">--   valid pattern.</span><span>
</span><span id="line-465"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#exprToPattern"><span class="hs-identifier hs-type">exprToPattern</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-466"></span><span id="exprToPattern"><span class="annot"><span class="annottext">exprToPattern :: Expr -&gt; Parser Pattern
</span><a href="Agda.Syntax.Parser.Helpers.html#exprToPattern"><span class="hs-identifier hs-var hs-var">exprToPattern</span></a></span></span><span> </span><span id="local-6989586621681650397"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650397"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Maybe Pattern
</span><a href="Agda.Syntax.Concrete.html#isPattern"><span class="hs-identifier hs-var">C.isPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650397"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-467"></span><span>  </span><span class="annot"><span class="annottext">Maybe Pattern
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; [Char] -&gt; Parser Pattern
forall r a. HasRange r =&gt; r -&gt; [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseErrorRange"><span class="hs-identifier hs-var">parseErrorRange</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650397"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser Pattern) -&gt; [Char] -&gt; Parser Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Not a valid pattern: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650397"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-468"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681650400"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681650400"><span class="hs-identifier hs-var">p</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Parser Pattern
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681650400"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span class="hs-comment">-- | Turn an expression into a name. Fails if the expression is not a</span><span>
</span><span id="line-471"></span><span class="hs-comment">--   valid identifier.</span><span>
</span><span id="line-472"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#exprToName"><span class="hs-identifier hs-type">exprToName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-473"></span><span id="exprToName"><span class="annot"><span class="annottext">exprToName :: Expr -&gt; Parser Name
</span><a href="Agda.Syntax.Parser.Helpers.html#exprToName"><span class="hs-identifier hs-var hs-var">exprToName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Ident"><span class="hs-identifier hs-type">Ident</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681650402"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650402"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Parser Name
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650402"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-474"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#exprToName"><span class="hs-identifier hs-var">exprToName</span></a></span><span> </span><span id="local-6989586621681650403"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650403"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; [Char] -&gt; Parser Name
forall r a. HasRange r =&gt; r -&gt; [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseErrorRange"><span class="hs-identifier hs-var">parseErrorRange</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650403"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser Name) -&gt; [Char] -&gt; Parser Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Not a valid identifier: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650403"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span class="hs-comment">-- | When given expression is @e1 = e2@, turn it into a named expression.</span><span>
</span><span id="line-477"></span><span class="hs-comment">--   Call this inside an implicit argument @{e}@ or @{{e}}@, where</span><span>
</span><span id="line-478"></span><span class="hs-comment">--   an equality must be a named argument (rather than a cubical partial match).</span><span>
</span><span id="line-479"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#maybeNamed"><span class="hs-identifier hs-type">maybeNamed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named_"><span class="hs-identifier hs-type">Named_</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span id="maybeNamed"><span class="annot"><span class="annottext">maybeNamed :: Expr -&gt; Parser (Named NamedName Expr)
</span><a href="Agda.Syntax.Parser.Helpers.html#maybeNamed"><span class="hs-identifier hs-var hs-var">maybeNamed</span></a></span></span><span> </span><span id="local-6989586621681650405"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650405"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-481"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650405"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-482"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Equal"><span class="hs-identifier hs-type">Equal</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681650407"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650407"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621681650408"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650408"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-483"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681650409"><span class="annot"><span class="annottext">succeed :: [Char] -&gt; Parser (Named NamedName Expr)
</span><a href="#local-6989586621681650409"><span class="hs-identifier hs-var hs-var">succeed</span></a></span></span><span> </span><span id="local-6989586621681650410"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650410"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Named NamedName Expr -&gt; Parser (Named NamedName Expr)
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Named NamedName Expr -&gt; Parser (Named NamedName Expr))
-&gt; Named NamedName Expr -&gt; Parser (Named NamedName Expr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NamedName -&gt; Expr -&gt; Named NamedName Expr
forall name a. name -&gt; a -&gt; Named name a
</span><a href="Agda.Syntax.Common.html#named"><span class="hs-identifier hs-var">named</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Origin -&gt; RString -&gt; NamedName
forall a. Origin -&gt; a -&gt; WithOrigin a
</span><a href="Agda.Syntax.Common.html#WithOrigin"><span class="hs-identifier hs-var">WithOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">Origin
</span><a href="Agda.Syntax.Common.html#UserWritten"><span class="hs-identifier hs-var">UserWritten</span></a></span><span> </span><span class="annot"><span class="annottext">(RString -&gt; NamedName) -&gt; RString -&gt; NamedName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; [Char] -&gt; RString
forall a. Range -&gt; a -&gt; Ranged a
</span><a href="Agda.Syntax.Common.html#Ranged"><span class="hs-identifier hs-var">Ranged</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650407"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650410"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650408"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-484"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650407"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-485"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Ident"><span class="hs-identifier hs-type">Ident</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681650412"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650412"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (Named NamedName Expr)
</span><a href="#local-6989586621681650409"><span class="hs-identifier hs-var">succeed</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser (Named NamedName Expr))
-&gt; [Char] -&gt; Parser (Named NamedName Expr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Char]
</span><a href="Agda.Syntax.Concrete.Name.html#nameToRawName"><span class="hs-identifier hs-var">nameToRawName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650412"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-486"></span><span>        </span><span class="hs-comment">-- We could have the following, but names of arguments cannot be _.</span><span>
</span><span id="line-487"></span><span>        </span><span class="hs-comment">-- Underscore{}    -&gt; succeed $ &quot;_&quot;</span><span>
</span><span id="line-488"></span><span>        </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; [Char] -&gt; Parser (Named NamedName Expr)
forall r a. HasRange r =&gt; r -&gt; [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseErrorRange"><span class="hs-identifier hs-var">parseErrorRange</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650405"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser (Named NamedName Expr))
-&gt; [Char] -&gt; Parser (Named NamedName Expr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Not a valid named argument: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650405"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-489"></span><span>    </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Named NamedName Expr -&gt; Parser (Named NamedName Expr)
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Named NamedName Expr -&gt; Parser (Named NamedName Expr))
-&gt; Named NamedName Expr -&gt; Parser (Named NamedName Expr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Named NamedName Expr
forall a name. a -&gt; Named name a
</span><a href="Agda.Syntax.Common.html#unnamed"><span class="hs-identifier hs-var">unnamed</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650405"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="hs-comment">-- Andreas, 2024-02-20, issue #7136:</span><span>
</span><span id="line-492"></span><span class="hs-comment">-- The following function has been rewritten to a defensive pattern matching style</span><span>
</span><span id="line-493"></span><span class="hs-comment">-- to be robust against future parser changes.</span><span>
</span><span id="line-494"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#patternSynArgs"><span class="hs-identifier hs-type">patternSynArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#WithHiding"><span class="hs-identifier hs-type">WithHiding</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-495"></span><span id="patternSynArgs"><span class="annot"><span class="annottext">patternSynArgs :: [NamedArg Binder] -&gt; Parser [WithHiding Name]
</span><a href="Agda.Syntax.Parser.Helpers.html#patternSynArgs"><span class="hs-identifier hs-var hs-var">patternSynArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NamedArg Binder -&gt; Parser (WithHiding Name))
-&gt; [NamedArg Binder] -&gt; Parser [WithHiding Name]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681650416"><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621681650416"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-496"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-497"></span><span>    </span><span id="local-6989586621681650417"><span class="annot"><span class="annottext">abort :: [Char] -&gt; Parser (WithHiding Name)
</span><a href="#local-6989586621681650417"><span class="hs-identifier hs-var hs-var">abort</span></a></span></span><span> </span><span id="local-6989586621681650418"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650418"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (WithHiding Name)
forall a. [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier hs-var">parseError</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser (WithHiding Name))
-&gt; [Char] -&gt; Parser (WithHiding Name)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-498"></span><span>      </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Illegal pattern synonym argument  &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NamedArg Binder -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621681650416"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-499"></span><span>      </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650418"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;.)&quot;</span></span><span>
</span><span id="line-500"></span><span>    </span><span id="local-6989586621681650421"><span class="annot"><span class="annottext">noAnn :: [Char] -&gt; [Char]
</span><a href="#local-6989586621681650421"><span class="hs-identifier hs-var hs-var">noAnn</span></a></span></span><span> </span><span id="local-6989586621681650422"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650422"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650422"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; annotations not allowed in pattern synonym arguments&quot;</span></span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NamedArg Binder
</span><a href="#local-6989586621681650416"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span>    </span><span class="hs-comment">-- Invariant: fixity is not used here, and neither finiteness</span><span>
</span><span id="line-505"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span id="local-6989586621681650424"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681650424"><span class="hs-identifier hs-var">ai</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span id="local-6989586621681650425"><span class="annot"><span class="annottext">Maybe NamedName
</span><a href="#local-6989586621681650425"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span id="local-6989586621681650426"><span class="annot"><span class="annottext">Maybe Pattern
</span><a href="#local-6989586621681650426"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="annot"><span class="annottext">BinderNameOrigin
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#BName"><span class="hs-identifier hs-type">BName</span></a></span><span> </span><span id="local-6989586621681650428"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650428"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681650429"><span class="annot"><span class="annottext">Fixity'
</span><a href="#local-6989586621681650429"><span class="hs-identifier hs-var">fix</span></a></span></span><span> </span><span id="local-6989586621681650430"><span class="annot"><span class="annottext">TacticAttribute
</span><a href="#local-6989586621681650430"><span class="hs-identifier hs-var">mtac</span></a></span></span><span> </span><span id="local-6989586621681650431"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681650431"><span class="hs-identifier hs-var">fin</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Fixity' -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity'
</span><a href="#local-6989586621681650429"><span class="hs-identifier hs-var">fix</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Parser (WithHiding Name)
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-507"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681650431"><span class="hs-identifier hs-var">fin</span></a></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Parser (WithHiding Name)
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-508"></span><span>
</span><span id="line-509"></span><span>    </span><span class="hs-comment">-- Error cases:</span><span>
</span><span id="line-510"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamedName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BinderNameOrigin
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BoundName
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-511"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (WithHiding Name)
</span><a href="#local-6989586621681650417"><span class="hs-identifier hs-var">abort</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Arguments to pattern synonyms cannot be patterns themselves&quot;</span></span><span>
</span><span id="line-512"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamedName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Pattern
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BinderNameOrigin
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#BName"><span class="hs-identifier hs-type">BName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Fixity'
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681650434"><span class="annot"><span class="annottext">TacticAttribute
</span><a href="#local-6989586621681650434"><span class="hs-identifier hs-var">tac</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TacticAttribute -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">TacticAttribute
</span><a href="#local-6989586621681650434"><span class="hs-identifier hs-var">tac</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-513"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (WithHiding Name)
</span><a href="#local-6989586621681650417"><span class="hs-identifier hs-var">abort</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser (WithHiding Name))
-&gt; [Char] -&gt; Parser (WithHiding Name)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><a href="#local-6989586621681650421"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Tactic&quot;</span></span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span>    </span><span class="hs-comment">-- Benign case:</span><span>
</span><span id="line-516"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span id="local-6989586621681650435"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681650435"><span class="hs-identifier hs-var">ai</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span id="local-6989586621681650436"><span class="annot"><span class="annottext">Maybe NamedName
</span><a href="#local-6989586621681650436"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Pattern
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">BinderNameOrigin
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#BName"><span class="hs-identifier hs-type">BName</span></a></span><span> </span><span id="local-6989586621681650437"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650437"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Fixity'
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TacticAttribute
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>      </span><span class="hs-comment">-- allow {n = n} for backwards compat with Agda 2.6</span><span>
</span><span id="line-518"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (NamedName -&gt; Bool) -&gt; Maybe NamedName -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Char]
</span><a href="Agda.Syntax.Concrete.Name.html#nameToRawName"><span class="hs-identifier hs-var">C.nameToRawName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650437"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Bool) -&gt; (NamedName -&gt; [Char]) -&gt; NamedName -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RString -&gt; [Char]
forall a. Ranged a -&gt; a
</span><a href="Agda.Syntax.Common.html#rangedThing"><span class="hs-identifier hs-var">rangedThing</span></a></span><span> </span><span class="annot"><span class="annottext">(RString -&gt; [Char])
-&gt; (NamedName -&gt; RString) -&gt; NamedName -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NamedName -&gt; RString
forall a. WithOrigin a -&gt; a
</span><a href="Agda.Syntax.Common.html#woThing"><span class="hs-identifier hs-var">woThing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe NamedName
</span><a href="#local-6989586621681650436"><span class="hs-identifier hs-var">mn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-519"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681650435"><span class="hs-identifier hs-var">ai</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-520"></span><span>
</span><span id="line-521"></span><span>          </span><span class="hs-comment">-- Benign case:</span><span>
</span><span id="line-522"></span><span>          </span><span class="annot"><a href="Agda.Syntax.Common.html#ArgInfo"><span class="hs-identifier hs-type">ArgInfo</span></a></span><span> </span><span id="local-6989586621681650441"><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621681650441"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Modality"><span class="hs-identifier hs-type">Modality</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Relevant"><span class="hs-identifier hs-type">Relevant</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Quantity%3C9"><span class="hs-identifier hs-type">Quantity&#969;</span></a></span><span> </span><span class="annot"><span class="annottext">Q&#969;Origin
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Cohesion
</span><a href="Agda.Syntax.Common.html#Continuous"><span class="hs-identifier hs-var">Continuous</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#PolarityModality"><span class="hs-identifier hs-type">PolarityModality</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">modPolarityAnn :: PolarityModality -&gt; ModalPolarity
</span><a href="Agda.Syntax.Common.html#modPolarityAnn"><span class="hs-identifier hs-var">modPolarityAnn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModalPolarity
</span><a href="Agda.Syntax.Common.html#MixedPolarity"><span class="hs-identifier hs-var">MixedPolarity</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Origin
</span><a href="Agda.Syntax.Common.html#UserWritten"><span class="hs-identifier hs-var">UserWritten</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVariables
</span><a href="Agda.Syntax.Common.html#UnknownFVs"><span class="hs-identifier hs-var">UnknownFVs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a></span><span> </span><span class="annot"><span class="annottext">Lock
</span><a href="Agda.Syntax.Common.html#IsNotLock"><span class="hs-identifier hs-var">IsNotLock</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-523"></span><span>            </span><span class="annot"><span class="annottext">WithHiding Name -&gt; Parser (WithHiding Name)
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(WithHiding Name -&gt; Parser (WithHiding Name))
-&gt; WithHiding Name -&gt; Parser (WithHiding Name)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Hiding -&gt; Name -&gt; WithHiding Name
forall a. Hiding -&gt; a -&gt; WithHiding a
</span><a href="Agda.Syntax.Common.html#WithHiding"><span class="hs-identifier hs-var">WithHiding</span></a></span><span> </span><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621681650441"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650437"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-524"></span><span>
</span><span id="line-525"></span><span>          </span><span class="hs-comment">-- Error cases:</span><span>
</span><span id="line-526"></span><span>          </span><span class="annot"><a href="Agda.Syntax.Common.html#ArgInfo"><span class="hs-identifier hs-type">ArgInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Hiding
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Modality
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FreeVariables
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#IsLock"><span class="hs-identifier hs-type">IsLock</span></a></span><span> </span><span class="annot"><span class="annottext">LockOrigin
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-527"></span><span>            </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (WithHiding Name)
</span><a href="#local-6989586621681650417"><span class="hs-identifier hs-var">abort</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser (WithHiding Name))
-&gt; [Char] -&gt; Parser (WithHiding Name)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><a href="#local-6989586621681650421"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Lock&quot;</span></span><span>
</span><span id="line-528"></span><span>
</span><span id="line-529"></span><span>          </span><span class="annot"><a href="Agda.Syntax.Common.html#ArgInfo"><span class="hs-identifier hs-type">ArgInfo</span></a></span><span> </span><span id="local-6989586621681650454"><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621681650454"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Modality"><span class="hs-identifier hs-type">Modality</span></a></span><span> </span><span id="local-6989586621681650455"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681650455"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681650456"><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621681650456"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621681650457"><span class="annot"><span class="annottext">Cohesion
</span><a href="#local-6989586621681650457"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621681650458"><span class="annot"><span class="annottext">PolarityModality
</span><a href="#local-6989586621681650458"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Origin
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FreeVariables
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Annotation
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-530"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Relevance -&gt; Bool
forall a. LensRelevance a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#isRelevant"><span class="hs-identifier hs-var">isRelevant</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681650455"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-531"></span><span>                </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (WithHiding Name)
</span><a href="#local-6989586621681650417"><span class="hs-identifier hs-var">abort</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Arguments to pattern synonyms must be relevant&quot;</span></span><span>
</span><span id="line-532"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quantity -&gt; Bool
forall a. LensQuantity a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#isQuantity%3C9"><span class="hs-identifier hs-var">isQuantity&#969;</span></a></span><span> </span><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621681650456"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-533"></span><span>                </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (WithHiding Name)
</span><a href="#local-6989586621681650417"><span class="hs-identifier hs-var">abort</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser (WithHiding Name))
-&gt; [Char] -&gt; Parser (WithHiding Name)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><a href="#local-6989586621681650421"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Quantity&quot;</span></span><span>
</span><span id="line-534"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PolarityModality -&gt; ModalPolarity
</span><a href="Agda.Syntax.Common.html#modPolarityAnn"><span class="hs-identifier hs-var">modPolarityAnn</span></a></span><span> </span><span class="annot"><span class="annottext">PolarityModality
</span><a href="#local-6989586621681650458"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ModalPolarity -&gt; ModalPolarity -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">ModalPolarity
</span><a href="Agda.Syntax.Common.html#MixedPolarity"><span class="hs-identifier hs-var">MixedPolarity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-535"></span><span>                </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (WithHiding Name)
</span><a href="#local-6989586621681650417"><span class="hs-identifier hs-var">abort</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser (WithHiding Name))
-&gt; [Char] -&gt; Parser (WithHiding Name)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><a href="#local-6989586621681650421"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Polarity&quot;</span></span><span>
</span><span id="line-536"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Cohesion
</span><a href="#local-6989586621681650457"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Cohesion -&gt; Cohesion -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Cohesion
</span><a href="Agda.Syntax.Common.html#Continuous"><span class="hs-identifier hs-var">Continuous</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-537"></span><span>                </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (WithHiding Name)
</span><a href="#local-6989586621681650417"><span class="hs-identifier hs-var">abort</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser (WithHiding Name))
-&gt; [Char] -&gt; Parser (WithHiding Name)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><a href="#local-6989586621681650421"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Cohesion&quot;</span></span><span>
</span><span id="line-538"></span><span>
</span><span id="line-539"></span><span>          </span><span class="hs-comment">-- Invariant: origin and fvs not used.</span><span>
</span><span id="line-540"></span><span>          </span><span class="annot"><a href="Agda.Syntax.Common.html#ArgInfo"><span class="hs-identifier hs-type">ArgInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Hiding
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Modality
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#KnownFVs"><span class="hs-identifier hs-type">KnownFVs</span></a></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Annotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Parser (WithHiding Name)
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-541"></span><span>          </span><span class="annot"><a href="Agda.Syntax.Common.html#ArgInfo"><span class="hs-identifier hs-type">ArgInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Hiding
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Modality
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681650463"><span class="annot"><span class="annottext">Origin
</span><a href="#local-6989586621681650463"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="annot"><span class="annottext">FreeVariables
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Annotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Origin
</span><a href="#local-6989586621681650463"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Origin -&gt; Origin -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><a href="Agda.Syntax.Common.html#UserWritten"><span class="hs-identifier hs-var">UserWritten</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Parser (WithHiding Name)
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-542"></span><span>
</span><span id="line-543"></span><span>          </span><span class="annot"><a href="Agda.Syntax.Common.html#ArgInfo"><span class="hs-identifier hs-type">ArgInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Hiding
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Modality
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FreeVariables
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Annotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Parser (WithHiding Name)
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span>      </span><span class="hs-comment">-- Error case: other named args are unsupported (issue #7136)</span><span>
</span><span id="line-546"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-547"></span><span>          </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (WithHiding Name)
</span><a href="#local-6989586621681650417"><span class="hs-identifier hs-var">abort</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Arguments to pattern synonyms cannot be named&quot;</span></span><span>
</span><span id="line-548"></span><span>
</span><span id="line-549"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#mkLamClause"><span class="hs-identifier hs-type">mkLamClause</span></a></span><span>
</span><span id="line-550"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ Catch-all?</span></span><span>
</span><span id="line-551"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Possibly empty list of patterns.</span></span><span>
</span><span id="line-552"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RHS"><span class="hs-identifier hs-type">RHS</span></a></span><span>
</span><span id="line-553"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LamClause"><span class="hs-identifier hs-type">LamClause</span></a></span><span>
</span><span id="line-554"></span><span id="mkLamClause"><span class="annot"><span class="annottext">mkLamClause :: Bool -&gt; [Expr] -&gt; RHS -&gt; Parser LamClause
</span><a href="Agda.Syntax.Parser.Helpers.html#mkLamClause"><span class="hs-identifier hs-var hs-var">mkLamClause</span></a></span></span><span> </span><span id="local-6989586621681650465"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681650465"><span class="hs-identifier hs-var">catchAll</span></a></span></span><span> </span><span id="local-6989586621681650466"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621681650466"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621681650467"><span class="annot"><span class="annottext">RHS
</span><a href="#local-6989586621681650467"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Parser Pattern) -&gt; [Expr] -&gt; Parser [Pattern]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Parser Pattern
</span><a href="Agda.Syntax.Parser.Helpers.html#exprToPattern"><span class="hs-identifier hs-var">exprToPattern</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621681650466"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Parser [Pattern] -&gt; ([Pattern] -&gt; LamClause) -&gt; Parser LamClause
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681650469"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621681650469"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-555"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LamClause"><span class="hs-identifier hs-type">LamClause</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">lamLHS :: [Pattern]
</span><a href="Agda.Syntax.Concrete.html#lamLHS"><span class="hs-identifier hs-var">lamLHS</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621681650469"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">lamRHS :: RHS
</span><a href="Agda.Syntax.Concrete.html#lamRHS"><span class="hs-identifier hs-var">lamRHS</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RHS
</span><a href="#local-6989586621681650467"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">lamCatchAll :: Bool
</span><a href="Agda.Syntax.Concrete.html#lamCatchAll"><span class="hs-identifier hs-var">lamCatchAll</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681650465"><span class="hs-identifier hs-var">catchAll</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#mkAbsurdLamClause"><span class="hs-identifier hs-type">mkAbsurdLamClause</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LamClause"><span class="hs-identifier hs-type">LamClause</span></a></span><span>
</span><span id="line-558"></span><span id="mkAbsurdLamClause"><span class="annot"><span class="annottext">mkAbsurdLamClause :: Bool -&gt; List1 Expr -&gt; Parser LamClause
</span><a href="Agda.Syntax.Parser.Helpers.html#mkAbsurdLamClause"><span class="hs-identifier hs-var hs-var">mkAbsurdLamClause</span></a></span></span><span> </span><span id="local-6989586621681650474"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681650474"><span class="hs-identifier hs-var">catchAll</span></a></span></span><span> </span><span id="local-6989586621681650475"><span class="annot"><span class="annottext">List1 Expr
</span><a href="#local-6989586621681650475"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Expr] -&gt; RHS -&gt; Parser LamClause
</span><a href="Agda.Syntax.Parser.Helpers.html#mkLamClause"><span class="hs-identifier hs-var">mkLamClause</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681650474"><span class="hs-identifier hs-var">catchAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">List1 Expr -&gt; [Item (List1 Expr)]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">List1.toList</span></span><span> </span><span class="annot"><span class="annottext">List1 Expr
</span><a href="#local-6989586621681650475"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RHS
forall e. RHS' e
</span><a href="Agda.Syntax.Concrete.html#AbsurdRHS"><span class="hs-identifier hs-var">AbsurdRHS</span></a></span><span>
</span><span id="line-559"></span><span>
</span><span id="line-560"></span><span class="hs-comment">{- RHS or type signature -}</span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span class="hs-keyword">data</span><span> </span><span id="RHSOrTypeSigs"><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#RHSOrTypeSigs"><span class="hs-identifier hs-var">RHSOrTypeSigs</span></a></span></span><span>
</span><span id="line-563"></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="JustRHS"><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#JustRHS"><span class="hs-identifier hs-var">JustRHS</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RHS"><span class="hs-identifier hs-type">RHS</span></a></span><span>
</span><span id="line-564"></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="TypeSigsRHS"><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#TypeSigsRHS"><span class="hs-identifier hs-var">TypeSigsRHS</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-565"></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621681650480"><span id="local-6989586621681650488"><span id="local-6989586621681650492"><span class="annot"><span class="annottext">Int -&gt; RHSOrTypeSigs -&gt; [Char] -&gt; [Char]
[RHSOrTypeSigs] -&gt; [Char] -&gt; [Char]
RHSOrTypeSigs -&gt; [Char]
(Int -&gt; RHSOrTypeSigs -&gt; [Char] -&gt; [Char])
-&gt; (RHSOrTypeSigs -&gt; [Char])
-&gt; ([RHSOrTypeSigs] -&gt; [Char] -&gt; [Char])
-&gt; Show RHSOrTypeSigs
forall a.
(Int -&gt; a -&gt; [Char] -&gt; [Char])
-&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; [Char] -&gt; [Char]) -&gt; Show a
$cshowsPrec :: Int -&gt; RHSOrTypeSigs -&gt; [Char] -&gt; [Char]
showsPrec :: Int -&gt; RHSOrTypeSigs -&gt; [Char] -&gt; [Char]
$cshow :: RHSOrTypeSigs -&gt; [Char]
show :: RHSOrTypeSigs -&gt; [Char]
$cshowList :: [RHSOrTypeSigs] -&gt; [Char] -&gt; [Char]
showList :: [RHSOrTypeSigs] -&gt; [Char] -&gt; [Char]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#patternToNames"><span class="hs-identifier hs-type">patternToNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#ArgInfo"><span class="hs-identifier hs-type">ArgInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-568"></span><span id="patternToNames"><span class="annot"><span class="annottext">patternToNames :: Pattern -&gt; Parser (List1 (ArgInfo, Name))
</span><a href="Agda.Syntax.Parser.Helpers.html#patternToNames"><span class="hs-identifier hs-var hs-var">patternToNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-569"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#IdentP"><span class="hs-identifier hs-type">IdentP</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681650498"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650498"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">List1 (ArgInfo, Name) -&gt; Parser (List1 (ArgInfo, Name))
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(List1 (ArgInfo, Name) -&gt; Parser (List1 (ArgInfo, Name)))
-&gt; List1 (ArgInfo, Name) -&gt; Parser (List1 (ArgInfo, Name))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ArgInfo, Name) -&gt; List1 (ArgInfo, Name)
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo
</span><a href="Agda.Syntax.Common.html#defaultArgInfo"><span class="hs-identifier hs-var">defaultArgInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650498"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#WildP"><span class="hs-identifier hs-type">WildP</span></a></span><span> </span><span id="local-6989586621681650501"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650501"><span class="hs-identifier hs-var">r</span></a></span></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">List1 (ArgInfo, Name) -&gt; Parser (List1 (ArgInfo, Name))
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(List1 (ArgInfo, Name) -&gt; Parser (List1 (ArgInfo, Name)))
-&gt; List1 (ArgInfo, Name) -&gt; Parser (List1 (ArgInfo, Name))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ArgInfo, Name) -&gt; List1 (ArgInfo, Name)
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo
</span><a href="Agda.Syntax.Common.html#defaultArgInfo"><span class="hs-identifier hs-var">defaultArgInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#noName"><span class="hs-identifier hs-var">C.noName</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650501"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-571"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#DotP"><span class="hs-identifier hs-type">DotP</span></a></span><span> </span><span id="local-6989586621681650503"><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621681650503"><span class="hs-identifier hs-var">kwr</span></a></span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.html#Ident"><span class="hs-identifier hs-type">Ident</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681650504"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650504"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">List1 (ArgInfo, Name) -&gt; Parser (List1 (ArgInfo, Name))
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(List1 (ArgInfo, Name) -&gt; Parser (List1 (ArgInfo, Name)))
-&gt; List1 (ArgInfo, Name) -&gt; Parser (List1 (ArgInfo, Name))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ArgInfo, Name) -&gt; List1 (ArgInfo, Name)
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KwRange -&gt; ArgInfo -&gt; ArgInfo
forall a b. (HasRange a, LensRelevance b) =&gt; a -&gt; b -&gt; b
</span><a href="Agda.Syntax.Parser.Helpers.html#makeIrrelevant"><span class="hs-identifier hs-var">makeIrrelevant</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621681650503"><span class="hs-identifier hs-var">kwr</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="Agda.Syntax.Common.html#defaultArgInfo"><span class="hs-identifier hs-var">defaultArgInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650504"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RawAppP"><span class="hs-identifier hs-type">RawAppP</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681650507"><span class="annot"><span class="annottext">List2 Pattern
</span><a href="#local-6989586621681650507"><span class="hs-identifier hs-var">ps</span></a></span></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NonEmpty (List1 (ArgInfo, Name)) -&gt; List1 (ArgInfo, Name)
forall a. Semigroup a =&gt; NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">sconcat</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (List1 (ArgInfo, Name)) -&gt; List1 (ArgInfo, Name))
-&gt; (List2 (List1 (ArgInfo, Name))
    -&gt; NonEmpty (List1 (ArgInfo, Name)))
-&gt; List2 (List1 (ArgInfo, Name))
-&gt; List1 (ArgInfo, Name)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">List2 (List1 (ArgInfo, Name)) -&gt; NonEmpty (List1 (ArgInfo, Name))
forall a. List2 a -&gt; List1 a
</span><a href="Agda.Utils.List2.html#toList1"><span class="hs-identifier hs-var">List2.toList1</span></a></span><span> </span><span class="annot"><span class="annottext">(List2 (List1 (ArgInfo, Name)) -&gt; List1 (ArgInfo, Name))
-&gt; Parser (List2 (List1 (ArgInfo, Name)))
-&gt; Parser (List1 (ArgInfo, Name))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Parser (List1 (ArgInfo, Name)))
-&gt; List2 Pattern -&gt; Parser (List2 (List1 (ArgInfo, Name)))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; List2 a -&gt; m (List2 b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Parser (List1 (ArgInfo, Name))
</span><a href="Agda.Syntax.Parser.Helpers.html#patternToNames"><span class="hs-identifier hs-var">patternToNames</span></a></span><span> </span><span class="annot"><span class="annottext">List2 Pattern
</span><a href="#local-6989586621681650507"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-573"></span><span>    </span><span id="local-6989586621681650508"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681650508"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (List1 (ArgInfo, Name))
forall a. [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier hs-var">parseError</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser (List1 (ArgInfo, Name)))
-&gt; [Char] -&gt; Parser (List1 (ArgInfo, Name))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-574"></span><span>      </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Illegal name in type signature: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681650508"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-575"></span><span>
</span><span id="line-576"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#funClauseOrTypeSigs"><span class="hs-identifier hs-type">funClauseOrTypeSigs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-type">Attr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#RewriteEqn"><span class="hs-identifier hs-type">RewriteEqn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.html#WithExpr"><span class="hs-identifier hs-type">WithExpr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">LHS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#RewriteEqn"><span class="hs-identifier hs-type">RewriteEqn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-578"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#RHSOrTypeSigs"><span class="hs-identifier hs-type">RHSOrTypeSigs</span></a></span><span>
</span><span id="line-579"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#WhereClause"><span class="hs-identifier hs-type">WhereClause</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Declaration"><span class="hs-identifier hs-type">Declaration</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-580"></span><span id="funClauseOrTypeSigs"><span class="annot"><span class="annottext">funClauseOrTypeSigs :: [Attr]
-&gt; ([RewriteEqn] -&gt; [WithExpr] -&gt; LHS)
-&gt; [Either RewriteEqn (List1 (Named Name Expr))]
-&gt; RHSOrTypeSigs
-&gt; WhereClause
-&gt; Parser (List1 Declaration)
</span><a href="Agda.Syntax.Parser.Helpers.html#funClauseOrTypeSigs"><span class="hs-identifier hs-var hs-var">funClauseOrTypeSigs</span></a></span></span><span> </span><span id="local-6989586621681650510"><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650510"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621681650511"><span class="annot"><span class="annottext">[RewriteEqn] -&gt; [WithExpr] -&gt; LHS
</span><a href="#local-6989586621681650511"><span class="hs-identifier hs-var">lhs'</span></a></span></span><span> </span><span id="local-6989586621681650512"><span class="annot"><span class="annottext">[Either RewriteEqn (List1 (Named Name Expr))]
</span><a href="#local-6989586621681650512"><span class="hs-identifier hs-var">with</span></a></span></span><span> </span><span id="local-6989586621681650513"><span class="annot"><span class="annottext">RHSOrTypeSigs
</span><a href="#local-6989586621681650513"><span class="hs-identifier hs-var">mrhs</span></a></span></span><span> </span><span id="local-6989586621681650514"><span class="annot"><span class="annottext">WhereClause
</span><a href="#local-6989586621681650514"><span class="hs-identifier hs-var">wh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-581"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681650515"><span class="annot"><a href="#local-6989586621681650515"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681650516"><span class="annot"><a href="#local-6989586621681650516"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Either RewriteEqn (List1 (Named Name Expr))]
-&gt; Parser ([RewriteEqn], [Named Name Expr])
</span><a href="Agda.Syntax.Parser.Helpers.html#buildWithBlock"><span class="hs-identifier hs-var">buildWithBlock</span></a></span><span> </span><span class="annot"><span class="annottext">[Either RewriteEqn (List1 (Named Name Expr))]
</span><a href="#local-6989586621681650512"><span class="hs-identifier hs-var">with</span></a></span><span>
</span><span id="line-582"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681650517"><span class="annot"><a href="#local-6989586621681650517"><span class="hs-identifier hs-var hs-var">lhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RewriteEqn] -&gt; [WithExpr] -&gt; LHS
</span><a href="#local-6989586621681650511"><span class="hs-identifier hs-var">lhs'</span></a></span><span> </span><span class="annot"><span class="annottext">[RewriteEqn]
</span><a href="#local-6989586621681650515"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Named Name Expr -&gt; WithExpr) -&gt; [Named Name Expr] -&gt; [WithExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr -&gt; Arg Expr) -&gt; Named Name Expr -&gt; WithExpr
forall a b. (a -&gt; b) -&gt; Named Name a -&gt; Named Name b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Arg Expr
</span><a href="Agda.Syntax.Concrete.html#observeModifiers"><span class="hs-identifier hs-var">observeModifiers</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Named Name Expr]
</span><a href="#local-6989586621681650516"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>  </span><span class="hs-comment">-- traceShowM lhs</span><span>
</span><span id="line-584"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621681650513"><span class="hs-identifier hs-type">mrhs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-585"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#JustRHS"><span class="hs-identifier hs-type">JustRHS</span></a></span><span> </span><span id="local-6989586621681650519"><span class="annot"><span class="annottext">RHS
</span><a href="#local-6989586621681650519"><span class="hs-identifier hs-var">rhs</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-586"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Parser () -&gt; Parser ()
forall b (m :: * -&gt; *). (IsBool b, Monad m) =&gt; b -&gt; m () -&gt; m ()
</span><a href="Agda.Utils.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Attr] -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650510"><span class="hs-identifier hs-var">attrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Parser () -&gt; Parser ()) -&gt; Parser () -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Attr] -&gt; [Char] -&gt; Parser ()
forall r a. HasRange r =&gt; r -&gt; [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseErrorRange"><span class="hs-identifier hs-var">parseErrorRange</span></a></span><span> </span><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650510"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser ()) -&gt; [Char] -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;A function clause cannot have attributes&quot;</span></span><span>
</span><span id="line-587"></span><span>      </span><span class="annot"><span class="annottext">List1 Declaration -&gt; Parser (List1 Declaration)
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(List1 Declaration -&gt; Parser (List1 Declaration))
-&gt; List1 Declaration -&gt; Parser (List1 Declaration)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Declaration -&gt; List1 Declaration
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">(Declaration -&gt; List1 Declaration)
-&gt; Declaration -&gt; List1 Declaration
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LHS -&gt; RHS -&gt; WhereClause -&gt; Bool -&gt; Declaration
</span><a href="Agda.Syntax.Concrete.html#FunClause"><span class="hs-identifier hs-var">FunClause</span></a></span><span> </span><span class="annot"><span class="annottext">LHS
</span><a href="#local-6989586621681650517"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">RHS
</span><a href="#local-6989586621681650519"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">WhereClause
</span><a href="#local-6989586621681650514"><span class="hs-identifier hs-var">wh</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-588"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#TypeSigsRHS"><span class="hs-identifier hs-type">TypeSigsRHS</span></a></span><span> </span><span id="local-6989586621681650521"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650521"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">WhereClause
</span><a href="#local-6989586621681650514"><span class="hs-identifier hs-var">wh</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-589"></span><span>      </span><span class="annot"><span class="annottext">WhereClause
</span><a href="Agda.Syntax.Concrete.html#NoWhere"><span class="hs-identifier hs-var">NoWhere</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LHS
</span><a href="#local-6989586621681650517"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-590"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">LHS</span></a></span><span> </span><span id="local-6989586621681650523"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681650523"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">[RewriteEqn]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[WithExpr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
forall a. HasEllipsis a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Pattern.html#hasEllipsis"><span class="hs-identifier hs-var">hasEllipsis</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681650523"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (List1 Declaration)
forall a. [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier hs-var">parseError</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;The ellipsis ... cannot have a type signature&quot;</span></span><span>
</span><span id="line-591"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">LHS</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[RewriteEqn]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WithExpr
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[WithExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (List1 Declaration)
forall a. [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier hs-var">parseError</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Illegal: with in type signature&quot;</span></span><span>
</span><span id="line-592"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">LHS</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RewriteEqn
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[RewriteEqn]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WithExpr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (List1 Declaration)
forall a. [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier hs-var">parseError</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Illegal: rewrite in type signature&quot;</span></span><span>
</span><span id="line-593"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">LHS</span></a></span><span> </span><span id="local-6989586621681650525"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681650525"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">[RewriteEqn]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[WithExpr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
forall p. CPatternLike p =&gt; p -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Pattern.html#hasWithPatterns"><span class="hs-identifier hs-var">hasWithPatterns</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681650525"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (List1 Declaration)
forall a. [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier hs-var">parseError</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Illegal: with patterns in type signature&quot;</span></span><span>
</span><span id="line-594"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Concrete.html#LHS"><span class="hs-identifier hs-type">LHS</span></a></span><span> </span><span id="local-6989586621681650527"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681650527"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Parser (List1 (ArgInfo, Name))
-&gt; ((ArgInfo, Name) -&gt; Parser Declaration)
-&gt; Parser (List1 Declaration)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
m (t a) -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="Agda.Utils.Monad.html#forMM"><span class="hs-identifier hs-var">forMM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; Parser (List1 (ArgInfo, Name))
</span><a href="Agda.Syntax.Parser.Helpers.html#patternToNames"><span class="hs-identifier hs-var">patternToNames</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621681650527"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((ArgInfo, Name) -&gt; Parser Declaration)
 -&gt; Parser (List1 Declaration))
-&gt; ((ArgInfo, Name) -&gt; Parser Declaration)
-&gt; Parser (List1 Declaration)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681650529"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681650529"><span class="hs-identifier hs-var">info</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681650530"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650530"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-595"></span><span>          </span><span id="local-6989586621681650531"><span class="annot"><a href="#local-6989586621681650531"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Attr] -&gt; ArgInfo -&gt; Parser ArgInfo
forall a. LensAttribute a =&gt; [Attr] -&gt; a -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Helpers.html#applyAttrs"><span class="hs-identifier hs-var">applyAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650510"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681650529"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-596"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#typeSig"><span class="hs-identifier hs-type">typeSig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681650531"><span class="hs-identifier hs-type">info</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#getTacticAttr"><span class="hs-identifier hs-type">getTacticAttr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681650510"><span class="hs-identifier hs-type">attrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681650530"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681650521"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-597"></span><span>      </span><span class="annot"><span class="annottext">WhereClause
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser (List1 Declaration)
forall a. [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseError"><span class="hs-identifier hs-var">parseError</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;A type signature cannot have a where clause&quot;</span></span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#typeSig"><span class="hs-identifier hs-type">typeSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#ArgInfo"><span class="hs-identifier hs-type">ArgInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#TacticAttribute"><span class="hs-identifier hs-type">TacticAttribute</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Declaration"><span class="hs-identifier hs-type">Declaration</span></a></span><span>
</span><span id="line-600"></span><span id="typeSig"><span class="annot"><span class="annottext">typeSig :: ArgInfo -&gt; TacticAttribute -&gt; Name -&gt; Expr -&gt; Declaration
</span><a href="Agda.Syntax.Parser.Helpers.html#typeSig"><span class="hs-identifier hs-var hs-var">typeSig</span></a></span></span><span> </span><span id="local-6989586621681650535"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681650535"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681650536"><span class="annot"><span class="annottext">TacticAttribute
</span><a href="#local-6989586621681650536"><span class="hs-identifier hs-var">tac</span></a></span></span><span> </span><span id="local-6989586621681650537"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650537"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681650538"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650538"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; TacticAttribute -&gt; Name -&gt; Expr -&gt; Declaration
</span><a href="Agda.Syntax.Concrete.html#TypeSig"><span class="hs-identifier hs-var">TypeSig</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681650535"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">TacticAttribute
</span><a href="#local-6989586621681650536"><span class="hs-identifier hs-var">tac</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681650537"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Expr
</span><a href="Agda.Syntax.Concrete.html#Generalized"><span class="hs-identifier hs-var">Generalized</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650538"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-601"></span><span>
</span><span id="line-602"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-603"></span><span class="annot"><span class="hs-comment">-- * Relevance</span></span><span>
</span><span id="line-604"></span><span>
</span><span id="line-605"></span><span id="local-6989586621681649553"><span id="local-6989586621681649554"><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#makeIrrelevant"><span class="hs-identifier hs-type">makeIrrelevant</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#HasRange"><span class="hs-identifier hs-type">HasRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681649553"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#LensRelevance"><span class="hs-identifier hs-type">LensRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681649554"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681649553"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681649554"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681649554"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-606"></span><span id="makeIrrelevant"><span class="annot"><span class="annottext">makeIrrelevant :: forall a b. (HasRange a, LensRelevance b) =&gt; a -&gt; b -&gt; b
</span><a href="Agda.Syntax.Parser.Helpers.html#makeIrrelevant"><span class="hs-identifier hs-var hs-var">makeIrrelevant</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; b -&gt; b
forall a. LensRelevance a =&gt; Relevance -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setRelevance"><span class="hs-identifier hs-var">setRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">(Relevance -&gt; b -&gt; b) -&gt; (a -&gt; Relevance) -&gt; a -&gt; b -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OriginIrrelevant -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#Irrelevant"><span class="hs-identifier hs-var">Irrelevant</span></a></span><span> </span><span class="annot"><span class="annottext">(OriginIrrelevant -&gt; Relevance)
-&gt; (a -&gt; OriginIrrelevant) -&gt; a -&gt; Relevance
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; OriginIrrelevant
</span><a href="Agda.Syntax.Common.html#OIrrDot"><span class="hs-identifier hs-var">OIrrDot</span></a></span><span> </span><span class="annot"><span class="annottext">(Range -&gt; OriginIrrelevant)
-&gt; (a -&gt; Range) -&gt; a -&gt; OriginIrrelevant
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span id="local-6989586621681650548"><span id="local-6989586621681650549"><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#makeShapeIrrelevant"><span class="hs-identifier hs-type">makeShapeIrrelevant</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Position.html#HasRange"><span class="hs-identifier hs-type">HasRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681650548"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#LensRelevance"><span class="hs-identifier hs-type">LensRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681650549"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681650548"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681650549"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681650549"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-609"></span><span id="makeShapeIrrelevant"><span class="annot"><span class="annottext">makeShapeIrrelevant :: forall a b. (HasRange a, LensRelevance b) =&gt; a -&gt; b -&gt; b
</span><a href="Agda.Syntax.Parser.Helpers.html#makeShapeIrrelevant"><span class="hs-identifier hs-var hs-var">makeShapeIrrelevant</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; b -&gt; b
forall a. LensRelevance a =&gt; Relevance -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setRelevance"><span class="hs-identifier hs-var">setRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">(Relevance -&gt; b -&gt; b) -&gt; (a -&gt; Relevance) -&gt; a -&gt; b -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OriginShapeIrrelevant -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#ShapeIrrelevant"><span class="hs-identifier hs-var">ShapeIrrelevant</span></a></span><span> </span><span class="annot"><span class="annottext">(OriginShapeIrrelevant -&gt; Relevance)
-&gt; (a -&gt; OriginShapeIrrelevant) -&gt; a -&gt; Relevance
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; OriginShapeIrrelevant
</span><a href="Agda.Syntax.Common.html#OShIrrDotDot"><span class="hs-identifier hs-var">OShIrrDotDot</span></a></span><span> </span><span class="annot"><span class="annottext">(Range -&gt; OriginShapeIrrelevant)
-&gt; (a -&gt; Range) -&gt; a -&gt; OriginShapeIrrelevant
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span id="local-6989586621681649570"><span id="local-6989586621681649571"><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#defaultIrrelevantArg"><span class="hs-identifier hs-type">defaultIrrelevantArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#HasRange"><span class="hs-identifier hs-type">HasRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681649570"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681649570"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681649571"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681649571"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-612"></span><span id="defaultIrrelevantArg"><span class="annot"><span class="annottext">defaultIrrelevantArg :: forall a b. HasRange a =&gt; a -&gt; b -&gt; Arg b
</span><a href="Agda.Syntax.Parser.Helpers.html#defaultIrrelevantArg"><span class="hs-identifier hs-var hs-var">defaultIrrelevantArg</span></a></span></span><span> </span><span id="local-6989586621681650562"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681650562"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Arg b -&gt; Arg b
forall a b. (HasRange a, LensRelevance b) =&gt; a -&gt; b -&gt; b
</span><a href="Agda.Syntax.Parser.Helpers.html#makeIrrelevant"><span class="hs-identifier hs-var">makeIrrelevant</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681650562"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(Arg b -&gt; Arg b) -&gt; (b -&gt; Arg b) -&gt; b -&gt; Arg b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Arg b
forall a. a -&gt; Arg a
</span><a href="Agda.Syntax.Common.html#defaultArg"><span class="hs-identifier hs-var">defaultArg</span></a></span><span>
</span><span id="line-613"></span><span>
</span><span id="line-614"></span><span id="local-6989586621681650563"><span id="local-6989586621681650564"><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#defaultShapeIrrelevantArg"><span class="hs-identifier hs-type">defaultShapeIrrelevantArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#HasRange"><span class="hs-identifier hs-type">HasRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681650563"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681650563"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681650564"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681650564"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-615"></span><span id="defaultShapeIrrelevantArg"><span class="annot"><span class="annottext">defaultShapeIrrelevantArg :: forall a b. HasRange a =&gt; a -&gt; b -&gt; Arg b
</span><a href="Agda.Syntax.Parser.Helpers.html#defaultShapeIrrelevantArg"><span class="hs-identifier hs-var hs-var">defaultShapeIrrelevantArg</span></a></span></span><span> </span><span id="local-6989586621681650569"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681650569"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Arg b -&gt; Arg b
forall a b. (HasRange a, LensRelevance b) =&gt; a -&gt; b -&gt; b
</span><a href="Agda.Syntax.Parser.Helpers.html#makeShapeIrrelevant"><span class="hs-identifier hs-var">makeShapeIrrelevant</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681650569"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(Arg b -&gt; Arg b) -&gt; (b -&gt; Arg b) -&gt; b -&gt; Arg b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Arg b
forall a. a -&gt; Arg a
</span><a href="Agda.Syntax.Common.html#defaultArg"><span class="hs-identifier hs-var">defaultArg</span></a></span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-618"></span><span class="annot"><span class="hs-comment">-- * Attributes</span></span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span class="annot"><span class="hs-comment">-- | Parsed attribute.</span></span><span>
</span><span id="line-621"></span><span>
</span><span id="line-622"></span><span class="hs-keyword">data</span><span> </span><span id="Attr"><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-var">Attr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Attr"><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-var">Attr</span></a></span></span><span>
</span><span id="line-623"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="attrRange"><span class="annot"><span class="annottext">Attr -&gt; Range
</span><a href="Agda.Syntax.Parser.Helpers.html#attrRange"><span class="hs-identifier hs-var hs-var">attrRange</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Range includes the @.</span></span><span>
</span><span id="line-624"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="attrName"><span class="annot"><span class="annottext">Attr -&gt; [Char]
</span><a href="Agda.Syntax.Parser.Helpers.html#attrName"><span class="hs-identifier hs-var hs-var">attrName</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Concrete, user written attribute for error reporting.</span></span><span>
</span><span id="line-625"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="theAttr"><span class="annot"><span class="annottext">Attr -&gt; Attribute
</span><a href="Agda.Syntax.Parser.Helpers.html#theAttr"><span class="hs-identifier hs-var hs-var">theAttr</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Attribute.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ Parsed attribute.</span></span><span>
</span><span id="line-626"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#HasRange"><span class="hs-identifier hs-type">HasRange</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-type">Attr</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-629"></span><span>  </span><span id="local-6989586621681650574"><span class="annot"><span class="annottext">getRange :: Attr -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var hs-var hs-var">getRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attr -&gt; Range
</span><a href="Agda.Syntax.Parser.Helpers.html#attrRange"><span class="hs-identifier hs-var">attrRange</span></a></span><span>
</span><span id="line-630"></span><span>
</span><span id="line-631"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#SetRange"><span class="hs-identifier hs-type">SetRange</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-type">Attr</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-632"></span><span>  </span><span id="local-6989586621681650580"><span class="annot"><span class="annottext">setRange :: Range -&gt; Attr -&gt; Attr
</span><a href="Agda.Syntax.Position.html#setRange"><span class="hs-identifier hs-var hs-var hs-var">setRange</span></a></span></span><span> </span><span id="local-6989586621681650581"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650581"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-type">Attr</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681650582"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650582"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681650583"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621681650583"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range -&gt; [Char] -&gt; Attribute -&gt; Attr
</span><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-var">Attr</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650581"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650582"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621681650583"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-633"></span><span>
</span><span id="line-634"></span><span class="annot"><span class="hs-comment">-- | Parse an attribute.</span></span><span>
</span><span id="line-635"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#toAttribute"><span class="hs-identifier hs-type">toAttribute</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-type">Attr</span></a></span><span>
</span><span id="line-636"></span><span id="toAttribute"><span class="annot"><span class="annottext">toAttribute :: Range -&gt; Expr -&gt; Parser Attr
</span><a href="Agda.Syntax.Parser.Helpers.html#toAttribute"><span class="hs-identifier hs-var hs-var">toAttribute</span></a></span></span><span> </span><span id="local-6989586621681650585"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650585"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681650586"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650586"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-637"></span><span>  </span><span id="local-6989586621681650587"><span class="annot"><a href="#local-6989586621681650587"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Attr
-&gt; (Attribute -&gt; Parser Attr) -&gt; Maybe Attribute -&gt; Parser Attr
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Parser Attr
</span><a href="#local-6989586621681650588"><span class="hs-identifier hs-var">failure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attr -&gt; Parser Attr
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Attr -&gt; Parser Attr)
-&gt; (Attribute -&gt; Attr) -&gt; Attribute -&gt; Parser Attr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Range -&gt; [Char] -&gt; Attribute -&gt; Attr
</span><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-var">Attr</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681650585"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650589"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Attribute -&gt; Parser Attr) -&gt; Maybe Attribute -&gt; Parser Attr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Maybe Attribute
</span><a href="Agda.Syntax.Concrete.Attribute.html#exprToAttribute"><span class="hs-identifier hs-var">exprToAttribute</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650586"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-638"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">modify'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681650591"><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681650591"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ParseState
</span><a href="#local-6989586621681650591"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseAttributes"><span class="hs-identifier hs-var">parseAttributes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#theAttr"><span class="hs-identifier hs-var">theAttr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681650587"><span class="hs-identifier hs-type">attr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681650585"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681650589"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#parseAttributes"><span class="hs-identifier hs-var">parseAttributes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681650591"><span class="hs-identifier hs-type">st</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621681650587"><span class="hs-identifier hs-type">attr</span></a></span><span>
</span><span id="line-640"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-641"></span><span>  </span><span id="local-6989586621681650589"><span class="annot"><span class="annottext">s :: [Char]
</span><a href="#local-6989586621681650589"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650586"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-642"></span><span>  </span><span id="local-6989586621681650588"><span class="annot"><span class="annottext">failure :: Parser Attr
</span><a href="#local-6989586621681650588"><span class="hs-identifier hs-var hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; [Char] -&gt; Parser Attr
forall r a. HasRange r =&gt; r -&gt; [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseErrorRange"><span class="hs-identifier hs-var">parseErrorRange</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681650586"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser Attr) -&gt; [Char] -&gt; Parser Attr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unknown attribute: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681650589"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-643"></span><span>
</span><span id="line-644"></span><span class="hs-comment">-- | Apply an attribute to thing (usually `Arg`).</span><span>
</span><span id="line-645"></span><span class="hs-comment">--   This will fail if one of the attributes is already set</span><span>
</span><span id="line-646"></span><span class="hs-comment">--   in the thing to something else than the default value.</span><span>
</span><span id="line-647"></span><span id="local-6989586621681649579"><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#applyAttr"><span class="hs-identifier hs-type">applyAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Attribute.html#LensAttribute"><span class="hs-identifier hs-type">LensAttribute</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681649579"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-type">Attr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681649579"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681649579"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-648"></span><span id="applyAttr"><span class="annot"><span class="annottext">applyAttr :: forall a. LensAttribute a =&gt; Attr -&gt; a -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Helpers.html#applyAttr"><span class="hs-identifier hs-var hs-var">applyAttr</span></a></span></span><span> </span><span id="local-6989586621681650597"><span class="annot"><span class="annottext">attr :: Attr
</span><a href="#local-6989586621681650597"><span class="hs-identifier hs-var">attr</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-type">Attr</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681650598"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621681650598"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser a -&gt; (a -&gt; Parser a) -&gt; Maybe a -&gt; Parser a
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621681650599"><span class="hs-identifier hs-var">failure</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Parser a
forall a. a -&gt; Parser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; Parser a) -&gt; (a -&gt; Maybe a) -&gt; a -&gt; Parser a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; a -&gt; Maybe a
forall a. LensAttribute a =&gt; Attribute -&gt; a -&gt; Maybe a
</span><a href="Agda.Syntax.Concrete.Attribute.html#setPristineAttribute"><span class="hs-identifier hs-var">setPristineAttribute</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621681650598"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-649"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-650"></span><span>  </span><span id="local-6989586621681650599"><span class="annot"><span class="annottext">failure :: Parser a
</span><a href="#local-6989586621681650599"><span class="hs-identifier hs-var hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attr -&gt; Parser a
forall a. Attr -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Helpers.html#errorConflictingAttribute"><span class="hs-identifier hs-var">errorConflictingAttribute</span></a></span><span> </span><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621681650597"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-651"></span><span>
</span><span id="line-652"></span><span class="hs-comment">-- | Apply attributes to thing (usually `Arg`).</span><span>
</span><span id="line-653"></span><span class="hs-comment">--   Expects a reversed list of attributes.</span><span>
</span><span id="line-654"></span><span class="hs-comment">--   This will fail if one of the attributes is already set</span><span>
</span><span id="line-655"></span><span class="hs-comment">--   in the thing to something else than the default value.</span><span>
</span><span id="line-656"></span><span id="local-6989586621681649562"><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#applyAttrs"><span class="hs-identifier hs-type">applyAttrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Attribute.html#LensAttribute"><span class="hs-identifier hs-type">LensAttribute</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681649562"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-type">Attr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681649562"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681649562"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-657"></span><span id="applyAttrs"><span class="annot"><span class="annottext">applyAttrs :: forall a. LensAttribute a =&gt; [Attr] -&gt; a -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Helpers.html#applyAttrs"><span class="hs-identifier hs-var hs-var">applyAttrs</span></a></span></span><span> </span><span id="local-6989586621681650610"><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650610"><span class="hs-identifier hs-var">rattrs</span></a></span></span><span> </span><span id="local-6989586621681650611"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681650611"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-658"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681650612"><span class="annot"><span class="annottext">attrs :: [Attr]
</span><a href="#local-6989586621681650612"><span class="hs-identifier hs-var hs-var hs-var">attrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Attr] -&gt; [Attr]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650610"><span class="hs-identifier hs-var">rattrs</span></a></span><span>
</span><span id="line-659"></span><span>  </span><span class="annot"><span class="annottext">(Attribute -&gt; Bool) -&gt; [Attr] -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Helpers.html#checkForUniqueAttribute"><span class="hs-identifier hs-var">checkForUniqueAttribute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Quantity -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Quantity -&gt; Bool)
-&gt; (Attribute -&gt; Maybe Quantity) -&gt; Attribute -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Maybe Quantity
</span><a href="Agda.Syntax.Concrete.Attribute.html#isQuantityAttribute"><span class="hs-identifier hs-var">isQuantityAttribute</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650612"><span class="hs-identifier hs-var">attrs</span></a></span><span>
</span><span id="line-660"></span><span>  </span><span class="annot"><span class="annottext">(Attribute -&gt; Bool) -&gt; [Attr] -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Helpers.html#checkForUniqueAttribute"><span class="hs-identifier hs-var">checkForUniqueAttribute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Relevance -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Relevance -&gt; Bool)
-&gt; (Attribute -&gt; Maybe Relevance) -&gt; Attribute -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Maybe Relevance
</span><a href="Agda.Syntax.Concrete.Attribute.html#isRelevanceAttribute"><span class="hs-identifier hs-var">isRelevanceAttribute</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650612"><span class="hs-identifier hs-var">attrs</span></a></span><span>
</span><span id="line-661"></span><span>  </span><span class="annot"><span class="annottext">(Attribute -&gt; Bool) -&gt; [Attr] -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Helpers.html#checkForUniqueAttribute"><span class="hs-identifier hs-var">checkForUniqueAttribute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Attribute -&gt; Bool) -&gt; Attribute -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TacticAttribute -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">(TacticAttribute -&gt; Bool)
-&gt; (Attribute -&gt; TacticAttribute) -&gt; Attribute -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; TacticAttribute
</span><a href="Agda.Syntax.Concrete.Attribute.html#isTacticAttribute"><span class="hs-identifier hs-var">isTacticAttribute</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650612"><span class="hs-identifier hs-var">attrs</span></a></span><span>
</span><span id="line-662"></span><span>  </span><span class="annot"><span class="annottext">(a -&gt; Attr -&gt; Parser a) -&gt; a -&gt; [Attr] -&gt; Parser a
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Attr -&gt; a -&gt; Parser a) -&gt; a -&gt; Attr -&gt; Parser a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Attr -&gt; a -&gt; Parser a
forall a. LensAttribute a =&gt; Attr -&gt; a -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Helpers.html#applyAttr"><span class="hs-identifier hs-var">applyAttr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681650611"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650612"><span class="hs-identifier hs-var">attrs</span></a></span><span>
</span><span id="line-663"></span><span>
</span><span id="line-664"></span><span id="local-6989586621681649592"><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#applyAttrs1"><span class="hs-identifier hs-type">applyAttrs1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Attribute.html#LensAttribute"><span class="hs-identifier hs-type">LensAttribute</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681649592"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-type">Attr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681649592"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681649592"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-665"></span><span id="applyAttrs1"><span class="annot"><span class="annottext">applyAttrs1 :: forall a. LensAttribute a =&gt; List1 Attr -&gt; a -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Helpers.html#applyAttrs1"><span class="hs-identifier hs-var hs-var">applyAttrs1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Attr] -&gt; a -&gt; Parser a
forall a. LensAttribute a =&gt; [Attr] -&gt; a -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Helpers.html#applyAttrs"><span class="hs-identifier hs-var">applyAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">([Attr] -&gt; a -&gt; Parser a)
-&gt; (List1 Attr -&gt; [Attr]) -&gt; List1 Attr -&gt; a -&gt; Parser a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">List1 Attr -&gt; [Item (List1 Attr)]
List1 Attr -&gt; [Attr]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">List1.toList</span></span><span>
</span><span id="line-666"></span><span>
</span><span id="line-667"></span><span class="annot"><span class="hs-comment">-- | Set the tactic attribute of a binder</span></span><span>
</span><span id="line-668"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#setTacticAttr"><span class="hs-identifier hs-type">setTacticAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-type">Attr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span>
</span><span id="line-669"></span><span id="setTacticAttr"><span class="annot"><span class="annottext">setTacticAttr :: List1 Attr -&gt; NamedArg Binder -&gt; NamedArg Binder
</span><a href="Agda.Syntax.Parser.Helpers.html#setTacticAttr"><span class="hs-identifier hs-var hs-var">setTacticAttr</span></a></span></span><span> </span><span id="local-6989586621681650625"><span class="annot"><span class="annottext">List1 Attr
</span><a href="#local-6989586621681650625"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Binder -&gt; Binder) -&gt; NamedArg Binder -&gt; NamedArg Binder
forall a b. (a -&gt; b) -&gt; NamedArg a -&gt; NamedArg b
</span><a href="Agda.Syntax.Common.html#updateNamedArg"><span class="hs-identifier hs-var">updateNamedArg</span></a></span><span> </span><span class="annot"><span class="annottext">((Binder -&gt; Binder) -&gt; NamedArg Binder -&gt; NamedArg Binder)
-&gt; (Binder -&gt; Binder) -&gt; NamedArg Binder -&gt; NamedArg Binder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(BoundName -&gt; BoundName) -&gt; Binder -&gt; Binder
forall a b. (a -&gt; b) -&gt; Binder' a -&gt; Binder' b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">((BoundName -&gt; BoundName) -&gt; Binder -&gt; Binder)
-&gt; (BoundName -&gt; BoundName) -&gt; Binder -&gt; Binder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681650627"><span class="annot"><span class="annottext">BoundName
</span><a href="#local-6989586621681650627"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-670"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Attr] -&gt; TacticAttribute
</span><a href="Agda.Syntax.Parser.Helpers.html#getTacticAttr"><span class="hs-identifier hs-var">getTacticAttr</span></a></span><span> </span><span class="annot"><span class="annottext">([Attr] -&gt; TacticAttribute) -&gt; [Attr] -&gt; TacticAttribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">List1 Attr -&gt; [Item (List1 Attr)]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">List1.toList</span></span><span> </span><span class="annot"><span class="annottext">List1 Attr
</span><a href="#local-6989586621681650625"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-671"></span><span>    </span><span id="local-6989586621681650628"><span class="annot"><span class="annottext">TacticAttribute
</span><a href="#local-6989586621681650628"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TacticAttribute -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">TacticAttribute
</span><a href="#local-6989586621681650628"><span class="hs-identifier hs-var">t</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BoundName
</span><a href="#local-6989586621681650627"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-672"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BoundName
</span><a href="#local-6989586621681650627"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#bnameTactic"><span class="hs-identifier hs-var">bnameTactic</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681650628"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-673"></span><span>
</span><span id="line-674"></span><span class="annot"><span class="hs-comment">-- | Get the tactic attribute if present.</span></span><span>
</span><span id="line-675"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#getTacticAttr"><span class="hs-identifier hs-type">getTacticAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-type">Attr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.html#TacticAttribute"><span class="hs-identifier hs-type">TacticAttribute</span></a></span><span>
</span><span id="line-676"></span><span id="getTacticAttr"><span class="annot"><span class="annottext">getTacticAttr :: [Attr] -&gt; TacticAttribute
</span><a href="Agda.Syntax.Parser.Helpers.html#getTacticAttr"><span class="hs-identifier hs-var hs-var">getTacticAttr</span></a></span></span><span> </span><span id="local-6989586621681650630"><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650630"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Ranged Expr) -&gt; TacticAttribute
forall a. Maybe (Ranged a) -&gt; TacticAttribute' a
</span><a href="Agda.Syntax.Concrete.html#TacticAttribute"><span class="hs-identifier hs-var">C.TacticAttribute</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Ranged Expr) -&gt; TacticAttribute)
-&gt; Maybe (Ranged Expr) -&gt; TacticAttribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-677"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; [Attribute]
</span><a href="Agda.Syntax.Concrete.Attribute.html#tacticAttributes"><span class="hs-identifier hs-var">tacticAttributes</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621681650633"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-type">Attr</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681650633"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621681650633"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650630"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-678"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Concrete.Attribute.html#TacticAttribute"><span class="hs-identifier hs-type">CA.TacticAttribute</span></a></span><span> </span><span id="local-6989586621681650634"><span class="annot"><span class="annottext">Ranged Expr
</span><a href="#local-6989586621681650634"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ranged Expr -&gt; Maybe (Ranged Expr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Ranged Expr
</span><a href="#local-6989586621681650634"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-679"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Ranged Expr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-680"></span><span>    </span><span class="annot"><span class="annottext">[Attribute]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Ranged Expr)
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-681"></span><span>
</span><span id="line-682"></span><span class="hs-comment">-- | Report a parse error if two attributes in the list are of the same kind,</span><span>
</span><span id="line-683"></span><span class="hs-comment">--   thus, present conflicting information.</span><span>
</span><span id="line-684"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#checkForUniqueAttribute"><span class="hs-identifier hs-type">checkForUniqueAttribute</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Attribute.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-type">Attr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-685"></span><span id="checkForUniqueAttribute"><span class="annot"><span class="annottext">checkForUniqueAttribute :: (Attribute -&gt; Bool) -&gt; [Attr] -&gt; Parser ()
</span><a href="Agda.Syntax.Parser.Helpers.html#checkForUniqueAttribute"><span class="hs-identifier hs-var hs-var">checkForUniqueAttribute</span></a></span></span><span> </span><span id="local-6989586621681650635"><span class="annot"><span class="annottext">Attribute -&gt; Bool
</span><a href="#local-6989586621681650635"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681650636"><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650636"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-686"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681650637"><span class="annot"><span class="annottext">pAttrs :: [Attr]
</span><a href="#local-6989586621681650637"><span class="hs-identifier hs-var hs-var">pAttrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Attr -&gt; Bool) -&gt; [Attr] -&gt; [Attr]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attribute -&gt; Bool
</span><a href="#local-6989586621681650635"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Attribute -&gt; Bool) -&gt; (Attr -&gt; Attribute) -&gt; Attr -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Attr -&gt; Attribute
</span><a href="Agda.Syntax.Parser.Helpers.html#theAttr"><span class="hs-identifier hs-var">theAttr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650636"><span class="hs-identifier hs-var">attrs</span></a></span><span>
</span><span id="line-687"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Parser () -&gt; Parser ()
forall b (m :: * -&gt; *). (IsBool b, Monad m) =&gt; b -&gt; m () -&gt; m ()
</span><a href="Agda.Utils.Monad.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Attr] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650637"><span class="hs-identifier hs-var">pAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Parser () -&gt; Parser ()) -&gt; Parser () -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-688"></span><span>    </span><span class="annot"><span class="annottext">[Attr] -&gt; Parser ()
forall a. [Attr] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Helpers.html#errorConflictingAttributes"><span class="hs-identifier hs-var">errorConflictingAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650637"><span class="hs-identifier hs-var">pAttrs</span></a></span><span>
</span><span id="line-689"></span><span>
</span><span id="line-690"></span><span class="annot"><span class="hs-comment">-- | Report an attribute as conflicting (e.g., with an already set value).</span></span><span>
</span><span id="line-691"></span><span id="local-6989586621681649582"><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#errorConflictingAttribute"><span class="hs-identifier hs-type">errorConflictingAttribute</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-type">Attr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681649582"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-692"></span><span id="errorConflictingAttribute"><span class="annot"><span class="annottext">errorConflictingAttribute :: forall a. Attr -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Helpers.html#errorConflictingAttribute"><span class="hs-identifier hs-var hs-var">errorConflictingAttribute</span></a></span></span><span> </span><span id="local-6989586621681650643"><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621681650643"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attr -&gt; [Char] -&gt; Parser a
forall r a. HasRange r =&gt; r -&gt; [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseErrorRange"><span class="hs-identifier hs-var">parseErrorRange</span></a></span><span> </span><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621681650643"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser a) -&gt; [Char] -&gt; Parser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Conflicting attribute: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Attr -&gt; [Char]
</span><a href="Agda.Syntax.Parser.Helpers.html#attrName"><span class="hs-identifier hs-var">attrName</span></a></span><span> </span><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621681650643"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-693"></span><span>
</span><span id="line-694"></span><span class="hs-comment">-- | Report attributes as conflicting (e.g., with each other).</span><span>
</span><span id="line-695"></span><span class="hs-comment">--   Precondition: List not emtpy.</span><span>
</span><span id="line-696"></span><span id="local-6989586621681649598"><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#errorConflictingAttributes"><span class="hs-identifier hs-type">errorConflictingAttributes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#Attr"><span class="hs-identifier hs-type">Attr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Parser.Monad.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681649598"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-697"></span><span id="errorConflictingAttributes"><span class="annot"><span class="annottext">errorConflictingAttributes :: forall a. [Attr] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Helpers.html#errorConflictingAttributes"><span class="hs-identifier hs-var hs-var">errorConflictingAttributes</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621681650646"><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621681650646"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attr -&gt; Parser a
forall a. Attr -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Helpers.html#errorConflictingAttribute"><span class="hs-identifier hs-var">errorConflictingAttribute</span></a></span><span> </span><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621681650646"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-698"></span><span class="annot"><a href="Agda.Syntax.Parser.Helpers.html#errorConflictingAttributes"><span class="hs-identifier hs-var">errorConflictingAttributes</span></a></span><span> </span><span id="local-6989586621681650647"><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650647"><span class="hs-keyword hs-var">as</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Attr] -&gt; [Char] -&gt; Parser a
forall r a. HasRange r =&gt; r -&gt; [Char] -&gt; Parser a
</span><a href="Agda.Syntax.Parser.Monad.html#parseErrorRange"><span class="hs-identifier hs-var">parseErrorRange</span></a></span><span> </span><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650647"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Parser a) -&gt; [Char] -&gt; Parser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-699"></span><span>  </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Conflicting attributes: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
</span><span class="hs-identifier hs-var">unwords</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Attr -&gt; [Char]) -&gt; [Attr] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Attr -&gt; [Char]
</span><a href="Agda.Syntax.Parser.Helpers.html#attrName"><span class="hs-identifier hs-var">attrName</span></a></span><span> </span><span class="annot"><span class="annottext">[Attr]
</span><a href="#local-6989586621681650647"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-700"></span></pre></body></html>